(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,84103,e=>{"use strict";var t=e.i(33842);e.i(1465);var r=e.i(34991);let i=e=>`restaurant-system/${e}/${t.RESTAURANT_ID}`,a=async e=>{let a=Object.entries((await (0,r.get)((0,r.ref)(t.database,i("orders")))).val()||{}).map(([e,t])=>({id:e,...t}));return a.sort((e,t)=>{let r=e.timestamp||new Date(e.createdAt).getTime();return(t.timestamp||new Date(t.createdAt).getTime())-r}),e&&e>0&&(a=a.slice(0,e)),a},s=async(e,a)=>{let s=(await (0,r.get)((0,r.ref)(t.database,i("orders")))).val()||{},n=e.start.getTime(),o=e.end.getTime(),l=Object.entries(s).map(([e,t])=>({id:e,...t})).filter(e=>{let t=e.timestamp||new Date(e.createdAt).getTime();return t>=n&&t<=o}).sort((e,t)=>{let r=e.timestamp||new Date(e.createdAt).getTime();return(t.timestamp||new Date(t.createdAt).getTime())-r});return a&&a>0&&(l=l.slice(0,a)),l},n=async e=>{let a=await (0,r.get)((0,r.ref)(t.database,`${i("orders")}/${e}`));return a.exists()?{id:e,...a.val()}:null},o=async(e,a)=>{await (0,r.update)((0,r.ref)(t.database,`${i("orders")}/${e}`),{status:a,updatedAt:new Date().toISOString()})},l=async e=>{let a=(0,r.push)((0,r.ref)(t.database,i("orders"))),s=e.items.map(e=>{let t={id:e.id,name:e.name,price:e.price||0,quantity:e.quantity,itemTotal:e.itemTotal||e.price*e.quantity};return e.emoji&&(t.emoji=e.emoji),e.note&&(t.note=e.note),t}),n={items:s,total:e.total||0,status:e.status||"pending",restaurantId:t.RESTAURANT_ID,createdAt:new Date().toISOString(),timestamp:Date.now(),itemsCount:s.reduce((e,t)=>e+t.quantity,0)};void 0!==e.subtotal&&(n.subtotal=e.subtotal),e.discount&&(n.discount=e.discount),e.paymentMethod&&(n.paymentMethod=e.paymentMethod),e.paymentStatus&&(n.paymentStatus=e.paymentStatus),e.customerName&&(n.customerName=e.customerName),e.tableNumber&&(n.tableNumber=e.tableNumber),e.tableId&&(n.tableId=e.tableId),e.roomId&&(n.roomId=e.roomId),e.roomNumber&&(n.roomNumber=e.roomNumber),e.orderType&&(n.orderType=e.orderType),e.workerId&&(n.workerId=e.workerId),e.workerName&&(n.workerName=e.workerName),e.source&&(n.source=e.source);let o=null;if(e.tableNumber&&!e.tableId){let t=await I(e.tableNumber);t&&(o=t.id,n.tableId=t.id,n.orderType="table")}else e.tableId&&(o=e.tableId);await (0,r.set)(a,n);let l=a.key;if(o)try{await k(o,"occupied",l)}catch(e){console.error("Failed to update table status:",e)}return l},d=async()=>Object.entries((await (0,r.get)((0,r.ref)(t.database,i("menu")))).val()||{}).map(([e,t])=>{let r={id:e,...t,price:"string"==typeof t.price?parseFloat(t.price)||0:t.price||0,basePrice:t.basePrice?"string"==typeof t.basePrice?parseFloat(t.basePrice):t.basePrice:void 0};if(r.variations&&Array.isArray(r.variations)&&(r.variations=r.variations.map(e=>({...e,price:"string"==typeof e.price?parseFloat(e.price)||0:e.price||0}))),r.sizes&&"object"==typeof r.sizes){let e={};Object.entries(r.sizes).forEach(([t,r])=>{e[t]={...r,price:"string"==typeof r.price?parseFloat(r.price)||0:r.price||0}}),r.sizes=e}if(r.shishaTypes&&"object"==typeof r.shishaTypes){let e={};Object.entries(r.shishaTypes).forEach(([t,r])=>{e[t]={...r,price:"string"==typeof r.price?parseFloat(r.price)||0:r.price||0}}),r.shishaTypes=e}return r}),c=async e=>{let a=(0,r.push)((0,r.ref)(t.database,i("menu"))),s={};return Object.entries(e).forEach(([e,t])=>{if(void 0!==t)if("price"===e||"basePrice"===e)s[e]="string"==typeof t?parseFloat(t)||0:t||0;else if("variations"===e&&Array.isArray(t))s[e]=t.map(e=>({...e,price:"string"==typeof e.price?parseFloat(e.price)||0:e.price||0}));else if("sizes"===e&&"object"==typeof t){let r={};Object.entries(t).forEach(([e,t])=>{r[e]={...t,price:"string"==typeof t.price?parseFloat(t.price)||0:t.price||0}}),s[e]=r}else if("shishaTypes"===e&&"object"==typeof t){let r={};Object.entries(t).forEach(([e,t])=>{r[e]={...t,price:"string"==typeof t.price?parseFloat(t.price)||0:t.price||0}}),s[e]=r}else s[e]=t}),await (0,r.set)(a,{...s,category:e.categoryId||e.category,categoryId:e.categoryId||e.category,active:e.isActive??e.active??!0,isActive:e.isActive??e.active??!0,createdAt:new Date().toISOString()}),a.key},p=async(e,a)=>{let s={updatedAt:new Date().toISOString()};Object.entries(a).forEach(([e,t])=>{if(void 0!==t)if("price"===e||"basePrice"===e)s[e]="string"==typeof t?parseFloat(t)||0:t||0;else if("variations"===e&&Array.isArray(t))s[e]=t.map(e=>({...e,price:"string"==typeof e.price?parseFloat(e.price)||0:e.price||0}));else if("sizes"===e&&"object"==typeof t){let r={};Object.entries(t).forEach(([e,t])=>{r[e]={...t,price:"string"==typeof t.price?parseFloat(t.price)||0:t.price||0}}),s[e]=r}else if("shishaTypes"===e&&"object"==typeof t){let r={};Object.entries(t).forEach(([e,t])=>{r[e]={...t,price:"string"==typeof t.price?parseFloat(t.price)||0:t.price||0}}),s[e]=r}else s[e]=t}),a.categoryId&&(s.category=a.categoryId),void 0!==a.isActive&&(s.active=a.isActive),await (0,r.update)((0,r.ref)(t.database,`${i("menu")}/${e}`),s)},u=async e=>{await (0,r.remove)((0,r.ref)(t.database,`${i("menu")}/${e}`))},h=async()=>Object.entries((await (0,r.get)((0,r.ref)(t.database,i("categories")))).val()||{}).map(([e,t])=>({id:e,...t})).sort((e,t)=>(e.order||e.sortOrder||0)-(t.order||t.sortOrder||0)),f=async e=>{let a=(0,r.push)((0,r.ref)(t.database,i("categories"))),s={};return Object.entries(e).forEach(([e,t])=>{void 0!==t&&(s[e]=t)}),await (0,r.set)(a,{...s,createdAt:new Date().toISOString()}),a.key},m=async(e,a)=>{let s={};Object.entries(a).forEach(([e,t])=>{void 0!==t&&(s[e]=t)}),await (0,r.update)((0,r.ref)(t.database,`${i("categories")}/${e}`),{...s,updatedAt:new Date().toISOString()})},g=async e=>{await (0,r.remove)((0,r.ref)(t.database,`${i("categories")}/${e}`))},y=async e=>(await d()).filter(t=>t.category===e||t.categoryId===e),b=async e=>(await y(e)).length,x=async(e,a)=>{let s=await y(e),n={};s.forEach(e=>{n[`${i("menu")}/${e.id}/category`]=a,n[`${i("menu")}/${e.id}/categoryId`]=a,n[`${i("menu")}/${e.id}/updatedAt`]=new Date().toISOString()}),Object.keys(n).length>0&&await (0,r.update)((0,r.ref)(t.database),n)},v=async()=>Object.entries((await (0,r.get)((0,r.ref)(t.database,i("workers")))).val()||{}).map(([e,t])=>({id:e,...t})),S=async(e,a)=>{await (0,r.update)((0,r.ref)(t.database,`${i("workers")}/${e}`),{detailedPermissions:a})},w=async()=>{let e=new Date;e.setHours(0,0,0,0);let t=e.getTime();return(await a()).filter(e=>(e.timestamp||(e.createdAt?new Date(e.createdAt).getTime():0))>=t&&"cancelled"!==e.status)},j=async(e,a)=>{let s={paymentStatus:a,updatedAt:new Date().toISOString()};"paid"===a&&(s.paidAt=new Date().toISOString()),await (0,r.update)((0,r.ref)(t.database,`${i("orders")}/${e}`),s)},_=async(e,a)=>{let s=await n(e);if(!s)throw Error("Order not found");let o=[...s.items||[]];for(let e of a){let t=o.findIndex(t=>t.id===e.id&&t.name===e.name);if(t>=0)o[t].quantity+=e.quantity,o[t].itemTotal=o[t].quantity*o[t].price;else{let t={id:e.id,name:e.name,price:e.price||0,quantity:e.quantity,itemTotal:e.quantity*(e.price||0)};e.emoji&&(t.emoji=e.emoji),e.note&&(t.note=e.note),o.push(t)}}let l=o.map(e=>{let t={id:e.id,name:e.name,price:e.price||0,quantity:e.quantity,itemTotal:e.itemTotal||e.quantity*(e.price||0)};return e.emoji&&(t.emoji=e.emoji),e.note&&(t.note=e.note),t}),d=l.reduce((e,t)=>e+(t.itemTotal||t.quantity*t.price),0),c=l.reduce((e,t)=>e+t.quantity,0);await (0,r.update)((0,r.ref)(t.database,`${i("orders")}/${e}`),{items:l,total:d,itemsCount:c,updatedAt:new Date().toISOString()})},A=async(e,t)=>{let r=(await a()).filter(e=>"cancelled"!==e.status);if(e&&t){let i=e.getTime(),a=t.getTime();r=r.filter(e=>{let t=e.timestamp||(e.createdAt?new Date(e.createdAt).getTime():0);return t>=i&&t<=a})}let i=r.filter(e=>"paid"===e.status||"completed"===e.status).reduce((e,t)=>e+(t.total||0),0),s=r.length,n=r.filter(e=>"paid"===e.status||"completed"===e.status).length;return{totalRevenue:i,ordersCount:s,paidOrders:n,itemsSold:r.reduce((e,t)=>e+(t.itemsCount||t.items?.length||0),0),averageOrder:s>0?i/n:0}},T=async()=>Object.entries((await (0,r.get)((0,r.ref)(t.database,i("tables")))).val()||{}).map(([e,t])=>({id:e,...t})),O=async(e,t)=>!(await T()).some(r=>r.tableNumber===e&&r.id!==t),I=async e=>{let t=await T(),r=e.trim().toLowerCase(),i=e=>{let t=e.match(/\d+/);return t?t[0]:e},a=i(r),s=t.find(t=>t.tableNumber===e);return s||(s=t.find(e=>i(e.tableNumber.toLowerCase())===a))?s:(s=t.find(e=>e.tableNumber.toLowerCase().includes(r)||r.includes(e.tableNumber.toLowerCase())))||null},C=async e=>{if(!await O(e.tableNumber))throw Error(`رقم الطاولة "${e.tableNumber}" موجود مسبقاً`);let a={tableNumber:e.tableNumber,area:e.area,status:e.status||"available",activeOrderId:null,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};e.name&&e.name.trim()&&(a.name=e.name.trim());let s=(0,r.push)((0,r.ref)(t.database,i("tables")));return await (0,r.set)(s,a),s.key},R=async(e,a)=>{if(a.tableNumber&&!await O(a.tableNumber,e))throw Error(`رقم الطاولة "${a.tableNumber}" موجود مسبقاً`);let s={updatedAt:new Date().toISOString()};void 0!==a.tableNumber&&(s.tableNumber=a.tableNumber),void 0!==a.area&&(s.area=a.area),void 0!==a.status&&(s.status=a.status),void 0!==a.activeOrderId&&(s.activeOrderId=a.activeOrderId),void 0!==a.reservedBy&&(s.reservedBy=a.reservedBy),void 0!==a.reservedAt&&(s.reservedAt=a.reservedAt),void 0!==a.name&&(a.name&&a.name.trim()?s.name=a.name.trim():s.name=null),await (0,r.update)((0,r.ref)(t.database,`${i("tables")}/${e}`),s)},k=async(e,a,s,n)=>{let o={status:a,updatedAt:new Date().toISOString()};"available"===a?(o.activeOrderId=null,o.reservedBy=null,o.reservedAt=null):"reserved"===a?(o.reservedBy=n||null,o.reservedAt=new Date().toISOString()):"occupied"===a&&s&&(o.activeOrderId=s),await (0,r.update)((0,r.ref)(t.database,`${i("tables")}/${e}`),o)},z=async()=>Object.entries((await (0,r.get)((0,r.ref)(t.database,i("rooms")))).val()||{}).map(([e,t])=>({id:e,...t})).sort((e,t)=>(parseInt(String(e.roomNumber))||0)-(parseInt(String(t.roomNumber))||0)),F=async e=>{let a=(0,r.push)((0,r.ref)(t.database,i("rooms"))),s={roomNumber:e.roomNumber,status:e.status||"available",isActive:e.isActive??!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return e.name&&(s.name=e.name),e.notes&&(s.notes=e.notes),void 0!==e.hourlyRate&&e.hourlyRate>0&&(s.hourlyRate=e.hourlyRate),e.priceType&&(s.priceType=e.priceType),void 0!==e.malePrice&&(s.malePrice=e.malePrice),void 0!==e.femalePrice&&(s.femalePrice=e.femalePrice),await (0,r.set)(a,s),a.key},D=async(e,a)=>{let s={updatedAt:new Date().toISOString()};Object.entries(a).forEach(([e,t])=>{void 0!==t&&(s[e]=t)}),await (0,r.update)((0,r.ref)(t.database,`${i("rooms")}/${e}`),s)},N=async e=>{await (0,r.remove)((0,r.ref)(t.database,`${i("rooms")}/${e}`))},$=async(e,a,s,n)=>{let o={status:a,updatedAt:new Date().toISOString()};"available"===a?(o.activeOrderId=null,o.reservedBy=null,o.reservedAt=null):"reserved"===a?(o.reservedBy=n||null,o.reservedAt=new Date().toISOString()):"occupied"===a&&s&&(o.activeOrderId=s),await (0,r.update)((0,r.ref)(t.database,`${i("rooms")}/${e}`),o)},P=async()=>(await a()).filter(e=>"room"===e.orderType||e.roomId).sort((e,t)=>{let r=e.timestamp||(e.createdAt?new Date(e.createdAt).getTime():0);return(t.timestamp||(t.createdAt?new Date(t.createdAt).getTime():0))-r}),E=async e=>(await P()).filter(t=>{let r=t.timestamp||(t.createdAt?new Date(t.createdAt).getTime():0);return r>=e.start.getTime()&&r<=e.end.getTime()}),q=async(e,t)=>{await o(e,"completed"),await j(e,"paid"),await $(t,"available")};e.s(["addItemsToOrder",0,_,"closeRoomOrder",0,q,"createCategory",0,f,"createOrder",0,l,"createProduct",0,c,"createRoom",0,F,"createTable",0,C,"deleteCategory",0,g,"deleteProduct",0,u,"deleteRoom",0,N,"getCategories",0,h,"getCategoryProductCount",0,b,"getDateRangeForFilter",0,(e,t,r)=>{let i=new Date,a=new Date(i);a.setHours(23,59,59,999);let s=new Date(i);switch(s.setHours(0,0,0,0),e){case"today":break;case"week":s.setDate(s.getDate()-7);break;case"month":s.setMonth(s.getMonth()-1);break;case"year":s.setFullYear(s.getFullYear()-1);break;case"custom":t&&(s=new Date(t)),r&&(a.setTime(new Date(r).getTime()),a.setHours(23,59,59,999))}return{start:s,end:a}},"getDefaultWorkerPermissions",0,()=>({modules:{staffMenu:!0,orders:!1,tables:!1,rooms:!1,cashier:!1,inventory:!1,reports:!1,products:!1},actions:{createOrder:!0,editOrder:!1,cancelOrder:!1,processPayment:!1,applyDiscount:!1,viewFinancials:!1,manageProducts:!1,manageTables:!1,manageRooms:!1,dailyClosing:!1}}),"getFullPermissions",0,()=>({modules:{staffMenu:!0,orders:!0,tables:!0,rooms:!0,cashier:!0,inventory:!0,reports:!0,products:!0},actions:{createOrder:!0,editOrder:!0,cancelOrder:!0,processPayment:!0,applyDiscount:!0,viewFinancials:!0,manageProducts:!0,manageTables:!0,manageRooms:!0,dailyClosing:!0}}),"getOrder",0,n,"getOrders",0,a,"getOrdersByDateRange",0,s,"getProducts",0,d,"getRoomOrdersByDateRange",0,E,"getRooms",0,z,"getSalesStats",0,A,"getTables",0,T,"getTodayOrders",0,w,"getWorkers",0,v,"listenToOrders",0,e=>{let a=(0,r.ref)(t.database,i("orders")),s=(0,r.onValue)(a,t=>{e(Object.entries(t.val()||{}).map(([e,t])=>({id:e,...t})))});return()=>(0,r.off)(a,"value",s)},"listenToRooms",0,e=>{let a=(0,r.ref)(t.database,i("rooms")),s=(0,r.onValue)(a,t=>{e(Object.entries(t.val()||{}).map(([e,t])=>({id:e,...t})).sort((e,t)=>(parseInt(String(e.roomNumber))||0)-(parseInt(String(t.roomNumber))||0)))});return()=>(0,r.off)(a,"value",s)},"listenToTables",0,e=>{let a=(0,r.ref)(t.database,i("tables")),s=(0,r.onValue)(a,t=>{e(Object.entries(t.val()||{}).map(([e,t])=>({id:e,...t})))});return()=>(0,r.off)(a,"value",s)},"moveProductsToCategory",0,x,"setRoomStatus",0,$,"setTableStatus",0,k,"updateCategory",0,m,"updateOrderPaymentStatus",0,j,"updateOrderStatus",0,o,"updateProduct",0,p,"updateRoom",0,D,"updateTable",0,R,"updateWorkerPermissions",0,S])},16015,(e,t,r)=>{},98547,(e,t,r)=>{var i=e.i(47167);e.r(16015);var a=e.r(71645),s=a&&"object"==typeof a&&"default"in a?a:{default:a},n=void 0!==i.default&&i.default.env&&!0,o=function(e){return"[object String]"===Object.prototype.toString.call(e)},l=function(){function e(e){var t=void 0===e?{}:e,r=t.name,i=void 0===r?"stylesheet":r,a=t.optimizeForSpeed,s=void 0===a?n:a;d(o(i),"`name` must be a string"),this._name=i,this._deletedRulePlaceholder="#"+i+"-deleted-rule____{}",d("boolean"==typeof s,"`optimizeForSpeed` must be a boolean"),this._optimizeForSpeed=s,this._serverSheet=void 0,this._tags=[],this._injected=!1,this._rulesCount=0;var l="u">typeof window&&document.querySelector('meta[property="csp-nonce"]');this._nonce=l?l.getAttribute("content"):null}var t,r=e.prototype;return r.setOptimizeForSpeed=function(e){d("boolean"==typeof e,"`setOptimizeForSpeed` accepts a boolean"),d(0===this._rulesCount,"optimizeForSpeed cannot be when rules have already been inserted"),this.flush(),this._optimizeForSpeed=e,this.inject()},r.isOptimizeForSpeed=function(){return this._optimizeForSpeed},r.inject=function(){var e=this;if(d(!this._injected,"sheet already injected"),this._injected=!0,"u">typeof window&&this._optimizeForSpeed){this._tags[0]=this.makeStyleTag(this._name),this._optimizeForSpeed="insertRule"in this.getSheet(),this._optimizeForSpeed||(n||console.warn("StyleSheet: optimizeForSpeed mode not supported falling back to standard mode."),this.flush(),this._injected=!0);return}this._serverSheet={cssRules:[],insertRule:function(t,r){return"number"==typeof r?e._serverSheet.cssRules[r]={cssText:t}:e._serverSheet.cssRules.push({cssText:t}),r},deleteRule:function(t){e._serverSheet.cssRules[t]=null}}},r.getSheetForTag=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]},r.getSheet=function(){return this.getSheetForTag(this._tags[this._tags.length-1])},r.insertRule=function(e,t){if(d(o(e),"`insertRule` accepts only strings"),"u"<typeof window)return"number"!=typeof t&&(t=this._serverSheet.cssRules.length),this._serverSheet.insertRule(e,t),this._rulesCount++;if(this._optimizeForSpeed){var r=this.getSheet();"number"!=typeof t&&(t=r.cssRules.length);try{r.insertRule(e,t)}catch(t){return n||console.warn("StyleSheet: illegal rule: \n\n"+e+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),-1}}else{var i=this._tags[t];this._tags.push(this.makeStyleTag(this._name,e,i))}return this._rulesCount++},r.replaceRule=function(e,t){if(this._optimizeForSpeed||"u"<typeof window){var r="u">typeof window?this.getSheet():this._serverSheet;if(t.trim()||(t=this._deletedRulePlaceholder),!r.cssRules[e])return e;r.deleteRule(e);try{r.insertRule(t,e)}catch(i){n||console.warn("StyleSheet: illegal rule: \n\n"+t+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),r.insertRule(this._deletedRulePlaceholder,e)}}else{var i=this._tags[e];d(i,"old rule at index `"+e+"` not found"),i.textContent=t}return e},r.deleteRule=function(e){if("u"<typeof window)return void this._serverSheet.deleteRule(e);if(this._optimizeForSpeed)this.replaceRule(e,"");else{var t=this._tags[e];d(t,"rule at index `"+e+"` not found"),t.parentNode.removeChild(t),this._tags[e]=null}},r.flush=function(){this._injected=!1,this._rulesCount=0,"u">typeof window?(this._tags.forEach(function(e){return e&&e.parentNode.removeChild(e)}),this._tags=[]):this._serverSheet.cssRules=[]},r.cssRules=function(){var e=this;return"u"<typeof window?this._serverSheet.cssRules:this._tags.reduce(function(t,r){return r?t=t.concat(Array.prototype.map.call(e.getSheetForTag(r).cssRules,function(t){return t.cssText===e._deletedRulePlaceholder?null:t})):t.push(null),t},[])},r.makeStyleTag=function(e,t,r){t&&d(o(t),"makeStyleTag accepts only strings as second parameter");var i=document.createElement("style");this._nonce&&i.setAttribute("nonce",this._nonce),i.type="text/css",i.setAttribute("data-"+e,""),t&&i.appendChild(document.createTextNode(t));var a=document.head||document.getElementsByTagName("head")[0];return r?a.insertBefore(i,r):a.appendChild(i),i},t=[{key:"length",get:function(){return this._rulesCount}}],function(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(e.prototype,t),e}();function d(e,t){if(!e)throw Error("StyleSheet: "+t+".")}var c=function(e){for(var t=5381,r=e.length;r;)t=33*t^e.charCodeAt(--r);return t>>>0},p={};function u(e,t){if(!t)return"jsx-"+e;var r=String(t),i=e+r;return p[i]||(p[i]="jsx-"+c(e+"-"+r)),p[i]}function h(e,t){"u"<typeof window&&(t=t.replace(/\/style/gi,"\\/style"));var r=e+t;return p[r]||(p[r]=t.replace(/__jsx-style-dynamic-selector/g,e)),p[r]}var f=function(){function e(e){var t=void 0===e?{}:e,r=t.styleSheet,i=void 0===r?null:r,a=t.optimizeForSpeed,s=void 0!==a&&a;this._sheet=i||new l({name:"styled-jsx",optimizeForSpeed:s}),this._sheet.inject(),i&&"boolean"==typeof s&&(this._sheet.setOptimizeForSpeed(s),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer=void 0,this._indices={},this._instancesCounts={}}var t=e.prototype;return t.add=function(e){var t=this;void 0===this._optimizeForSpeed&&(this._optimizeForSpeed=Array.isArray(e.children),this._sheet.setOptimizeForSpeed(this._optimizeForSpeed),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),"u">typeof window&&!this._fromServer&&(this._fromServer=this.selectFromServer(),this._instancesCounts=Object.keys(this._fromServer).reduce(function(e,t){return e[t]=0,e},{}));var r=this.getIdAndRules(e),i=r.styleId,a=r.rules;if(i in this._instancesCounts){this._instancesCounts[i]+=1;return}var s=a.map(function(e){return t._sheet.insertRule(e)}).filter(function(e){return -1!==e});this._indices[i]=s,this._instancesCounts[i]=1},t.remove=function(e){var t=this,r=this.getIdAndRules(e).styleId;if(function(e,t){if(!e)throw Error("StyleSheetRegistry: "+t+".")}(r in this._instancesCounts,"styleId: `"+r+"` not found"),this._instancesCounts[r]-=1,this._instancesCounts[r]<1){var i=this._fromServer&&this._fromServer[r];i?(i.parentNode.removeChild(i),delete this._fromServer[r]):(this._indices[r].forEach(function(e){return t._sheet.deleteRule(e)}),delete this._indices[r]),delete this._instancesCounts[r]}},t.update=function(e,t){this.add(t),this.remove(e)},t.flush=function(){this._sheet.flush(),this._sheet.inject(),this._fromServer=void 0,this._indices={},this._instancesCounts={}},t.cssRules=function(){var e=this,t=this._fromServer?Object.keys(this._fromServer).map(function(t){return[t,e._fromServer[t]]}):[],r=this._sheet.cssRules();return t.concat(Object.keys(this._indices).map(function(t){return[t,e._indices[t].map(function(e){return r[e].cssText}).join(e._optimizeForSpeed?"":"\n")]}).filter(function(e){return!!e[1]}))},t.styles=function(e){var t,r;return t=this.cssRules(),void 0===(r=e)&&(r={}),t.map(function(e){var t=e[0],i=e[1];return s.default.createElement("style",{id:"__"+t,key:"__"+t,nonce:r.nonce?r.nonce:void 0,dangerouslySetInnerHTML:{__html:i}})})},t.getIdAndRules=function(e){var t=e.children,r=e.dynamic,i=e.id;if(r){var a=u(i,r);return{styleId:a,rules:Array.isArray(t)?t.map(function(e){return h(a,e)}):[h(a,t)]}}return{styleId:u(i),rules:Array.isArray(t)?t:[t]}},t.selectFromServer=function(){return Array.prototype.slice.call(document.querySelectorAll('[id^="__jsx-"]')).reduce(function(e,t){return e[t.id.slice(2)]=t,e},{})},e}(),m=a.createContext(null);function g(){return new f}function y(){return a.useContext(m)}m.displayName="StyleSheetContext";var b=s.default.useInsertionEffect||s.default.useLayoutEffect,x="u">typeof window?g():void 0;function v(e){var t=x||y();return t&&("u"<typeof window?t.add(e):b(function(){return t.add(e),function(){t.remove(e)}},[e.id,String(e.dynamic)])),null}v.dynamic=function(e){return e.map(function(e){return u(e[0],e[1])}).join(" ")},r.StyleRegistry=function(e){var t=e.registry,r=e.children,i=a.useContext(m),n=a.useState(function(){return i||t||g()})[0];return s.default.createElement(m.Provider,{value:n},r)},r.createStyleRegistry=g,r.style=v,r.useStyleRegistry=y},37902,(e,t,r)=>{t.exports=e.r(98547).style},55436,e=>{"use strict";let t=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>t],55436)},17235,e=>{"use strict";var t=e.i(43476),r=e.i(38036),i=e.i(75254);let a=(0,i.default)("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]);var s=e.i(55436);let n=(0,i.default)("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);function o({title:e,subtitle:i}){let o=(0,r.getCurrentUser)();return(0,t.jsxs)("header",{style:{height:"70px",backgroundColor:"#ffffff",borderBottom:"1px solid #e2e8f0",padding:"0 24px",display:"flex",alignItems:"center",justifyContent:"space-between",position:"sticky",top:0,zIndex:40},children:[(0,t.jsxs)("div",{children:[e&&(0,t.jsx)("h1",{style:{fontSize:"20px",fontWeight:700,color:"#0f172a",margin:0},children:e}),i&&(0,t.jsx)("p",{style:{fontSize:"13px",color:"#64748b",margin:"2px 0 0 0"},children:i})]}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",height:"40px",padding:"0 14px",backgroundColor:"#f8fafc",border:"1px solid #e2e8f0",borderRadius:"10px",cursor:"pointer"},children:[(0,t.jsx)(s.Search,{style:{width:"16px",height:"16px",color:"#94a3b8"}}),(0,t.jsx)("span",{style:{fontSize:"13px",color:"#94a3b8"},children:"بحث..."})]}),(0,t.jsx)("button",{style:{width:"40px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"transparent",border:"none",borderRadius:"10px",cursor:"pointer",color:"#64748b"},children:(0,t.jsx)(n,{style:{width:"20px",height:"20px"}})}),(0,t.jsxs)("button",{style:{position:"relative",width:"40px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"transparent",border:"none",borderRadius:"10px",cursor:"pointer",color:"#64748b"},children:[(0,t.jsx)(a,{style:{width:"20px",height:"20px"}}),(0,t.jsx)("span",{style:{position:"absolute",top:"8px",left:"8px",width:"8px",height:"8px",backgroundColor:"#ef4444",borderRadius:"50%",border:"2px solid #ffffff"}})]}),(0,t.jsx)("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:"linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%)",display:"flex",alignItems:"center",justifyContent:"center",color:"#ffffff",fontSize:"14px",fontWeight:600,boxShadow:"0 2px 8px rgba(99, 102, 241, 0.3)",cursor:"pointer"},children:o?.name.charAt(0)||"A"})]})]})}e.s(["default",()=>o],17235)},25652,e=>{"use strict";let t=(0,e.i(75254).default)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);e.s(["TrendingUp",()=>t],25652)},12426,e=>{"use strict";let t=(0,e.i(75254).default)("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);e.s(["DollarSign",()=>t],12426)},35408,e=>{"use strict";let t=(0,e.i(75254).default)("trending-down",[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]]);e.s(["TrendingDown",()=>t],35408)},15057,e=>{"use strict";let t=(0,e.i(75254).default)("arrow-up-right",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);e.s(["ArrowUpRight",()=>t],15057)},23261,e=>{"use strict";var t=e.i(43476),r=e.i(37902),i=e.i(71645),a=e.i(13056),s=e.i(84103),n=e.i(17235),o=e.i(25652),l=e.i(35408),d=e.i(15057),c=e.i(12426),p=e.i(1928),u=e.i(88844),h=e.i(61911);function f(){let{user:e}=(0,a.useAuth)(),[f,m]=(0,i.useState)({totalRevenue:0,ordersCount:0,paidOrders:0,productsCount:0}),[g,y]=(0,i.useState)(!0),[b,x]=(0,i.useState)([]),[v,S]=(0,i.useState)("desktop");(0,i.useEffect)(()=>{let e=()=>{let e=window.innerWidth;e<640?S("mobile"):e<1024?S("tablet"):S("desktop")};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let w="mobile"===v,j="tablet"===v;(0,i.useEffect)(()=>{_()},[]);let _=async()=>{try{let[e,t,r]=await Promise.all([(0,s.getTodayOrders)(),(0,s.getSalesStats)(),(0,s.getProducts)()]),i=e.filter(e=>"paid"===e.status||"completed"===e.status),a=i.reduce((e,t)=>e+(t.total||0),0);m({totalRevenue:a,ordersCount:e.length,paidOrders:i.length,productsCount:r.filter(e=>e.active).length}),x(e.sort((e,t)=>{let r=e.timestamp||(e.createdAt?new Date(e.createdAt).getTime():0);return(t.timestamp||(t.createdAt?new Date(t.createdAt).getTime():0))-r}).slice(0,5))}catch(e){console.error("Error loading dashboard data:",e)}finally{y(!1)}},A=e?.role==="admin"||e?.role==="cashier",T=[{title:"إجمالي الإيرادات",value:`${f.totalRevenue.toFixed(3)}`,unit:"ر.ع",change:"+12.5%",trend:"up",icon:c.DollarSign,gradient:"linear-gradient(135deg, #10b981 0%, #059669 100%)",shadowColor:"rgba(16, 185, 129, 0.3)",requiresFinancial:!0},{title:"الطلبات اليوم",value:f.ordersCount.toString(),unit:"طلب",change:"+8.2%",trend:"up",icon:p.ShoppingCart,gradient:"linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)",shadowColor:"rgba(59, 130, 246, 0.3)",requiresFinancial:!1},{title:"المنتجات النشطة",value:f.productsCount.toString(),unit:"منتج",change:"0%",trend:"neutral",icon:u.Package,gradient:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",shadowColor:"rgba(245, 158, 11, 0.3)",requiresFinancial:!1},{title:"الطلبات المدفوعة",value:f.paidOrders.toString(),unit:"طلب",change:"+5.1%",trend:"up",icon:h.Users,gradient:"linear-gradient(135deg, #8b5cf6 0%, #6d28d9 100%)",shadowColor:"rgba(139, 92, 246, 0.3)",requiresFinancial:!0}],O=A?T:T.filter(e=>!e.requiresFinancial);return g?(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh"},className:"jsx-1875cac4975ab454",children:[(0,t.jsxs)("div",{style:{textAlign:"center"},className:"jsx-1875cac4975ab454",children:[(0,t.jsx)("div",{style:{width:"40px",height:"40px",border:"3px solid #e2e8f0",borderTopColor:"#6366f1",borderRadius:"50%",animation:"spin 1s linear infinite",margin:"0 auto"},className:"jsx-1875cac4975ab454"}),(0,t.jsx)("p",{style:{marginTop:"16px",fontSize:"14px",color:"#64748b"},className:"jsx-1875cac4975ab454",children:"جاري التحميل..."})]}),(0,t.jsx)(r.default,{id:"1875cac4975ab454",children:"@keyframes spin{to{transform:rotate(360deg)}}"})]}):(0,t.jsxs)("div",{style:{minHeight:"100vh"},children:[(0,t.jsx)(n.default,{title:"لوحة التحكم",subtitle:"نظرة عامة على الأداء"}),(0,t.jsxs)("div",{style:{padding:w?"16px":j?"20px":"24px"},children:[(0,t.jsx)("div",{style:{display:"grid",gridTemplateColumns:w?"repeat(1, 1fr)":j?"repeat(2, 1fr)":"repeat(auto-fit, minmax(240px, 1fr))",gap:w?"12px":"20px",marginBottom:w?"16px":"24px"},children:O.map((e,r)=>{let i=e.icon;return(0,t.jsxs)("div",{style:{backgroundColor:"#ffffff",borderRadius:w?"16px":"20px",padding:w?"16px":"24px",border:"1px solid #e2e8f0"},children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:w?"14px":"20px"},children:[(0,t.jsx)("div",{style:{width:w?"40px":"48px",height:w?"40px":"48px",borderRadius:w?"12px":"14px",background:e.gradient,display:"flex",alignItems:"center",justifyContent:"center",boxShadow:`0 4px 12px ${e.shadowColor}`},children:(0,t.jsx)(i,{style:{width:w?"18px":"22px",height:w?"18px":"22px",color:"#ffffff"}})}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px",fontSize:w?"11px":"12px",fontWeight:600,color:"up"===e.trend?"#16a34a":"down"===e.trend?"#dc2626":"#64748b"},children:["up"===e.trend&&(0,t.jsx)(o.TrendingUp,{style:{width:w?"12px":"14px",height:w?"12px":"14px"}}),"down"===e.trend&&(0,t.jsx)(l.TrendingDown,{style:{width:w?"12px":"14px",height:w?"12px":"14px"}}),(0,t.jsx)("span",{children:e.change})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"baseline",gap:"6px"},children:[(0,t.jsx)("span",{style:{fontSize:w?"22px":"28px",fontWeight:700,color:"#0f172a"},children:e.value}),(0,t.jsx)("span",{style:{fontSize:w?"12px":"14px",color:"#64748b"},children:e.unit})]}),(0,t.jsx)("p",{style:{fontSize:w?"12px":"13px",color:"#94a3b8",marginTop:"4px"},children:e.title})]})]},r)})}),(0,t.jsxs)("div",{style:{backgroundColor:"#ffffff",borderRadius:w?"16px":"20px",border:"1px solid #e2e8f0",overflow:"hidden"},children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"20px 24px",borderBottom:"1px solid #e2e8f0"},children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{style:{fontSize:"16px",fontWeight:700,color:"#0f172a",margin:0},children:"آخر الطلبات"}),(0,t.jsx)("p",{style:{fontSize:"13px",color:"#64748b",margin:"4px 0 0 0"},children:"آخر 5 طلبات"})]}),(0,t.jsxs)("a",{href:"/admin/orders",style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"13px",fontWeight:600,color:"#6366f1",textDecoration:"none"},children:["عرض الكل",(0,t.jsx)(d.ArrowUpRight,{style:{width:"14px",height:"14px"}})]})]}),(0,t.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{style:{backgroundColor:"#f8fafc"},children:[(0,t.jsx)("th",{style:{padding:"14px 24px",textAlign:"right",fontSize:"12px",fontWeight:600,color:"#64748b",textTransform:"uppercase"},children:"رقم الطلب"}),(0,t.jsx)("th",{style:{padding:"14px 24px",textAlign:"right",fontSize:"12px",fontWeight:600,color:"#64748b",textTransform:"uppercase"},children:"العميل"}),A&&(0,t.jsx)("th",{style:{padding:"14px 24px",textAlign:"right",fontSize:"12px",fontWeight:600,color:"#64748b",textTransform:"uppercase"},children:"المبلغ"}),(0,t.jsx)("th",{style:{padding:"14px 24px",textAlign:"right",fontSize:"12px",fontWeight:600,color:"#64748b",textTransform:"uppercase"},children:"الحالة"}),(0,t.jsx)("th",{style:{padding:"14px 24px",textAlign:"right",fontSize:"12px",fontWeight:600,color:"#64748b",textTransform:"uppercase"},children:"الوقت"})]})}),(0,t.jsx)("tbody",{children:0===b.length?(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:A?5:4,style:{padding:"48px 24px",textAlign:"center",fontSize:"14px",color:"#64748b"},children:"لا توجد طلبات"})}):b.map((e,r)=>{var i;let a={pending:{bg:"#fef3c7",color:"#b45309"},processing:{bg:"#dbeafe",color:"#1d4ed8"},preparing:{bg:"#fef3c7",color:"#b45309"},ready:{bg:"#cffafe",color:"#0891b2"},paid:{bg:"#dcfce7",color:"#16a34a"},completed:{bg:"#dcfce7",color:"#16a34a"},cancelled:{bg:"#fee2e2",color:"#dc2626"}}[e.status]||{bg:"#f1f5f9",color:"#64748b"};return(0,t.jsxs)("tr",{style:{borderTop:r>0?"1px solid #f1f5f9":"none"},children:[(0,t.jsxs)("td",{style:{padding:"16px 24px",fontSize:"14px",fontWeight:600,color:"#0f172a"},children:["#",e.id.slice(-6).toUpperCase()]}),(0,t.jsx)("td",{style:{padding:"16px 24px",fontSize:"14px",color:"#475569"},children:e.customerName||e.tableNumber||"غير محدد"}),A&&(0,t.jsxs)("td",{style:{padding:"16px 24px",fontSize:"14px",fontWeight:600,color:"#0f172a"},children:[e.total.toFixed(3)," ر.ع"]}),(0,t.jsx)("td",{style:{padding:"16px 24px"},children:(0,t.jsx)("span",{style:{display:"inline-flex",padding:"6px 12px",borderRadius:"8px",fontSize:"12px",fontWeight:600,backgroundColor:a.bg,color:a.color},children:{pending:"معلق",processing:"قيد التنفيذ",preparing:"قيد التحضير",ready:"جاهز",paid:"مدفوع",completed:"مكتمل",cancelled:"ملغي"}[i=e.status]||i})}),(0,t.jsx)("td",{style:{padding:"16px 24px",fontSize:"14px",color:"#64748b"},children:e.createdAt?new Date(e.createdAt).toLocaleString("ar-EG",{hour:"2-digit",minute:"2-digit"}):"-"})]},e.id)})})]})]})]})]})}e.s(["default",()=>f])}]);