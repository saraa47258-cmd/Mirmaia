(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,3281,e=>{"use strict";let t=(0,e.i(75254).default)("printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);e.s(["Printer",()=>t],3281)},61659,e=>{"use strict";let t=(0,e.i(75254).default)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);e.s(["CreditCard",()=>t],61659)},3116,e=>{"use strict";let t=(0,e.i(75254).default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);e.s(["Clock",()=>t],3116)},87378,e=>{"use strict";let t=(0,e.i(75254).default)("banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]);e.s(["Banknote",()=>t],87378)},84103,e=>{"use strict";var t=e.i(33842);e.i(1465);var a=e.i(34991);let r=e=>`restaurant-system/${e}/${t.RESTAURANT_ID}`,s=async e=>{let s=Object.entries((await (0,a.get)((0,a.ref)(t.database,r("orders")))).val()||{}).map(([e,t])=>({id:e,...t}));return s.sort((e,t)=>{let a=e.timestamp||new Date(e.createdAt).getTime();return(t.timestamp||new Date(t.createdAt).getTime())-a}),e&&e>0&&(s=s.slice(0,e)),s},i=async(e,s)=>{let i=(await (0,a.get)((0,a.ref)(t.database,r("orders")))).val()||{},o=e.start.getTime(),n=e.end.getTime(),l=Object.entries(i).map(([e,t])=>({id:e,...t})).filter(e=>{let t=e.timestamp||new Date(e.createdAt).getTime();return t>=o&&t<=n}).sort((e,t)=>{let a=e.timestamp||new Date(e.createdAt).getTime();return(t.timestamp||new Date(t.createdAt).getTime())-a});return s&&s>0&&(l=l.slice(0,s)),l},o=async e=>{let s=await (0,a.get)((0,a.ref)(t.database,`${r("orders")}/${e}`));return s.exists()?{id:e,...s.val()}:null},n=async(e,s)=>{await (0,a.update)((0,a.ref)(t.database,`${r("orders")}/${e}`),{status:s,updatedAt:new Date().toISOString()})},l=async e=>{let s=(0,a.push)((0,a.ref)(t.database,r("orders"))),i=e.items.map(e=>{let t={id:e.id,name:e.name,price:e.price||0,quantity:e.quantity,itemTotal:e.itemTotal||e.price*e.quantity};return e.emoji&&(t.emoji=e.emoji),e.note&&(t.note=e.note),t}),o={items:i,total:e.total||0,status:e.status||"pending",restaurantId:t.RESTAURANT_ID,createdAt:new Date().toISOString(),timestamp:Date.now(),itemsCount:i.reduce((e,t)=>e+t.quantity,0)};void 0!==e.subtotal&&(o.subtotal=e.subtotal),e.discount&&(o.discount=e.discount),e.paymentMethod&&(o.paymentMethod=e.paymentMethod),e.paymentStatus&&(o.paymentStatus=e.paymentStatus),e.customerName&&(o.customerName=e.customerName),e.tableNumber&&(o.tableNumber=e.tableNumber),e.tableId&&(o.tableId=e.tableId),e.roomId&&(o.roomId=e.roomId),e.roomNumber&&(o.roomNumber=e.roomNumber),e.orderType&&(o.orderType=e.orderType),e.workerId&&(o.workerId=e.workerId),e.workerName&&(o.workerName=e.workerName),e.source&&(o.source=e.source);let n=null;if(e.tableNumber&&!e.tableId){let t=await N(e.tableNumber);t&&(n=t.id,o.tableId=t.id,o.orderType="table")}else e.tableId&&(n=e.tableId);await (0,a.set)(s,o);let l=s.key;if(n)try{await A(n,"occupied",l)}catch(e){console.error("Failed to update table status:",e)}return l},d=async()=>Object.entries((await (0,a.get)((0,a.ref)(t.database,r("menu")))).val()||{}).map(([e,t])=>{let a={id:e,...t,price:"string"==typeof t.price?parseFloat(t.price)||0:t.price||0,basePrice:t.basePrice?"string"==typeof t.basePrice?parseFloat(t.basePrice):t.basePrice:void 0};if(a.variations&&Array.isArray(a.variations)&&(a.variations=a.variations.map(e=>({...e,price:"string"==typeof e.price?parseFloat(e.price)||0:e.price||0}))),a.sizes&&"object"==typeof a.sizes){let e={};Object.entries(a.sizes).forEach(([t,a])=>{e[t]={...a,price:"string"==typeof a.price?parseFloat(a.price)||0:a.price||0}}),a.sizes=e}if(a.shishaTypes&&"object"==typeof a.shishaTypes){let e={};Object.entries(a.shishaTypes).forEach(([t,a])=>{e[t]={...a,price:"string"==typeof a.price?parseFloat(a.price)||0:a.price||0}}),a.shishaTypes=e}return a}),c=async e=>{let s=(0,a.push)((0,a.ref)(t.database,r("menu"))),i={};return Object.entries(e).forEach(([e,t])=>{if(void 0!==t)if("price"===e||"basePrice"===e)i[e]="string"==typeof t?parseFloat(t)||0:t||0;else if("variations"===e&&Array.isArray(t))i[e]=t.map(e=>({...e,price:"string"==typeof e.price?parseFloat(e.price)||0:e.price||0}));else if("sizes"===e&&"object"==typeof t){let a={};Object.entries(t).forEach(([e,t])=>{a[e]={...t,price:"string"==typeof t.price?parseFloat(t.price)||0:t.price||0}}),i[e]=a}else if("shishaTypes"===e&&"object"==typeof t){let a={};Object.entries(t).forEach(([e,t])=>{a[e]={...t,price:"string"==typeof t.price?parseFloat(t.price)||0:t.price||0}}),i[e]=a}else i[e]=t}),await (0,a.set)(s,{...i,category:e.categoryId||e.category,categoryId:e.categoryId||e.category,active:e.isActive??e.active??!0,isActive:e.isActive??e.active??!0,createdAt:new Date().toISOString()}),s.key},p=async(e,s)=>{let i={updatedAt:new Date().toISOString()};Object.entries(s).forEach(([e,t])=>{if(void 0!==t)if("price"===e||"basePrice"===e)i[e]="string"==typeof t?parseFloat(t)||0:t||0;else if("variations"===e&&Array.isArray(t))i[e]=t.map(e=>({...e,price:"string"==typeof e.price?parseFloat(e.price)||0:e.price||0}));else if("sizes"===e&&"object"==typeof t){let a={};Object.entries(t).forEach(([e,t])=>{a[e]={...t,price:"string"==typeof t.price?parseFloat(t.price)||0:t.price||0}}),i[e]=a}else if("shishaTypes"===e&&"object"==typeof t){let a={};Object.entries(t).forEach(([e,t])=>{a[e]={...t,price:"string"==typeof t.price?parseFloat(t.price)||0:t.price||0}}),i[e]=a}else i[e]=t}),s.categoryId&&(i.category=s.categoryId),void 0!==s.isActive&&(i.active=s.isActive),await (0,a.update)((0,a.ref)(t.database,`${r("menu")}/${e}`),i)},u=async e=>{await (0,a.remove)((0,a.ref)(t.database,`${r("menu")}/${e}`))},f=async()=>Object.entries((await (0,a.get)((0,a.ref)(t.database,r("categories")))).val()||{}).map(([e,t])=>({id:e,...t})).sort((e,t)=>(e.order||e.sortOrder||0)-(t.order||t.sortOrder||0)),m=async e=>{let s=(0,a.push)((0,a.ref)(t.database,r("categories"))),i={};return Object.entries(e).forEach(([e,t])=>{void 0!==t&&(i[e]=t)}),await (0,a.set)(s,{...i,createdAt:new Date().toISOString()}),s.key},h=async(e,s)=>{let i={};Object.entries(s).forEach(([e,t])=>{void 0!==t&&(i[e]=t)}),await (0,a.update)((0,a.ref)(t.database,`${r("categories")}/${e}`),{...i,updatedAt:new Date().toISOString()})},y=async e=>{await (0,a.remove)((0,a.ref)(t.database,`${r("categories")}/${e}`))},g=async e=>(await d()).filter(t=>t.category===e||t.categoryId===e),x=async e=>(await g(e)).length,b=async(e,s)=>{let i=await g(e),o={};i.forEach(e=>{o[`${r("menu")}/${e.id}/category`]=s,o[`${r("menu")}/${e.id}/categoryId`]=s,o[`${r("menu")}/${e.id}/updatedAt`]=new Date().toISOString()}),Object.keys(o).length>0&&await (0,a.update)((0,a.ref)(t.database),o)},S=async()=>Object.entries((await (0,a.get)((0,a.ref)(t.database,r("workers")))).val()||{}).map(([e,t])=>({id:e,...t})),v=async(e,s)=>{await (0,a.update)((0,a.ref)(t.database,`${r("workers")}/${e}`),{detailedPermissions:s})},w=async()=>{let e=new Date;e.setHours(0,0,0,0);let t=e.getTime();return(await s()).filter(e=>(e.timestamp||(e.createdAt?new Date(e.createdAt).getTime():0))>=t&&"cancelled"!==e.status)},j=async(e,s)=>{let i={paymentStatus:s,updatedAt:new Date().toISOString()};"paid"===s&&(i.paidAt=new Date().toISOString()),await (0,a.update)((0,a.ref)(t.database,`${r("orders")}/${e}`),i)},C=async(e,s)=>{let i=await o(e);if(!i)throw Error("Order not found");let n=[...i.items||[]];for(let e of s){let t=n.findIndex(t=>t.id===e.id&&t.name===e.name);if(t>=0)n[t].quantity+=e.quantity,n[t].itemTotal=n[t].quantity*n[t].price;else{let t={id:e.id,name:e.name,price:e.price||0,quantity:e.quantity,itemTotal:e.quantity*(e.price||0)};e.emoji&&(t.emoji=e.emoji),e.note&&(t.note=e.note),n.push(t)}}let l=n.map(e=>{let t={id:e.id,name:e.name,price:e.price||0,quantity:e.quantity,itemTotal:e.itemTotal||e.quantity*(e.price||0)};return e.emoji&&(t.emoji=e.emoji),e.note&&(t.note=e.note),t}),d=l.reduce((e,t)=>e+(t.itemTotal||t.quantity*t.price),0),c=l.reduce((e,t)=>e+t.quantity,0);await (0,a.update)((0,a.ref)(t.database,`${r("orders")}/${e}`),{items:l,total:d,itemsCount:c,updatedAt:new Date().toISOString()})},k=async(e,t)=>{let a=(await s()).filter(e=>"cancelled"!==e.status);if(e&&t){let r=e.getTime(),s=t.getTime();a=a.filter(e=>{let t=e.timestamp||(e.createdAt?new Date(e.createdAt).getTime():0);return t>=r&&t<=s})}let r=a.filter(e=>"paid"===e.status||"completed"===e.status).reduce((e,t)=>e+(t.total||0),0),i=a.length,o=a.filter(e=>"paid"===e.status||"completed"===e.status).length;return{totalRevenue:r,ordersCount:i,paidOrders:o,itemsSold:a.reduce((e,t)=>e+(t.itemsCount||t.items?.length||0),0),averageOrder:i>0?r/o:0}},O=async()=>Object.entries((await (0,a.get)((0,a.ref)(t.database,r("tables")))).val()||{}).map(([e,t])=>({id:e,...t})),T=async(e,t)=>!(await O()).some(a=>a.tableNumber===e&&a.id!==t),N=async e=>{let t=await O(),a=e.trim().toLowerCase(),r=e=>{let t=e.match(/\d+/);return t?t[0]:e},s=r(a),i=t.find(t=>t.tableNumber===e);return i||(i=t.find(e=>r(e.tableNumber.toLowerCase())===s))?i:(i=t.find(e=>e.tableNumber.toLowerCase().includes(a)||a.includes(e.tableNumber.toLowerCase())))||null},I=async e=>{if(!await T(e.tableNumber))throw Error(`رقم الطاولة "${e.tableNumber}" موجود مسبقاً`);let s={tableNumber:e.tableNumber,area:e.area,status:e.status||"available",activeOrderId:null,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};e.name&&e.name.trim()&&(s.name=e.name.trim());let i=(0,a.push)((0,a.ref)(t.database,r("tables")));return await (0,a.set)(i,s),i.key},_=async(e,s)=>{if(s.tableNumber&&!await T(s.tableNumber,e))throw Error(`رقم الطاولة "${s.tableNumber}" موجود مسبقاً`);let i={updatedAt:new Date().toISOString()};void 0!==s.tableNumber&&(i.tableNumber=s.tableNumber),void 0!==s.area&&(i.area=s.area),void 0!==s.status&&(i.status=s.status),void 0!==s.activeOrderId&&(i.activeOrderId=s.activeOrderId),void 0!==s.reservedBy&&(i.reservedBy=s.reservedBy),void 0!==s.reservedAt&&(i.reservedAt=s.reservedAt),void 0!==s.name&&(s.name&&s.name.trim()?i.name=s.name.trim():i.name=null),await (0,a.update)((0,a.ref)(t.database,`${r("tables")}/${e}`),i)},A=async(e,s,i,o)=>{let n={status:s,updatedAt:new Date().toISOString()};"available"===s?(n.activeOrderId=null,n.reservedBy=null,n.reservedAt=null):"reserved"===s?(n.reservedBy=o||null,n.reservedAt=new Date().toISOString()):"occupied"===s&&i&&(n.activeOrderId=i),await (0,a.update)((0,a.ref)(t.database,`${r("tables")}/${e}`),n)},R=async()=>Object.entries((await (0,a.get)((0,a.ref)(t.database,r("rooms")))).val()||{}).map(([e,t])=>({id:e,...t})).sort((e,t)=>(parseInt(String(e.roomNumber))||0)-(parseInt(String(t.roomNumber))||0)),D=async e=>{let s=(0,a.push)((0,a.ref)(t.database,r("rooms"))),i={roomNumber:e.roomNumber,status:e.status||"available",isActive:e.isActive??!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return e.name&&(i.name=e.name),e.notes&&(i.notes=e.notes),void 0!==e.hourlyRate&&e.hourlyRate>0&&(i.hourlyRate=e.hourlyRate),e.priceType&&(i.priceType=e.priceType),void 0!==e.malePrice&&(i.malePrice=e.malePrice),void 0!==e.femalePrice&&(i.femalePrice=e.femalePrice),await (0,a.set)(s,i),s.key},z=async(e,s)=>{let i={updatedAt:new Date().toISOString()};Object.entries(s).forEach(([e,t])=>{void 0!==t&&(i[e]=t)}),await (0,a.update)((0,a.ref)(t.database,`${r("rooms")}/${e}`),i)},F=async e=>{await (0,a.remove)((0,a.ref)(t.database,`${r("rooms")}/${e}`))},M=async(e,s,i,o)=>{let n={status:s,updatedAt:new Date().toISOString()};"available"===s?(n.activeOrderId=null,n.reservedBy=null,n.reservedAt=null):"reserved"===s?(n.reservedBy=o||null,n.reservedAt=new Date().toISOString()):"occupied"===s&&i&&(n.activeOrderId=i),await (0,a.update)((0,a.ref)(t.database,`${r("rooms")}/${e}`),n)},E=async()=>(await s()).filter(e=>"room"===e.orderType||e.roomId).sort((e,t)=>{let a=e.timestamp||(e.createdAt?new Date(e.createdAt).getTime():0);return(t.timestamp||(t.createdAt?new Date(t.createdAt).getTime():0))-a}),P=async e=>(await E()).filter(t=>{let a=t.timestamp||(t.createdAt?new Date(t.createdAt).getTime():0);return a>=e.start.getTime()&&a<=e.end.getTime()}),$=async(e,t)=>{await n(e,"completed"),await j(e,"paid"),await M(t,"available")};e.s(["addItemsToOrder",0,C,"closeRoomOrder",0,$,"createCategory",0,m,"createOrder",0,l,"createProduct",0,c,"createRoom",0,D,"createTable",0,I,"deleteCategory",0,y,"deleteProduct",0,u,"deleteRoom",0,F,"getCategories",0,f,"getCategoryProductCount",0,x,"getDateRangeForFilter",0,(e,t,a)=>{let r=new Date,s=new Date(r);s.setHours(23,59,59,999);let i=new Date(r);switch(i.setHours(0,0,0,0),e){case"today":break;case"week":i.setDate(i.getDate()-7);break;case"month":i.setMonth(i.getMonth()-1);break;case"year":i.setFullYear(i.getFullYear()-1);break;case"custom":t&&(i=new Date(t)),a&&(s.setTime(new Date(a).getTime()),s.setHours(23,59,59,999))}return{start:i,end:s}},"getDefaultWorkerPermissions",0,()=>({modules:{staffMenu:!0,orders:!1,tables:!1,rooms:!1,cashier:!1,inventory:!1,reports:!1,products:!1},actions:{createOrder:!0,editOrder:!1,cancelOrder:!1,processPayment:!1,applyDiscount:!1,viewFinancials:!1,manageProducts:!1,manageTables:!1,manageRooms:!1,dailyClosing:!1}}),"getFullPermissions",0,()=>({modules:{staffMenu:!0,orders:!0,tables:!0,rooms:!0,cashier:!0,inventory:!0,reports:!0,products:!0},actions:{createOrder:!0,editOrder:!0,cancelOrder:!0,processPayment:!0,applyDiscount:!0,viewFinancials:!0,manageProducts:!0,manageTables:!0,manageRooms:!0,dailyClosing:!0}}),"getOrder",0,o,"getOrders",0,s,"getOrdersByDateRange",0,i,"getProducts",0,d,"getRoomOrdersByDateRange",0,P,"getRooms",0,R,"getSalesStats",0,k,"getTables",0,O,"getTodayOrders",0,w,"getWorkers",0,S,"listenToOrders",0,e=>{let s=(0,a.ref)(t.database,r("orders")),i=(0,a.onValue)(s,t=>{e(Object.entries(t.val()||{}).map(([e,t])=>({id:e,...t})))});return()=>(0,a.off)(s,"value",i)},"listenToRooms",0,e=>{let s=(0,a.ref)(t.database,r("rooms")),i=(0,a.onValue)(s,t=>{e(Object.entries(t.val()||{}).map(([e,t])=>({id:e,...t})).sort((e,t)=>(parseInt(String(e.roomNumber))||0)-(parseInt(String(t.roomNumber))||0)))});return()=>(0,a.off)(s,"value",i)},"listenToTables",0,e=>{let s=(0,a.ref)(t.database,r("tables")),i=(0,a.onValue)(s,t=>{e(Object.entries(t.val()||{}).map(([e,t])=>({id:e,...t})))});return()=>(0,a.off)(s,"value",i)},"moveProductsToCategory",0,b,"setRoomStatus",0,M,"setTableStatus",0,A,"updateCategory",0,h,"updateOrderPaymentStatus",0,j,"updateOrderStatus",0,n,"updateProduct",0,p,"updateRoom",0,z,"updateTable",0,_,"updateWorkerPermissions",0,v])},16015,(e,t,a)=>{},98547,(e,t,a)=>{var r=e.i(47167);e.r(16015);var s=e.r(71645),i=s&&"object"==typeof s&&"default"in s?s:{default:s},o=void 0!==r.default&&r.default.env&&!0,n=function(e){return"[object String]"===Object.prototype.toString.call(e)},l=function(){function e(e){var t=void 0===e?{}:e,a=t.name,r=void 0===a?"stylesheet":a,s=t.optimizeForSpeed,i=void 0===s?o:s;d(n(r),"`name` must be a string"),this._name=r,this._deletedRulePlaceholder="#"+r+"-deleted-rule____{}",d("boolean"==typeof i,"`optimizeForSpeed` must be a boolean"),this._optimizeForSpeed=i,this._serverSheet=void 0,this._tags=[],this._injected=!1,this._rulesCount=0;var l="u">typeof window&&document.querySelector('meta[property="csp-nonce"]');this._nonce=l?l.getAttribute("content"):null}var t,a=e.prototype;return a.setOptimizeForSpeed=function(e){d("boolean"==typeof e,"`setOptimizeForSpeed` accepts a boolean"),d(0===this._rulesCount,"optimizeForSpeed cannot be when rules have already been inserted"),this.flush(),this._optimizeForSpeed=e,this.inject()},a.isOptimizeForSpeed=function(){return this._optimizeForSpeed},a.inject=function(){var e=this;if(d(!this._injected,"sheet already injected"),this._injected=!0,"u">typeof window&&this._optimizeForSpeed){this._tags[0]=this.makeStyleTag(this._name),this._optimizeForSpeed="insertRule"in this.getSheet(),this._optimizeForSpeed||(o||console.warn("StyleSheet: optimizeForSpeed mode not supported falling back to standard mode."),this.flush(),this._injected=!0);return}this._serverSheet={cssRules:[],insertRule:function(t,a){return"number"==typeof a?e._serverSheet.cssRules[a]={cssText:t}:e._serverSheet.cssRules.push({cssText:t}),a},deleteRule:function(t){e._serverSheet.cssRules[t]=null}}},a.getSheetForTag=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]},a.getSheet=function(){return this.getSheetForTag(this._tags[this._tags.length-1])},a.insertRule=function(e,t){if(d(n(e),"`insertRule` accepts only strings"),"u"<typeof window)return"number"!=typeof t&&(t=this._serverSheet.cssRules.length),this._serverSheet.insertRule(e,t),this._rulesCount++;if(this._optimizeForSpeed){var a=this.getSheet();"number"!=typeof t&&(t=a.cssRules.length);try{a.insertRule(e,t)}catch(t){return o||console.warn("StyleSheet: illegal rule: \n\n"+e+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),-1}}else{var r=this._tags[t];this._tags.push(this.makeStyleTag(this._name,e,r))}return this._rulesCount++},a.replaceRule=function(e,t){if(this._optimizeForSpeed||"u"<typeof window){var a="u">typeof window?this.getSheet():this._serverSheet;if(t.trim()||(t=this._deletedRulePlaceholder),!a.cssRules[e])return e;a.deleteRule(e);try{a.insertRule(t,e)}catch(r){o||console.warn("StyleSheet: illegal rule: \n\n"+t+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),a.insertRule(this._deletedRulePlaceholder,e)}}else{var r=this._tags[e];d(r,"old rule at index `"+e+"` not found"),r.textContent=t}return e},a.deleteRule=function(e){if("u"<typeof window)return void this._serverSheet.deleteRule(e);if(this._optimizeForSpeed)this.replaceRule(e,"");else{var t=this._tags[e];d(t,"rule at index `"+e+"` not found"),t.parentNode.removeChild(t),this._tags[e]=null}},a.flush=function(){this._injected=!1,this._rulesCount=0,"u">typeof window?(this._tags.forEach(function(e){return e&&e.parentNode.removeChild(e)}),this._tags=[]):this._serverSheet.cssRules=[]},a.cssRules=function(){var e=this;return"u"<typeof window?this._serverSheet.cssRules:this._tags.reduce(function(t,a){return a?t=t.concat(Array.prototype.map.call(e.getSheetForTag(a).cssRules,function(t){return t.cssText===e._deletedRulePlaceholder?null:t})):t.push(null),t},[])},a.makeStyleTag=function(e,t,a){t&&d(n(t),"makeStyleTag accepts only strings as second parameter");var r=document.createElement("style");this._nonce&&r.setAttribute("nonce",this._nonce),r.type="text/css",r.setAttribute("data-"+e,""),t&&r.appendChild(document.createTextNode(t));var s=document.head||document.getElementsByTagName("head")[0];return a?s.insertBefore(r,a):s.appendChild(r),r},t=[{key:"length",get:function(){return this._rulesCount}}],function(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}();function d(e,t){if(!e)throw Error("StyleSheet: "+t+".")}var c=function(e){for(var t=5381,a=e.length;a;)t=33*t^e.charCodeAt(--a);return t>>>0},p={};function u(e,t){if(!t)return"jsx-"+e;var a=String(t),r=e+a;return p[r]||(p[r]="jsx-"+c(e+"-"+a)),p[r]}function f(e,t){"u"<typeof window&&(t=t.replace(/\/style/gi,"\\/style"));var a=e+t;return p[a]||(p[a]=t.replace(/__jsx-style-dynamic-selector/g,e)),p[a]}var m=function(){function e(e){var t=void 0===e?{}:e,a=t.styleSheet,r=void 0===a?null:a,s=t.optimizeForSpeed,i=void 0!==s&&s;this._sheet=r||new l({name:"styled-jsx",optimizeForSpeed:i}),this._sheet.inject(),r&&"boolean"==typeof i&&(this._sheet.setOptimizeForSpeed(i),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer=void 0,this._indices={},this._instancesCounts={}}var t=e.prototype;return t.add=function(e){var t=this;void 0===this._optimizeForSpeed&&(this._optimizeForSpeed=Array.isArray(e.children),this._sheet.setOptimizeForSpeed(this._optimizeForSpeed),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),"u">typeof window&&!this._fromServer&&(this._fromServer=this.selectFromServer(),this._instancesCounts=Object.keys(this._fromServer).reduce(function(e,t){return e[t]=0,e},{}));var a=this.getIdAndRules(e),r=a.styleId,s=a.rules;if(r in this._instancesCounts){this._instancesCounts[r]+=1;return}var i=s.map(function(e){return t._sheet.insertRule(e)}).filter(function(e){return -1!==e});this._indices[r]=i,this._instancesCounts[r]=1},t.remove=function(e){var t=this,a=this.getIdAndRules(e).styleId;if(function(e,t){if(!e)throw Error("StyleSheetRegistry: "+t+".")}(a in this._instancesCounts,"styleId: `"+a+"` not found"),this._instancesCounts[a]-=1,this._instancesCounts[a]<1){var r=this._fromServer&&this._fromServer[a];r?(r.parentNode.removeChild(r),delete this._fromServer[a]):(this._indices[a].forEach(function(e){return t._sheet.deleteRule(e)}),delete this._indices[a]),delete this._instancesCounts[a]}},t.update=function(e,t){this.add(t),this.remove(e)},t.flush=function(){this._sheet.flush(),this._sheet.inject(),this._fromServer=void 0,this._indices={},this._instancesCounts={}},t.cssRules=function(){var e=this,t=this._fromServer?Object.keys(this._fromServer).map(function(t){return[t,e._fromServer[t]]}):[],a=this._sheet.cssRules();return t.concat(Object.keys(this._indices).map(function(t){return[t,e._indices[t].map(function(e){return a[e].cssText}).join(e._optimizeForSpeed?"":"\n")]}).filter(function(e){return!!e[1]}))},t.styles=function(e){var t,a;return t=this.cssRules(),void 0===(a=e)&&(a={}),t.map(function(e){var t=e[0],r=e[1];return i.default.createElement("style",{id:"__"+t,key:"__"+t,nonce:a.nonce?a.nonce:void 0,dangerouslySetInnerHTML:{__html:r}})})},t.getIdAndRules=function(e){var t=e.children,a=e.dynamic,r=e.id;if(a){var s=u(r,a);return{styleId:s,rules:Array.isArray(t)?t.map(function(e){return f(s,e)}):[f(s,t)]}}return{styleId:u(r),rules:Array.isArray(t)?t:[t]}},t.selectFromServer=function(){return Array.prototype.slice.call(document.querySelectorAll('[id^="__jsx-"]')).reduce(function(e,t){return e[t.id.slice(2)]=t,e},{})},e}(),h=s.createContext(null);function y(){return new m}function g(){return s.useContext(h)}h.displayName="StyleSheetContext";var x=i.default.useInsertionEffect||i.default.useLayoutEffect,b="u">typeof window?y():void 0;function S(e){var t=b||g();return t&&("u"<typeof window?t.add(e):x(function(){return t.add(e),function(){t.remove(e)}},[e.id,String(e.dynamic)])),null}S.dynamic=function(e){return e.map(function(e){return u(e[0],e[1])}).join(" ")},a.StyleRegistry=function(e){var t=e.registry,a=e.children,r=s.useContext(h),o=s.useState(function(){return r||t||y()})[0];return i.default.createElement(h.Provider,{value:o},a)},a.createStyleRegistry=y,a.style=S,a.useStyleRegistry=g},37902,(e,t,a)=>{t.exports=e.r(98547).style},55436,e=>{"use strict";let t=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>t],55436)},7233,e=>{"use strict";let t=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],7233)},27612,e=>{"use strict";let t=(0,e.i(75254).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>t],27612)},99023,e=>{"use strict";let t=(0,e.i(75254).default)("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);e.s(["Minus",()=>t],99023)},43531,e=>{"use strict";let t=(0,e.i(75254).default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["Check",()=>t],43531)},43432,e=>{"use strict";let t=(0,e.i(75254).default)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]]);e.s(["Phone",()=>t],43432)},92930,e=>{"use strict";let t=(0,e.i(75254).default)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);e.s(["Edit2",()=>t],92930)},70756,e=>{"use strict";let t=(0,e.i(75254).default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);e.s(["Lock",()=>t],70756)},50965,e=>{"use strict";let t=(0,e.i(75254).default)("shopping-bag",[["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}],["path",{d:"M3.103 6.034h17.794",key:"awc11p"}],["path",{d:"M3.4 5.467a2 2 0 0 0-.4 1.2V20a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6.667a2 2 0 0 0-.4-1.2l-2-2.667A2 2 0 0 0 17 2H7a2 2 0 0 0-1.6.8z",key:"o988cm"}]]);e.s(["ShoppingBag",()=>t],50965)},16715,e=>{"use strict";let t=(0,e.i(75254).default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["RefreshCw",()=>t],16715)},69638,e=>{"use strict";let t=(0,e.i(75254).default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircle",()=>t],69638)},63209,e=>{"use strict";let t=(0,e.i(75254).default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>t],63209)},84614,e=>{"use strict";let t=(0,e.i(75254).default)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);e.s(["User",()=>t],84614)},87316,e=>{"use strict";let t=(0,e.i(75254).default)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);e.s(["Calendar",()=>t],87316)},25652,e=>{"use strict";let t=(0,e.i(75254).default)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);e.s(["TrendingUp",()=>t],25652)},78583,e=>{"use strict";let t=(0,e.i(75254).default)("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);e.s(["FileText",()=>t],78583)},1404,e=>{"use strict";var t=e.i(33842);e.i(1465);var a=e.i(34991);let r=e=>`restaurant-system/${e}/${t.RESTAURANT_ID}`,s=async(e,s,i)=>{let o=(await (0,a.get)((0,a.ref)(t.database,r("orders")))).val()||{},n=e.getTime(),l=s.getTime(),d=Object.entries(o).map(([e,t])=>({id:e,...t})).filter(e=>{let t=e.timestamp||new Date(e.createdAt).getTime();return t>=n&&t<=l});return i?.paymentMethod&&(d=d.filter(e=>e.paymentMethod===i.paymentMethod)),i?.orderType&&(d=d.filter(e=>e.orderType===i.orderType)),i?.status&&(d=d.filter(e=>e.status===i.status)),d.sort((e,t)=>{let a=e.timestamp||new Date(e.createdAt).getTime();return(t.timestamp||new Date(t.createdAt).getTime())-a})},i=async(e,t)=>{let a=await s(e,t),r=new Map;a.filter(e=>"cancelled"!==e.status).forEach(e=>{let t=new Date(e.createdAt).toISOString().split("T")[0],a=r.get(t)||{totalSales:0,totalOrders:0,cashSales:0,cardSales:0};a.totalSales+=e.total||0,a.totalOrders+=1,"cash"===e.paymentMethod?a.cashSales+=e.total||0:"card"===e.paymentMethod&&(a.cardSales+=e.total||0),r.set(t,a)});let i=[],o=new Date(e);for(;o<=t;){let e=o.toISOString().split("T")[0],t=r.get(e)||{totalSales:0,totalOrders:0,cashSales:0,cardSales:0};i.push({date:e,...t,averageOrder:t.totalOrders>0?t.totalSales/t.totalOrders:0}),o.setDate(o.getDate()+1)}return i},o=async(e,t)=>{let a=await i(e,t),r=new Map;return a.forEach(e=>{let t=new Date(new Date(e.date));t.setDate(t.getDate()-t.getDay());let a=t.toISOString().split("T")[0],s=r.get(a)||{date:a,totalSales:0,totalOrders:0,cashSales:0,cardSales:0,averageOrder:0};s.totalSales+=e.totalSales,s.totalOrders+=e.totalOrders,s.cashSales+=e.cashSales,s.cardSales+=e.cardSales,r.set(a,s)}),Array.from(r.entries()).map(([e,t])=>({week:e,stats:{...t,averageOrder:t.totalOrders>0?t.totalSales/t.totalOrders:0}})).sort((e,t)=>e.week.localeCompare(t.week))},n=async(e,t)=>{let a=await i(e,t),r=new Map;return a.forEach(e=>{let t=e.date.substring(0,7),a=r.get(t)||{date:t,totalSales:0,totalOrders:0,cashSales:0,cardSales:0,averageOrder:0};a.totalSales+=e.totalSales,a.totalOrders+=e.totalOrders,a.cashSales+=e.cashSales,a.cardSales+=e.cardSales,r.set(t,a)}),Array.from(r.entries()).map(([e,t])=>({month:e,stats:{...t,averageOrder:t.totalOrders>0?t.totalSales/t.totalOrders:0}})).sort((e,t)=>e.month.localeCompare(t.month))},l=async(e,i,o=10)=>{let n=await s(e,i),l=new Map;try{let e=(await (0,a.get)((0,a.ref)(t.database,r("menu")))).val()||{};Object.entries(e).forEach(([e,t])=>{l.set(e,{nameEn:t.nameEn})})}catch(e){console.error("Error fetching products for English names:",e)}let d=new Map;return n.filter(e=>"cancelled"!==e.status).forEach(e=>{e.items?.forEach(e=>{let t=d.get(e.id)||{id:e.id,name:e.name,nameEn:l.get(e.id)?.nameEn,emoji:e.emoji,quantity:0,revenue:0};t.quantity+=e.quantity,t.revenue+=e.itemTotal||e.price*e.quantity,d.set(e.id,t)})}),Array.from(d.values()).sort((e,t)=>t.revenue-e.revenue).slice(0,o)},d=async(e=30)=>Object.entries((await (0,a.get)((0,a.ref)(t.database,r("daily_closings")))).val()||{}).map(([e,t])=>({id:e,...t})).sort((e,t)=>t.timestamp-e.timestamp).slice(0,e),c=async e=>(await d(100)).find(t=>t.date===e)||null,p=async e=>{if(await c(e.date))throw Error("تم إغلاق هذا اليوم مسبقاً");let s=(0,a.push)((0,a.ref)(t.database,r("daily_closings"))),i={id:s.key,date:e.date,openingCash:e.openingCash,cashSales:e.cashSales,cardSales:e.cardSales,totalSales:e.totalSales,expenses:e.expenses,actualCash:e.actualCash,difference:e.difference,closedBy:e.closedBy,closedAt:new Date().toISOString(),timestamp:Date.now()};return e.notes&&(i.notes=e.notes),e.closedByName&&(i.closedByName=e.closedByName),await (0,a.set)(s,i),i.id},u=async(e,t)=>{let a=t.getTime()-e.getTime(),r=new Date(e.getTime()-a),i=new Date(e.getTime()-1),o=await s(e,t),n=await s(r,i),l=o.filter(e=>"cancelled"!==e.status).reduce((e,t)=>e+(t.total||0),0),d=n.filter(e=>"cancelled"!==e.status).reduce((e,t)=>e+(t.total||0),0);return{current:l,previous:d,percentChange:d>0?(l-d)/d*100:100*(l>0)}},f=async e=>{let t=new Date(e+"T00:00:00.000Z"),a=new Date(e+"T23:59:59.999Z"),r=new Date(e);r.setHours(0,0,0,0);let i=new Date(e);i.setHours(23,59,59,999),console.log("getTodaySalesForClosing - Date range:",{date:e,startUTC:t.toISOString(),endUTC:a.toISOString(),startLocal:r.toISOString(),endLocal:i.toISOString()});let o=await s(r,i);console.log("getTodaySalesForClosing - Found orders:",o.length);let n=o.filter(e=>"cancelled"!==e.status);console.log("getTodaySalesForClosing - Non-cancelled orders:",n.length);let l=n.filter(e=>"completed"===e.status||"paid"===e.status||"paid"===e.paymentStatus);console.log("getTodaySalesForClosing - Paid orders:",l.length,l.map(e=>({id:e.id,status:e.status,paymentStatus:e.paymentStatus,paymentMethod:e.paymentMethod,total:e.total})));let d=l.filter(e=>"cash"===e.paymentMethod&&e.total&&e.total>0).reduce((e,t)=>e+(Number(t.total)||0),0),c=l.filter(e=>"card"===e.paymentMethod&&e.total&&e.total>0).reduce((e,t)=>e+(Number(t.total)||0),0),p=l.filter(e=>!e.paymentMethod&&e.total&&e.total>0).reduce((e,t)=>e+(Number(t.total)||0),0),u=l.length,f=n.filter(e=>"paid"!==e.status&&"completed"!==e.status&&"paid"!==e.paymentStatus).length,m=n.filter(e=>"table"===e.orderType).length,h=n.filter(e=>"room"===e.orderType).length,y=n.filter(e=>"takeaway"===e.orderType||!e.orderType).length,g=d+p;return{cashSales:g,cardSales:c,totalSales:g+c,ordersCount:n.length,paidOrdersCount:u,unpaidOrdersCount:f,tableOrdersCount:m,roomOrdersCount:h,takeawayOrdersCount:y,orders:n}},m=async e=>null!==await c(e),h=async e=>{if(await c(e.date))throw Error("تم إغلاق هذا اليوم مسبقاً");let s=(0,a.push)((0,a.ref)(t.database,r("daily_closings"))),i={id:s.key,date:e.date,openingCash:e.openingCash,cashSales:e.cashSales,cardSales:e.cardSales,totalSales:e.totalSales,expenses:e.expenses,actualCash:e.actualCash,difference:e.difference,closedBy:e.closedBy,closedAt:new Date().toISOString(),timestamp:Date.now(),isLocked:!0,lockedAt:new Date().toISOString()};return e.notes&&(i.notes=e.notes),e.closedByName&&(i.closedByName=e.closedByName),void 0!==e.ordersCount&&(i.ordersCount=e.ordersCount),void 0!==e.paidOrdersCount&&(i.paidOrdersCount=e.paidOrdersCount),void 0!==e.unpaidOrdersCount&&(i.unpaidOrdersCount=e.unpaidOrdersCount),void 0!==e.tableOrdersCount&&(i.tableOrdersCount=e.tableOrdersCount),void 0!==e.roomOrdersCount&&(i.roomOrdersCount=e.roomOrdersCount),void 0!==e.takeawayOrdersCount&&(i.takeawayOrdersCount=e.takeawayOrdersCount),await (0,a.set)(s,i),i.id};e.s(["calculateReportStats",0,e=>{let t,a=e.filter(e=>"cancelled"!==e.status),r=a.reduce((e,t)=>e+(t.total||0),0),s=a.length,i=a.filter(e=>"cash"===e.paymentMethod).reduce((e,t)=>e+(t.total||0),0),o=a.filter(e=>"card"===e.paymentMethod).reduce((e,t)=>e+(t.total||0),0),n=a.filter(e=>"paid"===e.paymentStatus||"completed"===e.status).length,l=a.length-n,d=a.filter(e=>"table"===e.orderType).length,c=a.filter(e=>"room"===e.orderType).length,p=a.filter(e=>"takeaway"===e.orderType||!e.orderType).length,u=new Map;a.forEach(e=>{e.items?.forEach(e=>{let t=u.get(e.id)||{name:e.name,quantity:0,revenue:0};t.quantity+=e.quantity,t.revenue+=e.itemTotal||e.price*e.quantity,u.set(e.id,t)})});let f=0;return u.forEach(e=>{e.revenue>f&&(f=e.revenue,t=e)}),{totalSales:r,totalOrders:s,averageOrderValue:s>0?r/s:0,cashSales:i,cardSales:o,paidOrders:n,unpaidOrders:l,tableOrders:d,roomOrders:c,takeawayOrders:p,topProduct:t}},"createDailyClosing",0,p,"createEnhancedDailyClosing",0,h,"formatDateArabic",0,e=>new Date(e).toLocaleDateString("ar-EG",{year:"numeric",month:"short",day:"numeric"}),"getDailyClosingByDate",0,c,"getDailyClosings",0,d,"getDailyStatsForRange",0,i,"getDateRangeBounds",0,(e,t,a)=>{let r=new Date,s=new Date(r);s.setHours(23,59,59,999);let i=new Date(r);switch(i.setHours(0,0,0,0),e){case"today":break;case"week":i.setDate(i.getDate()-7);break;case"month":i.setMonth(i.getMonth()-1);break;case"year":i.setFullYear(i.getFullYear()-1);break;case"custom":t&&(i=new Date(t)),a&&(s.setTime(a.getTime()),s.setHours(23,59,59,999))}return{start:i,end:s}},"getMonthlyStats",0,n,"getOrdersByDateRange",0,s,"getSalesTrend",0,u,"getTodaySalesForClosing",0,f,"getTopProducts",0,l,"getWeeklyStats",0,o,"isDayClosed",0,m])},42098,e=>{"use strict";var t=e.i(43476),a=e.i(37902),r=e.i(71645),s=e.i(13056),i=e.i(84103),o=e.i(4050),n=e.i(64066),l=e.i(12034),d=e.i(5229),c=e.i(83505),p=e.i(16173),u=e.i(28801),f=e.i(16715),m=e.i(91741),h=e.i(3116),y=e.i(63209),g=e.i(69638),x=e.i(37727),b=e.i(1928),S=e.i(61659),v=e.i(70756);function w(){let{user:e}=(0,s.useAuth)(),[x,w]=(0,r.useState)("desktop"),[C,k]=(0,r.useState)("products"),[O,T]=(0,r.useState)([]),[N,I]=(0,r.useState)([]),[_,A]=(0,r.useState)([]),[R,D]=(0,r.useState)([]),[z,F]=(0,r.useState)([]),[M,E]=(0,r.useState)(!0),[P,$]=(0,r.useState)(!1),[W,B]=(0,r.useState)(null),[q,L]=(0,r.useState)([]),[U,H]=(0,r.useState)(!1),[V,Y]=(0,r.useState)(!1),[K,X]=(0,r.useState)(!1),[Z,G]=(0,r.useState)(null),[Q,J]=(0,r.useState)(null),[ee,et]=(0,r.useState)(null),[ea,er]=(0,r.useState)(!1),[es,ei]=(0,r.useState)(null);(0,r.useEffect)(()=>{let e=()=>{let e=window.innerWidth;e<640?w("mobile"):e<1024?w("tablet"):e<1440?w("desktop"):w("wide")};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let eo=async()=>{E(!0);try{let[e,t,a,r,s]=await Promise.all([(0,o.getPOSProducts)(),(0,o.getPOSCategories)(),(0,o.getAvailableTables)(),(0,o.getAvailableRooms)(),(0,o.getTodayPendingOrders)()]);T(e),I(t),A(a),D(r),F(s)}catch(e){console.error("Error loading data:",e),en("خطأ في تحميل البيانات","error")}finally{E(!1)}};(0,r.useEffect)(()=>{eo()},[]),(0,r.useEffect)(()=>{let e=async()=>{let e=new URLSearchParams(window.location.search),t=e.get("orderId"),a=e.get("roomId"),r=e.get("tableId"),s=e.get("mode");if(t&&t.trim()&&"add"===s){try{console.log("Loading order for adding items:",t);let e=await (0,i.getOrder)(t);e&&"paid"!==e.paymentStatus&&"completed"!==e.status?(ei(e),er(!0),en(`وضع إضافة طلب للطاولة ${e.tableNumber||e.tableId?.slice(-4)||""}`,"success")):e&&en("هذا الطلب مدفوع بالفعل ولا يمكن الإضافة إليه","error")}catch(e){console.error("Error loading order for add mode:",e)}return}if(t&&t.trim())try{console.log("Loading order from URL:",t);let e=await (0,i.getOrder)(t);if(console.log("Loaded order:",e),e&&"paid"!==e.paymentStatus&&"completed"!==e.status){et(e),en(`تم تحميل الطلب #${t.slice(-6).toUpperCase()}`,"success");return}e&&en("هذا الطلب مدفوع بالفعل","error")}catch(e){console.error("Error loading order from URL:",e)}if(a&&a.trim())try{console.log("Searching for room order:",a);let e=(await (0,o.getTodayPendingOrders)()).find(e=>e.roomId===a&&"paid"!==e.paymentStatus&&"completed"!==e.status);if(e){et(e),en(`تم تحميل طلب الغرفة #${e.id.slice(-6).toUpperCase()}`,"success");return}en("لا يوجد طلب نشط لهذه الغرفة","error")}catch(e){console.error("Error searching room order:",e)}if(r&&r.trim())try{console.log("Searching for table order:",r);let e=(await (0,o.getTodayPendingOrders)()).find(e=>e.tableId===r&&"paid"!==e.paymentStatus&&"completed"!==e.status);if(e){et(e),en(`تم تحميل طلب الطاولة #${e.id.slice(-6).toUpperCase()}`,"success");return}en("لا يوجد طلب نشط لهذه الطاولة","error")}catch(e){console.error("Error searching table order:",e)}};M||e()},[M]),(0,r.useEffect)(()=>{let e=new Date;e.setHours(0,0,0,0);let t=e.getTime(),a=(0,i.listenToOrders)(e=>{F(e.filter(e=>(e.timestamp||new Date(e.createdAt).getTime())>=t&&"completed"!==e.status&&"cancelled"!==e.status&&"paid"!==e.paymentStatus).sort((e,t)=>{let a=e.timestamp||new Date(e.createdAt).getTime();return(t.timestamp||new Date(t.createdAt).getTime())-a}))});return()=>a()},[]),(0,r.useEffect)(()=>{let e=e=>{if("Escape"===e.key&&(W?B(null):Z?G(null):q.length>0&&H(!0)),"/"===e.key&&!e.ctrlKey&&!e.metaKey){e.preventDefault();let t=document.querySelector('input[placeholder*="ابحث"]');t?.focus()}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[W,Z,q]);let en=(e,t)=>{J({message:e,type:t}),setTimeout(()=>J(null),3e3)},el=(e,t,a,r)=>{let s=t?t.price:e.price||e.basePrice||0,i={id:`${e.id}_${t?.id||"default"}_${Date.now()}`,productId:e.id,name:e.name,emoji:e.emoji,variationId:t?.id,variationName:t?.name,unitPrice:s,quantity:a,note:r||void 0,lineTotal:s*a};L(e=>[...e,i]),en(`تم إضافة ${e.name}`,"success")},ed=e=>{L(t=>t.filter(t=>t.id!==e))},ec=async t=>{if(!e)return void en("يجب تسجيل الدخول","error");$(!0);try{if(ea&&es){let e=t.items.map(e=>{let t={id:e.productId||e.id,name:e.name,price:e.unitPrice||0,quantity:e.quantity,itemTotal:e.lineTotal||e.quantity*(e.unitPrice||0)};return e.emoji&&(t.emoji=e.emoji),e.note&&(t.note=e.note),t});await (0,i.addItemsToOrder)(es.id,e),en(`تم إضافة ${e.length} صنف للطلب #${es.id.slice(-6).toUpperCase()}`,"success"),L([]),er(!1),ei(null),window.history.back()}else{let a=await (0,o.createPOSOrder)(t,e.id,e.name);en(`تم إنشاء الطلب #${a.slice(-6).toUpperCase()}`,"success"),L([]),await eo()}}catch(e){console.error("Error creating/updating order:",e),en("خطأ في الطلب","error")}finally{$(!1)}},ep=async(t,a,r)=>{if(!e)return void en("يجب تسجيل الدخول","error");$(!0);try{let s=isNaN(r)?t.total:r,i=await (0,o.createPOSOrder)(t,e.id,e.name),n="cash"===a?Math.max(0,s-t.total):0;await (0,o.payAndCloseOrder)(i,{method:a,receivedAmount:s,change:n},e.id,e.name),G({orderNumber:i.slice(-6).toUpperCase(),items:t.items,subtotal:t.subtotal||0,discount:t.discount?.amount||0,tax:t.tax?.amount||0,total:t.total||0,paymentMethod:a,receivedAmount:s,change:n,customerName:t.customerName,tableNumber:t.tableNumber,roomNumber:t.roomNumber,cashierName:e.name,orderType:t.orderType}),L([]),en("تم الدفع بنجاح","success"),await eo()}catch(e){console.error("Error processing payment:",e),en("خطأ في معالجة الدفع","error")}finally{$(!1)}},eu=async(t,a,r)=>{if(!e)return void en("يجب تسجيل الدخول","error");$(!0);try{let s=isNaN(r)?t.total:r,i="cash"===a?Math.max(0,s-t.total):0;await (0,o.payAndCloseOrder)(t.id,{method:a,receivedAmount:s,change:i},e.id,e.name),G({orderNumber:t.id.slice(-6).toUpperCase(),items:t.items.map(e=>({id:e.id,productId:e.id,name:e.name,unitPrice:e.price||0,quantity:e.quantity,lineTotal:e.itemTotal||(e.price||0)*e.quantity,emoji:e.emoji,note:e.note})),subtotal:t.subtotal||t.total||0,discount:t.discount?.amount||0,tax:0,total:t.total||0,paymentMethod:a,receivedAmount:s,change:i,customerName:t.customerName,tableNumber:t.tableNumber,roomNumber:t.roomNumber,cashierName:e.name,orderType:t.orderType||"takeaway"}),et(null),en("تم الدفع بنجاح","success"),await eo()}catch(e){console.error("Error paying pending order:",e),en("خطأ في معالجة الدفع","error")}finally{$(!1)}};if(M)return(0,t.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh",backgroundColor:"#f1f5f9"},children:(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"16px"},children:[(0,t.jsx)("div",{style:{width:"48px",height:"48px",border:"4px solid #e2e8f0",borderTopColor:"#6366f1",borderRadius:"50%",animation:"spin 1s linear infinite"}}),(0,t.jsx)("p",{style:{fontSize:"16px",color:"#64748b"},children:"جاري تحميل الكاشير..."})]})});let ef="mobile"===x,em="tablet"===x,eh=q.reduce((e,t)=>e+t.quantity,0);return q.reduce((e,t)=>e+t.lineTotal,0),(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"calc(100vh - 120px)",minHeight:ef?"auto":void 0,backgroundColor:"#f1f5f9"},className:"jsx-377925501a464ba5",children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:ef?"12px 16px":"tablet"===x?"14px 20px":"16px 24px",backgroundColor:"#ffffff",borderBottom:"1px solid #e2e8f0",flexWrap:ef?"wrap":"nowrap",gap:ef?"12px":"0"},className:"jsx-377925501a464ba5",children:[(0,t.jsxs)("div",{style:{flex:ef?"1 1 100%":"none"},className:"jsx-377925501a464ba5",children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},className:"jsx-377925501a464ba5",children:[(0,t.jsx)("h1",{style:{fontSize:ef?"18px":"20px",fontWeight:700,color:"#0f172a",margin:0},className:"jsx-377925501a464ba5",children:ea?"إضافة طلب للطاولة":"الكاشير"}),ea&&es&&(0,t.jsxs)("span",{style:{padding:"4px 12px",backgroundColor:"#dbeafe",color:"#1d4ed8",borderRadius:"20px",fontSize:"12px",fontWeight:700,display:"flex",alignItems:"center",gap:"6px"},className:"jsx-377925501a464ba5",children:["طاولة ",es.tableNumber||es.tableId?.slice(-4),(0,t.jsx)("button",{onClick:()=>{er(!1),ei(null),window.history.back()},style:{width:"18px",height:"18px",borderRadius:"50%",backgroundColor:"#1d4ed8",color:"#ffffff",border:"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px"},className:"jsx-377925501a464ba5",children:"×"})]})]}),(0,t.jsx)("p",{style:{fontSize:ef?"12px":"13px",color:"#64748b",marginTop:"2px"},className:"jsx-377925501a464ba5",children:ea?`إضافة أصناف للطلب #${es?.id.slice(-6).toUpperCase()||""}`:`نقطة البيع - ${e?.name||"مستخدم"}`})]}),(0,t.jsxs)("div",{style:{display:"flex",gap:ef?"8px":"12px",flexWrap:"wrap"},className:"jsx-377925501a464ba5",children:[!ef&&(0,t.jsxs)("button",{onClick:()=>Y(!V),style:{display:"flex",alignItems:"center",gap:"8px",padding:"tablet"===x?"8px 12px":"10px 16px",backgroundColor:V?"#6366f1":"#f1f5f9",border:"1px solid #e2e8f0",borderRadius:"10px",fontSize:"tablet"===x?"12px":"13px",fontWeight:600,color:V?"#ffffff":"#475569",cursor:"pointer",position:"relative"},className:"jsx-377925501a464ba5",children:[(0,t.jsx)(m.ClipboardList,{style:{width:"18px",height:"18px"}}),"tablet"!==x&&"الطلبات المعلقة",z.length>0&&(0,t.jsx)("span",{style:{position:"absolute",top:"-6px",left:"-6px",width:"20px",height:"20px",backgroundColor:"#dc2626",borderRadius:"50%",fontSize:"11px",fontWeight:700,color:"#ffffff",display:"flex",alignItems:"center",justifyContent:"center"},className:"jsx-377925501a464ba5",children:z.length})]}),!ef&&(0,t.jsxs)("button",{onClick:()=>X(!0),style:{display:"flex",alignItems:"center",gap:"8px",padding:"tablet"===x?"8px 12px":"10px 16px",background:"linear-gradient(135deg, #dc2626 0%, #b91c1c 100%)",border:"none",borderRadius:"10px",fontSize:"tablet"===x?"12px":"13px",fontWeight:600,color:"#ffffff",cursor:"pointer",boxShadow:"0 2px 8px rgba(220, 38, 38, 0.25)"},className:"jsx-377925501a464ba5",children:[(0,t.jsx)(v.Lock,{style:{width:"16px",height:"16px"}}),"tablet"!==x&&"إغلاق اليوم"]}),(0,t.jsxs)("button",{onClick:eo,style:{display:"flex",alignItems:"center",gap:ef?"4px":"8px",padding:ef||"tablet"===x?"8px 12px":"10px 16px",backgroundColor:"#f1f5f9",border:"1px solid #e2e8f0",borderRadius:"10px",fontSize:ef?"12px":"13px",fontWeight:600,color:"#475569",cursor:"pointer"},className:"jsx-377925501a464ba5",children:[(0,t.jsx)(f.RefreshCw,{style:{width:ef?"16px":"18px",height:ef?"16px":"18px"}}),"تحديث"]})]})]}),(ef||em)&&(0,t.jsxs)("div",{style:{position:"fixed",bottom:0,left:0,right:0,display:"flex",backgroundColor:"#ffffff",borderTop:"1px solid #e2e8f0",zIndex:100,padding:"8px",gap:"8px",boxShadow:"0 -2px 10px rgba(0, 0, 0, 0.1)"},className:"jsx-377925501a464ba5",children:[(0,t.jsxs)("button",{onClick:()=>k("products"),style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",gap:"4px",padding:"8px",backgroundColor:"products"===C?"#6366f1":"transparent",border:"none",borderRadius:"8px",color:"products"===C?"#ffffff":"#64748b",fontSize:"11px",cursor:"pointer"},className:"jsx-377925501a464ba5",children:[(0,t.jsx)(m.ClipboardList,{style:{width:"20px",height:"20px"}}),"المنتجات"]}),(0,t.jsxs)("button",{onClick:()=>k("cart"),style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",gap:"4px",padding:"8px",backgroundColor:"cart"===C?"#6366f1":"transparent",border:"none",borderRadius:"8px",color:"cart"===C?"#ffffff":"#64748b",fontSize:"11px",cursor:"pointer",position:"relative"},className:"jsx-377925501a464ba5",children:[(0,t.jsx)(b.ShoppingCart,{style:{width:"20px",height:"20px"}}),"السلة",eh>0&&(0,t.jsx)("span",{style:{position:"absolute",top:"2px",right:"50%",transform:"translateX(14px)",minWidth:"18px",height:"18px",backgroundColor:"#dc2626",borderRadius:"9px",fontSize:"10px",fontWeight:700,color:"#ffffff",display:"flex",alignItems:"center",justifyContent:"center",padding:"0 4px"},className:"jsx-377925501a464ba5",children:eh})]}),(0,t.jsxs)("button",{onClick:()=>k("payment"),style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",gap:"4px",padding:"8px",backgroundColor:"payment"===C?"#6366f1":"transparent",border:"none",borderRadius:"8px",color:"payment"===C?"#ffffff":"#64748b",fontSize:"11px",cursor:"pointer"},className:"jsx-377925501a464ba5",children:[(0,t.jsx)(S.CreditCard,{style:{width:"20px",height:"20px"}}),"الدفع"]}),(0,t.jsxs)("button",{onClick:()=>Y(!V),style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",gap:"4px",padding:"8px",backgroundColor:V?"#f59e0b":"transparent",border:"none",borderRadius:"8px",color:V?"#ffffff":"#64748b",fontSize:"11px",cursor:"pointer",position:"relative"},className:"jsx-377925501a464ba5",children:[(0,t.jsx)(h.Clock,{style:{width:"20px",height:"20px"}}),"معلقة",z.length>0&&(0,t.jsx)("span",{style:{position:"absolute",top:"2px",right:"50%",transform:"translateX(14px)",minWidth:"18px",height:"18px",backgroundColor:"#dc2626",borderRadius:"9px",fontSize:"10px",fontWeight:700,color:"#ffffff",display:"flex",alignItems:"center",justifyContent:"center",padding:"0 4px"},className:"jsx-377925501a464ba5",children:z.length})]}),(0,t.jsxs)("button",{onClick:()=>X(!0),style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",gap:"4px",padding:"8px",backgroundColor:"transparent",border:"none",borderRadius:"8px",color:"#dc2626",fontSize:"11px",cursor:"pointer"},className:"jsx-377925501a464ba5",children:[(0,t.jsx)(v.Lock,{style:{width:"20px",height:"20px"}}),"إغلاق"]})]}),(0,t.jsxs)("div",{style:{flex:1,display:ef||em?"block":"grid",gridTemplateColumns:ef||em||"mobile"===x?"1fr":"tablet"===x?V?"200px 1fr 280px":"1fr 280px":"desktop"===x?V?"240px 1fr 300px 280px":"1fr 300px 280px":V?"280px 1fr 340px 320px":"1fr 340px 320px",gap:ef||em?"0":"16px",padding:ef?"12px":em?"12px 16px":"16px 24px",paddingBottom:ef||em?"80px":void 0,overflow:"auto"},className:"jsx-377925501a464ba5",children:[V&&(!(ef||em)||"products"===C)&&(0,t.jsxs)("div",{style:{backgroundColor:"#ffffff",borderRadius:"16px",border:"1px solid #e2e8f0",overflow:"hidden",display:"flex",flexDirection:"column"},className:"jsx-377925501a464ba5",children:[(0,t.jsx)("div",{style:{padding:"16px",borderBottom:"1px solid #e2e8f0",backgroundColor:"#fef3c7"},className:"jsx-377925501a464ba5",children:(0,t.jsxs)("h3",{style:{fontSize:"14px",fontWeight:700,color:"#92400e",margin:0,display:"flex",alignItems:"center",gap:"8px"},className:"jsx-377925501a464ba5",children:[(0,t.jsx)(h.Clock,{style:{width:"18px",height:"18px"}}),"الطلبات المعلقة (",z.length,")"]})}),(0,t.jsx)("div",{style:{flex:1,overflowY:"auto",padding:"12px"},className:"jsx-377925501a464ba5",children:0===z.length?(0,t.jsx)("p",{style:{textAlign:"center",color:"#94a3b8",fontSize:"13px",padding:"24px"},className:"jsx-377925501a464ba5",children:"لا توجد طلبات معلقة"}):(0,t.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},className:"jsx-377925501a464ba5",children:z.map(e=>(0,t.jsxs)("div",{onClick:()=>et(e),style:{padding:"12px",backgroundColor:"#f8fafc",borderRadius:"10px",border:"1px solid #e2e8f0",cursor:"pointer",transition:"all 0.2s"},onMouseOver:e=>{e.currentTarget.style.backgroundColor="#f1f5f9",e.currentTarget.style.borderColor="#6366f1"},onMouseOut:e=>{e.currentTarget.style.backgroundColor="#f8fafc",e.currentTarget.style.borderColor="#e2e8f0"},className:"jsx-377925501a464ba5",children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},className:"jsx-377925501a464ba5",children:[(0,t.jsxs)("span",{style:{fontSize:"13px",fontWeight:700,color:"#6366f1"},className:"jsx-377925501a464ba5",children:["#",e.id.slice(-6).toUpperCase()]}),(0,t.jsx)("span",{style:{padding:"2px 8px",backgroundColor:"#fef3c7",borderRadius:"6px",fontSize:"10px",fontWeight:600,color:"#f59e0b"},className:"jsx-377925501a464ba5",children:"pending"===e.status?"معلق":"قيد التحضير"})]}),(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"12px",color:"#64748b"},className:"jsx-377925501a464ba5",children:[(0,t.jsxs)("span",{className:"jsx-377925501a464ba5",children:[e.itemsCount||e.items?.length," عناصر"]}),(0,t.jsxs)("span",{style:{fontWeight:600,color:"#16a34a"},className:"jsx-377925501a464ba5",children:[e.total.toFixed(3)," ر.ع"]})]}),(e.tableNumber||e.roomNumber)&&(0,t.jsx)("p",{style:{fontSize:"11px",color:"#94a3b8",marginTop:"6px"},className:"jsx-377925501a464ba5",children:e.tableNumber?`طاولة ${e.tableNumber}`:`غرفة ${e.roomNumber}`})]},e.id))})})]}),(!(ef||em)||"products"===C)&&(0,t.jsx)(n.default,{products:O,categories:N,onProductClick:e=>{e.variations&&e.variations.length>0||e.sizes&&Object.keys(e.sizes).length>0||e.shishaTypes&&Object.keys(e.shishaTypes).length>0?B(e):el(e,null,1,"")}}),(!(ef||em)||"cart"===C)&&(0,t.jsx)(l.default,{items:q,onUpdateQuantity:(e,t)=>{t<=0?ed(e):L(a=>a.map(a=>a.id===e?{...a,quantity:t,lineTotal:a.unitPrice*t}:a))},onRemoveItem:ed,onUpdateNote:(e,t)=>{L(a=>a.map(a=>a.id===e?{...a,note:t||void 0}:a))},onClearCart:()=>H(!0)}),(!(ef||em)||"payment"===C)&&(0,t.jsx)(d.default,{items:q,tables:_,rooms:R,onPlaceOrder:ec,onPayNow:ep,loading:P})]}),W&&(0,t.jsx)(c.default,{product:W,onClose:()=>B(null),onAddToCart:el}),Z&&(0,t.jsx)(p.default,{...Z,onClose:()=>G(null)}),U&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{onClick:()=>H(!1),style:{position:"fixed",inset:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:100},className:"jsx-377925501a464ba5"}),(0,t.jsxs)("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"360px",backgroundColor:"#ffffff",borderRadius:"20px",padding:"24px",zIndex:101,textAlign:"center"},className:"jsx-377925501a464ba5",children:[(0,t.jsx)("div",{style:{width:"56px",height:"56px",borderRadius:"50%",backgroundColor:"#fef3c7",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 16px"},className:"jsx-377925501a464ba5",children:(0,t.jsx)(y.AlertCircle,{style:{width:"28px",height:"28px",color:"#f59e0b"}})}),(0,t.jsx)("h3",{style:{fontSize:"18px",fontWeight:700,color:"#0f172a",marginBottom:"8px"},className:"jsx-377925501a464ba5",children:"مسح السلة؟"}),(0,t.jsx)("p",{style:{fontSize:"14px",color:"#64748b",marginBottom:"24px"},className:"jsx-377925501a464ba5",children:"سيتم حذف جميع العناصر من السلة. هل أنت متأكد؟"}),(0,t.jsxs)("div",{style:{display:"flex",gap:"12px"},className:"jsx-377925501a464ba5",children:[(0,t.jsx)("button",{onClick:()=>{L([]),H(!1),en("تم مسح السلة","success")},style:{flex:1,padding:"12px",backgroundColor:"#dc2626",border:"none",borderRadius:"12px",fontSize:"14px",fontWeight:600,color:"#ffffff",cursor:"pointer"},className:"jsx-377925501a464ba5",children:"نعم، امسح"}),(0,t.jsx)("button",{onClick:()=>H(!1),style:{flex:1,padding:"12px",backgroundColor:"#f1f5f9",border:"none",borderRadius:"12px",fontSize:"14px",fontWeight:600,color:"#475569",cursor:"pointer"},className:"jsx-377925501a464ba5",children:"إلغاء"})]})]})]}),ee&&(0,t.jsx)(j,{order:ee,onClose:()=>et(null),onPay:eu,processing:P}),K&&e&&(0,t.jsx)(u.default,{onClose:()=>X(!1),onSuccess:()=>{en("تم إغلاق اليوم بنجاح","success"),eo()},userId:e.id,userName:e.name}),Q&&(0,t.jsxs)("div",{style:{position:"fixed",bottom:"24px",left:"50%",transform:"translateX(-50%)",display:"flex",alignItems:"center",gap:"10px",padding:"14px 24px",backgroundColor:"success"===Q.type?"#16a34a":"#dc2626",borderRadius:"12px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",zIndex:200,animation:"slideUp 0.3s ease-out"},className:"jsx-377925501a464ba5",children:["success"===Q.type?(0,t.jsx)(g.CheckCircle,{style:{width:"20px",height:"20px",color:"#ffffff"}}):(0,t.jsx)(y.AlertCircle,{style:{width:"20px",height:"20px",color:"#ffffff"}}),(0,t.jsx)("span",{style:{fontSize:"14px",fontWeight:600,color:"#ffffff"},className:"jsx-377925501a464ba5",children:Q.message})]}),(0,t.jsx)(a.default,{id:"377925501a464ba5",children:"@keyframes spin{to{transform:rotate(360deg)}}@keyframes slideUp{0%{opacity:0;transform:translate(-50%)translateY(20px)}to{opacity:1;transform:translate(-50%)translateY(0)}}"})]})}function j({order:e,onClose:a,onPay:s,processing:i}){let[o,n]=(0,r.useState)("cash"),[l,d]=(0,r.useState)(""),c="card"===o||parseFloat(l)>=e.total,p="cash"===o&&parseFloat(l)>e.total?parseFloat(l)-e.total:0;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{onClick:a,style:{position:"fixed",inset:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:100}}),(0,t.jsxs)("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"480px",maxWidth:"95vw",maxHeight:"90vh",backgroundColor:"#ffffff",borderRadius:"20px",zIndex:101,overflow:"hidden",display:"flex",flexDirection:"column"},children:[(0,t.jsx)("div",{style:{padding:"20px 24px",borderBottom:"1px solid #e2e8f0",backgroundColor:"#f8fafc"},children:(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h3",{style:{fontSize:"18px",fontWeight:700,color:"#0f172a",margin:0},children:["دفع الطلب #",e.id.slice(-6).toUpperCase()]}),(0,t.jsxs)("p",{style:{fontSize:"13px",color:"#64748b",margin:"4px 0 0 0"},children:["staff-menu"===e.source?"طلب من منيو الموظفين":"طلب من الكاشير",e.tableNumber&&` • طاولة ${e.tableNumber}`,e.roomNumber&&` • غرفة ${e.roomNumber}`]})]}),(0,t.jsx)("button",{onClick:a,style:{width:"36px",height:"36px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#ffffff",border:"1px solid #e2e8f0",borderRadius:"10px",cursor:"pointer",color:"#64748b"},children:(0,t.jsx)(x.X,{style:{width:"18px",height:"18px"}})})]})}),(0,t.jsxs)("div",{style:{flex:1,overflowY:"auto",padding:"20px 24px"},children:[(0,t.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,t.jsxs)("h4",{style:{fontSize:"13px",fontWeight:600,color:"#94a3b8",marginBottom:"12px"},children:["العناصر (",e.items?.length||0,")"]}),(0,t.jsxs)("div",{style:{backgroundColor:"#f8fafc",borderRadius:"12px",overflow:"hidden"},children:[e.items?.map((a,r)=>(0,t.jsxs)("div",{style:{padding:"12px 16px",borderBottom:r<(e.items?.length||0)-1?"1px solid #e2e8f0":"none",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("span",{style:{fontSize:"14px",fontWeight:500,color:"#0f172a"},children:[a.emoji&&(0,t.jsx)("span",{style:{marginLeft:"6px"},children:a.emoji}),a.name]}),(0,t.jsxs)("p",{style:{fontSize:"12px",color:"#64748b",margin:"2px 0 0 0"},children:[a.quantity," × ",(a.price||0).toFixed(3)," ر.ع"]})]}),(0,t.jsxs)("span",{style:{fontSize:"14px",fontWeight:600,color:"#0f172a"},children:[(a.itemTotal||a.price*a.quantity).toFixed(3)," ر.ع"]})]},r)),(0,t.jsxs)("div",{style:{padding:"14px 16px",backgroundColor:"#f1f5f9",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,t.jsx)("span",{style:{fontSize:"15px",fontWeight:700,color:"#0f172a"},children:"الإجمالي"}),(0,t.jsxs)("span",{style:{fontSize:"20px",fontWeight:700,color:"#16a34a"},children:[e.total.toFixed(3)," ر.ع"]})]})]})]}),(0,t.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,t.jsx)("h4",{style:{fontSize:"13px",fontWeight:600,color:"#94a3b8",marginBottom:"10px"},children:"طريقة الدفع"}),(0,t.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,t.jsx)("button",{onClick:()=>n("cash"),style:{flex:1,padding:"14px",backgroundColor:"cash"===o?"#16a34a":"#f8fafc",border:`2px solid ${"cash"===o?"#16a34a":"#e2e8f0"}`,borderRadius:"12px",fontSize:"14px",fontWeight:600,color:"cash"===o?"#ffffff":"#475569",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:"💵 نقدي"}),(0,t.jsx)("button",{onClick:()=>n("card"),style:{flex:1,padding:"14px",backgroundColor:"card"===o?"#6366f1":"#f8fafc",border:`2px solid ${"card"===o?"#6366f1":"#e2e8f0"}`,borderRadius:"12px",fontSize:"14px",fontWeight:600,color:"card"===o?"#ffffff":"#475569",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:"💳 بطاقة"})]})]}),"cash"===o&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{style:{fontSize:"13px",fontWeight:600,color:"#94a3b8",marginBottom:"10px"},children:"المبلغ المستلم"}),(0,t.jsx)("input",{type:"number",value:l,onChange:e=>d(e.target.value),placeholder:`الحد الأدنى: ${e.total.toFixed(3)} ر.ع`,style:{width:"100%",padding:"14px 16px",fontSize:"18px",fontWeight:600,textAlign:"center",border:"2px solid #e2e8f0",borderRadius:"12px",outline:"none",marginBottom:"12px"}}),(0,t.jsxs)("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[[1,2,5,10,20,50].map(e=>(0,t.jsxs)("button",{onClick:()=>d(e.toString()),style:{padding:"8px 16px",backgroundColor:"#f1f5f9",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"13px",fontWeight:600,color:"#475569",cursor:"pointer"},children:[e," ر.ع"]},e)),(0,t.jsx)("button",{onClick:()=>d(e.total.toString()),style:{padding:"8px 16px",backgroundColor:"#dcfce7",border:"1px solid #16a34a",borderRadius:"8px",fontSize:"13px",fontWeight:600,color:"#16a34a",cursor:"pointer"},children:"المبلغ الكامل"})]}),p>0&&(0,t.jsxs)("div",{style:{marginTop:"16px",padding:"12px 16px",backgroundColor:"#fef3c7",borderRadius:"10px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,t.jsx)("span",{style:{fontSize:"14px",fontWeight:600,color:"#92400e"},children:"الباقي"}),(0,t.jsxs)("span",{style:{fontSize:"18px",fontWeight:700,color:"#f59e0b"},children:[p.toFixed(3)," ر.ع"]})]})]})]}),(0,t.jsx)("div",{style:{padding:"16px 24px",borderTop:"1px solid #e2e8f0",backgroundColor:"#f8fafc"},children:(0,t.jsx)("button",{onClick:()=>s(e,o,parseFloat(l)||e.total),disabled:!c||i,style:{width:"100%",padding:"16px",background:c&&!i?"linear-gradient(135deg, #16a34a 0%, #15803d 100%)":"#e2e8f0",border:"none",borderRadius:"14px",fontSize:"16px",fontWeight:700,color:c&&!i?"#ffffff":"#94a3b8",cursor:c&&!i?"pointer":"not-allowed"},children:i?"جاري الدفع...":`دفع ${e.total.toFixed(3)} ر.ع`})})]})]})}e.s(["default",()=>w])}]);