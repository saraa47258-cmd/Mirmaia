(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,61911,e=>{"use strict";let t=(0,e.i(75254).default)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);e.s(["Users",()=>t],61911)},88844,e=>{"use strict";let t=(0,e.i(75254).default)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);e.s(["Package",()=>t],88844)},1928,e=>{"use strict";let t=(0,e.i(75254).default)("shopping-cart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);e.s(["ShoppingCart",()=>t],1928)},75254,e=>{"use strict";var t=e.i(71645);let r=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},a=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim();var s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,t.forwardRef)(({color:e="currentColor",size:r=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:n="",children:l,iconNode:d,...c},p)=>(0,t.createElement)("svg",{ref:p,...s,width:r,height:r,stroke:e,strokeWidth:o?24*Number(i)/Number(r):i,className:a("lucide",n),...!l&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(c)&&{"aria-hidden":"true"},...c},[...d.map(([e,r])=>(0,t.createElement)(e,r)),...Array.isArray(l)?l:[l]])),o=(e,s)=>{let o=(0,t.forwardRef)(({className:o,...n},l)=>(0,t.createElement)(i,{ref:l,iconNode:s,className:a(`lucide-${r(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,o),...n}));return o.displayName=r(e),o};e.s(["default",()=>o],75254)},16015,(e,t,r)=>{},98547,(e,t,r)=>{var a=e.i(47167);e.r(16015);var s=e.r(71645),i=s&&"object"==typeof s&&"default"in s?s:{default:s},o=void 0!==a.default&&a.default.env&&!0,n=function(e){return"[object String]"===Object.prototype.toString.call(e)},l=function(){function e(e){var t=void 0===e?{}:e,r=t.name,a=void 0===r?"stylesheet":r,s=t.optimizeForSpeed,i=void 0===s?o:s;d(n(a),"`name` must be a string"),this._name=a,this._deletedRulePlaceholder="#"+a+"-deleted-rule____{}",d("boolean"==typeof i,"`optimizeForSpeed` must be a boolean"),this._optimizeForSpeed=i,this._serverSheet=void 0,this._tags=[],this._injected=!1,this._rulesCount=0;var l="u">typeof window&&document.querySelector('meta[property="csp-nonce"]');this._nonce=l?l.getAttribute("content"):null}var t,r=e.prototype;return r.setOptimizeForSpeed=function(e){d("boolean"==typeof e,"`setOptimizeForSpeed` accepts a boolean"),d(0===this._rulesCount,"optimizeForSpeed cannot be when rules have already been inserted"),this.flush(),this._optimizeForSpeed=e,this.inject()},r.isOptimizeForSpeed=function(){return this._optimizeForSpeed},r.inject=function(){var e=this;if(d(!this._injected,"sheet already injected"),this._injected=!0,"u">typeof window&&this._optimizeForSpeed){this._tags[0]=this.makeStyleTag(this._name),this._optimizeForSpeed="insertRule"in this.getSheet(),this._optimizeForSpeed||(o||console.warn("StyleSheet: optimizeForSpeed mode not supported falling back to standard mode."),this.flush(),this._injected=!0);return}this._serverSheet={cssRules:[],insertRule:function(t,r){return"number"==typeof r?e._serverSheet.cssRules[r]={cssText:t}:e._serverSheet.cssRules.push({cssText:t}),r},deleteRule:function(t){e._serverSheet.cssRules[t]=null}}},r.getSheetForTag=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]},r.getSheet=function(){return this.getSheetForTag(this._tags[this._tags.length-1])},r.insertRule=function(e,t){if(d(n(e),"`insertRule` accepts only strings"),"u"<typeof window)return"number"!=typeof t&&(t=this._serverSheet.cssRules.length),this._serverSheet.insertRule(e,t),this._rulesCount++;if(this._optimizeForSpeed){var r=this.getSheet();"number"!=typeof t&&(t=r.cssRules.length);try{r.insertRule(e,t)}catch(t){return o||console.warn("StyleSheet: illegal rule: \n\n"+e+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),-1}}else{var a=this._tags[t];this._tags.push(this.makeStyleTag(this._name,e,a))}return this._rulesCount++},r.replaceRule=function(e,t){if(this._optimizeForSpeed||"u"<typeof window){var r="u">typeof window?this.getSheet():this._serverSheet;if(t.trim()||(t=this._deletedRulePlaceholder),!r.cssRules[e])return e;r.deleteRule(e);try{r.insertRule(t,e)}catch(a){o||console.warn("StyleSheet: illegal rule: \n\n"+t+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),r.insertRule(this._deletedRulePlaceholder,e)}}else{var a=this._tags[e];d(a,"old rule at index `"+e+"` not found"),a.textContent=t}return e},r.deleteRule=function(e){if("u"<typeof window)return void this._serverSheet.deleteRule(e);if(this._optimizeForSpeed)this.replaceRule(e,"");else{var t=this._tags[e];d(t,"rule at index `"+e+"` not found"),t.parentNode.removeChild(t),this._tags[e]=null}},r.flush=function(){this._injected=!1,this._rulesCount=0,"u">typeof window?(this._tags.forEach(function(e){return e&&e.parentNode.removeChild(e)}),this._tags=[]):this._serverSheet.cssRules=[]},r.cssRules=function(){var e=this;return"u"<typeof window?this._serverSheet.cssRules:this._tags.reduce(function(t,r){return r?t=t.concat(Array.prototype.map.call(e.getSheetForTag(r).cssRules,function(t){return t.cssText===e._deletedRulePlaceholder?null:t})):t.push(null),t},[])},r.makeStyleTag=function(e,t,r){t&&d(n(t),"makeStyleTag accepts only strings as second parameter");var a=document.createElement("style");this._nonce&&a.setAttribute("nonce",this._nonce),a.type="text/css",a.setAttribute("data-"+e,""),t&&a.appendChild(document.createTextNode(t));var s=document.head||document.getElementsByTagName("head")[0];return r?s.insertBefore(a,r):s.appendChild(a),a},t=[{key:"length",get:function(){return this._rulesCount}}],function(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}(e.prototype,t),e}();function d(e,t){if(!e)throw Error("StyleSheet: "+t+".")}var c=function(e){for(var t=5381,r=e.length;r;)t=33*t^e.charCodeAt(--r);return t>>>0},p={};function u(e,t){if(!t)return"jsx-"+e;var r=String(t),a=e+r;return p[a]||(p[a]="jsx-"+c(e+"-"+r)),p[a]}function f(e,t){"u"<typeof window&&(t=t.replace(/\/style/gi,"\\/style"));var r=e+t;return p[r]||(p[r]=t.replace(/__jsx-style-dynamic-selector/g,e)),p[r]}var m=function(){function e(e){var t=void 0===e?{}:e,r=t.styleSheet,a=void 0===r?null:r,s=t.optimizeForSpeed,i=void 0!==s&&s;this._sheet=a||new l({name:"styled-jsx",optimizeForSpeed:i}),this._sheet.inject(),a&&"boolean"==typeof i&&(this._sheet.setOptimizeForSpeed(i),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer=void 0,this._indices={},this._instancesCounts={}}var t=e.prototype;return t.add=function(e){var t=this;void 0===this._optimizeForSpeed&&(this._optimizeForSpeed=Array.isArray(e.children),this._sheet.setOptimizeForSpeed(this._optimizeForSpeed),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),"u">typeof window&&!this._fromServer&&(this._fromServer=this.selectFromServer(),this._instancesCounts=Object.keys(this._fromServer).reduce(function(e,t){return e[t]=0,e},{}));var r=this.getIdAndRules(e),a=r.styleId,s=r.rules;if(a in this._instancesCounts){this._instancesCounts[a]+=1;return}var i=s.map(function(e){return t._sheet.insertRule(e)}).filter(function(e){return -1!==e});this._indices[a]=i,this._instancesCounts[a]=1},t.remove=function(e){var t=this,r=this.getIdAndRules(e).styleId;if(function(e,t){if(!e)throw Error("StyleSheetRegistry: "+t+".")}(r in this._instancesCounts,"styleId: `"+r+"` not found"),this._instancesCounts[r]-=1,this._instancesCounts[r]<1){var a=this._fromServer&&this._fromServer[r];a?(a.parentNode.removeChild(a),delete this._fromServer[r]):(this._indices[r].forEach(function(e){return t._sheet.deleteRule(e)}),delete this._indices[r]),delete this._instancesCounts[r]}},t.update=function(e,t){this.add(t),this.remove(e)},t.flush=function(){this._sheet.flush(),this._sheet.inject(),this._fromServer=void 0,this._indices={},this._instancesCounts={}},t.cssRules=function(){var e=this,t=this._fromServer?Object.keys(this._fromServer).map(function(t){return[t,e._fromServer[t]]}):[],r=this._sheet.cssRules();return t.concat(Object.keys(this._indices).map(function(t){return[t,e._indices[t].map(function(e){return r[e].cssText}).join(e._optimizeForSpeed?"":"\n")]}).filter(function(e){return!!e[1]}))},t.styles=function(e){var t,r;return t=this.cssRules(),void 0===(r=e)&&(r={}),t.map(function(e){var t=e[0],a=e[1];return i.default.createElement("style",{id:"__"+t,key:"__"+t,nonce:r.nonce?r.nonce:void 0,dangerouslySetInnerHTML:{__html:a}})})},t.getIdAndRules=function(e){var t=e.children,r=e.dynamic,a=e.id;if(r){var s=u(a,r);return{styleId:s,rules:Array.isArray(t)?t.map(function(e){return f(s,e)}):[f(s,t)]}}return{styleId:u(a),rules:Array.isArray(t)?t:[t]}},t.selectFromServer=function(){return Array.prototype.slice.call(document.querySelectorAll('[id^="__jsx-"]')).reduce(function(e,t){return e[t.id.slice(2)]=t,e},{})},e}(),h=s.createContext(null);function y(){return new m}function g(){return s.useContext(h)}h.displayName="StyleSheetContext";var x=i.default.useInsertionEffect||i.default.useLayoutEffect,b="u">typeof window?y():void 0;function v(e){var t=b||g();return t&&("u"<typeof window?t.add(e):x(function(){return t.add(e),function(){t.remove(e)}},[e.id,String(e.dynamic)])),null}v.dynamic=function(e){return e.map(function(e){return u(e[0],e[1])}).join(" ")},r.StyleRegistry=function(e){var t=e.registry,r=e.children,a=s.useContext(h),o=s.useState(function(){return a||t||y()})[0];return i.default.createElement(h.Provider,{value:o},r)},r.createStyleRegistry=y,r.style=v,r.useStyleRegistry=g},37902,(e,t,r)=>{t.exports=e.r(98547).style},69638,e=>{"use strict";let t=(0,e.i(75254).default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircle",()=>t],69638)},7233,e=>{"use strict";let t=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],7233)},27612,e=>{"use strict";let t=(0,e.i(75254).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>t],27612)},43531,e=>{"use strict";let t=(0,e.i(75254).default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["Check",()=>t],43531)},99023,e=>{"use strict";let t=(0,e.i(75254).default)("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);e.s(["Minus",()=>t],99023)},3281,e=>{"use strict";let t=(0,e.i(75254).default)("printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);e.s(["Printer",()=>t],3281)},61659,e=>{"use strict";let t=(0,e.i(75254).default)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);e.s(["CreditCard",()=>t],61659)},3116,e=>{"use strict";let t=(0,e.i(75254).default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);e.s(["Clock",()=>t],3116)},16715,e=>{"use strict";let t=(0,e.i(75254).default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["RefreshCw",()=>t],16715)},63209,e=>{"use strict";let t=(0,e.i(75254).default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>t],63209)},84614,e=>{"use strict";let t=(0,e.i(75254).default)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);e.s(["User",()=>t],84614)},87378,e=>{"use strict";let t=(0,e.i(75254).default)("banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]);e.s(["Banknote",()=>t],87378)},84103,e=>{"use strict";var t=e.i(33842);e.i(1465);var r=e.i(34991);let a=e=>`restaurant-system/${e}/${t.RESTAURANT_ID}`,s=async e=>{let s=Object.entries((await (0,r.get)((0,r.ref)(t.database,a("orders")))).val()||{}).map(([e,t])=>({id:e,...t}));return s.sort((e,t)=>{let r=e.timestamp||new Date(e.createdAt).getTime();return(t.timestamp||new Date(t.createdAt).getTime())-r}),e&&e>0&&(s=s.slice(0,e)),s},i=async(e,s)=>{let i=(await (0,r.get)((0,r.ref)(t.database,a("orders")))).val()||{},o=e.start.getTime(),n=e.end.getTime(),l=Object.entries(i).map(([e,t])=>({id:e,...t})).filter(e=>{let t=e.timestamp||new Date(e.createdAt).getTime();return t>=o&&t<=n}).sort((e,t)=>{let r=e.timestamp||new Date(e.createdAt).getTime();return(t.timestamp||new Date(t.createdAt).getTime())-r});return s&&s>0&&(l=l.slice(0,s)),l},o=async e=>{let s=await (0,r.get)((0,r.ref)(t.database,`${a("orders")}/${e}`));return s.exists()?{id:e,...s.val()}:null},n=async(e,s)=>{await (0,r.update)((0,r.ref)(t.database,`${a("orders")}/${e}`),{status:s,updatedAt:new Date().toISOString()})},l=async e=>{let s=(0,r.push)((0,r.ref)(t.database,a("orders"))),i=e.items.map(e=>{let t={id:e.id,name:e.name,price:e.price||0,quantity:e.quantity,itemTotal:e.itemTotal||e.price*e.quantity};return e.emoji&&(t.emoji=e.emoji),e.note&&(t.note=e.note),t}),o={items:i,total:e.total||0,status:e.status||"pending",restaurantId:t.RESTAURANT_ID,createdAt:new Date().toISOString(),timestamp:Date.now(),itemsCount:i.reduce((e,t)=>e+t.quantity,0)};void 0!==e.subtotal&&(o.subtotal=e.subtotal),e.discount&&(o.discount=e.discount),e.paymentMethod&&(o.paymentMethod=e.paymentMethod),e.paymentStatus&&(o.paymentStatus=e.paymentStatus),e.customerName&&(o.customerName=e.customerName),e.tableNumber&&(o.tableNumber=e.tableNumber),e.tableId&&(o.tableId=e.tableId),e.roomId&&(o.roomId=e.roomId),e.roomNumber&&(o.roomNumber=e.roomNumber),e.orderType&&(o.orderType=e.orderType),e.workerId&&(o.workerId=e.workerId),e.workerName&&(o.workerName=e.workerName),e.source&&(o.source=e.source);let n=null;if(e.tableNumber&&!e.tableId){let t=await N(e.tableNumber);t&&(n=t.id,o.tableId=t.id,o.orderType="table")}else e.tableId&&(n=e.tableId);await (0,r.set)(s,o);let l=s.key;if(n)try{await A(n,"occupied",l)}catch(e){console.error("Failed to update table status:",e)}return l},d=async()=>Object.entries((await (0,r.get)((0,r.ref)(t.database,a("menu")))).val()||{}).map(([e,t])=>{let r={id:e,...t,price:"string"==typeof t.price?parseFloat(t.price)||0:t.price||0,basePrice:t.basePrice?"string"==typeof t.basePrice?parseFloat(t.basePrice):t.basePrice:void 0};if(r.variations&&Array.isArray(r.variations)&&(r.variations=r.variations.map(e=>({...e,price:"string"==typeof e.price?parseFloat(e.price)||0:e.price||0}))),r.sizes&&"object"==typeof r.sizes){let e={};Object.entries(r.sizes).forEach(([t,r])=>{e[t]={...r,price:"string"==typeof r.price?parseFloat(r.price)||0:r.price||0}}),r.sizes=e}if(r.shishaTypes&&"object"==typeof r.shishaTypes){let e={};Object.entries(r.shishaTypes).forEach(([t,r])=>{e[t]={...r,price:"string"==typeof r.price?parseFloat(r.price)||0:r.price||0}}),r.shishaTypes=e}return r}),c=async e=>{let s=(0,r.push)((0,r.ref)(t.database,a("menu"))),i={};return Object.entries(e).forEach(([e,t])=>{if(void 0!==t)if("price"===e||"basePrice"===e)i[e]="string"==typeof t?parseFloat(t)||0:t||0;else if("variations"===e&&Array.isArray(t))i[e]=t.map(e=>({...e,price:"string"==typeof e.price?parseFloat(e.price)||0:e.price||0}));else if("sizes"===e&&"object"==typeof t){let r={};Object.entries(t).forEach(([e,t])=>{r[e]={...t,price:"string"==typeof t.price?parseFloat(t.price)||0:t.price||0}}),i[e]=r}else if("shishaTypes"===e&&"object"==typeof t){let r={};Object.entries(t).forEach(([e,t])=>{r[e]={...t,price:"string"==typeof t.price?parseFloat(t.price)||0:t.price||0}}),i[e]=r}else i[e]=t}),await (0,r.set)(s,{...i,category:e.categoryId||e.category,categoryId:e.categoryId||e.category,active:e.isActive??e.active??!0,isActive:e.isActive??e.active??!0,createdAt:new Date().toISOString()}),s.key},p=async(e,s)=>{let i={updatedAt:new Date().toISOString()};Object.entries(s).forEach(([e,t])=>{if(void 0!==t)if("price"===e||"basePrice"===e)i[e]="string"==typeof t?parseFloat(t)||0:t||0;else if("variations"===e&&Array.isArray(t))i[e]=t.map(e=>({...e,price:"string"==typeof e.price?parseFloat(e.price)||0:e.price||0}));else if("sizes"===e&&"object"==typeof t){let r={};Object.entries(t).forEach(([e,t])=>{r[e]={...t,price:"string"==typeof t.price?parseFloat(t.price)||0:t.price||0}}),i[e]=r}else if("shishaTypes"===e&&"object"==typeof t){let r={};Object.entries(t).forEach(([e,t])=>{r[e]={...t,price:"string"==typeof t.price?parseFloat(t.price)||0:t.price||0}}),i[e]=r}else i[e]=t}),s.categoryId&&(i.category=s.categoryId),void 0!==s.isActive&&(i.active=s.isActive),await (0,r.update)((0,r.ref)(t.database,`${a("menu")}/${e}`),i)},u=async e=>{await (0,r.remove)((0,r.ref)(t.database,`${a("menu")}/${e}`))},f=async()=>Object.entries((await (0,r.get)((0,r.ref)(t.database,a("categories")))).val()||{}).map(([e,t])=>({id:e,...t})).sort((e,t)=>(e.order||e.sortOrder||0)-(t.order||t.sortOrder||0)),m=async e=>{let s=(0,r.push)((0,r.ref)(t.database,a("categories"))),i={};return Object.entries(e).forEach(([e,t])=>{void 0!==t&&(i[e]=t)}),await (0,r.set)(s,{...i,createdAt:new Date().toISOString()}),s.key},h=async(e,s)=>{let i={};Object.entries(s).forEach(([e,t])=>{void 0!==t&&(i[e]=t)}),await (0,r.update)((0,r.ref)(t.database,`${a("categories")}/${e}`),{...i,updatedAt:new Date().toISOString()})},y=async e=>{await (0,r.remove)((0,r.ref)(t.database,`${a("categories")}/${e}`))},g=async e=>(await d()).filter(t=>t.category===e||t.categoryId===e),x=async e=>(await g(e)).length,b=async(e,s)=>{let i=await g(e),o={};i.forEach(e=>{o[`${a("menu")}/${e.id}/category`]=s,o[`${a("menu")}/${e.id}/categoryId`]=s,o[`${a("menu")}/${e.id}/updatedAt`]=new Date().toISOString()}),Object.keys(o).length>0&&await (0,r.update)((0,r.ref)(t.database),o)},v=async()=>Object.entries((await (0,r.get)((0,r.ref)(t.database,a("workers")))).val()||{}).map(([e,t])=>({id:e,...t})),S=async(e,s)=>{await (0,r.update)((0,r.ref)(t.database,`${a("workers")}/${e}`),{detailedPermissions:s})},w=async()=>{let e=new Date;e.setHours(0,0,0,0);let t=e.getTime();return(await s()).filter(e=>(e.timestamp||(e.createdAt?new Date(e.createdAt).getTime():0))>=t&&"cancelled"!==e.status)},j=async(e,s)=>{let i={paymentStatus:s,updatedAt:new Date().toISOString()};"paid"===s&&(i.paidAt=new Date().toISOString()),await (0,r.update)((0,r.ref)(t.database,`${a("orders")}/${e}`),i)},k=async(e,s)=>{let i=await o(e);if(!i)throw Error("Order not found");let n=[...i.items||[]];for(let e of s){let t=n.findIndex(t=>t.id===e.id&&t.name===e.name);if(t>=0)n[t].quantity+=e.quantity,n[t].itemTotal=n[t].quantity*n[t].price;else{let t={id:e.id,name:e.name,price:e.price||0,quantity:e.quantity,itemTotal:e.quantity*(e.price||0)};e.emoji&&(t.emoji=e.emoji),e.note&&(t.note=e.note),n.push(t)}}let l=n.map(e=>{let t={id:e.id,name:e.name,price:e.price||0,quantity:e.quantity,itemTotal:e.itemTotal||e.quantity*(e.price||0)};return e.emoji&&(t.emoji=e.emoji),e.note&&(t.note=e.note),t}),d=l.reduce((e,t)=>e+(t.itemTotal||t.quantity*t.price),0),c=l.reduce((e,t)=>e+t.quantity,0);await (0,r.update)((0,r.ref)(t.database,`${a("orders")}/${e}`),{items:l,total:d,itemsCount:c,updatedAt:new Date().toISOString()})},C=async(e,t)=>{let r=(await s()).filter(e=>"cancelled"!==e.status);if(e&&t){let a=e.getTime(),s=t.getTime();r=r.filter(e=>{let t=e.timestamp||(e.createdAt?new Date(e.createdAt).getTime():0);return t>=a&&t<=s})}let a=r.filter(e=>"paid"===e.status||"completed"===e.status).reduce((e,t)=>e+(t.total||0),0),i=r.length,o=r.filter(e=>"paid"===e.status||"completed"===e.status).length;return{totalRevenue:a,ordersCount:i,paidOrders:o,itemsSold:r.reduce((e,t)=>e+(t.itemsCount||t.items?.length||0),0),averageOrder:i>0?a/o:0}},O=async()=>Object.entries((await (0,r.get)((0,r.ref)(t.database,a("tables")))).val()||{}).map(([e,t])=>({id:e,...t})),T=async(e,t)=>!(await O()).some(r=>r.tableNumber===e&&r.id!==t),N=async e=>{let t=await O(),r=e.trim().toLowerCase(),a=e=>{let t=e.match(/\d+/);return t?t[0]:e},s=a(r),i=t.find(t=>t.tableNumber===e);return i||(i=t.find(e=>a(e.tableNumber.toLowerCase())===s))?i:(i=t.find(e=>e.tableNumber.toLowerCase().includes(r)||r.includes(e.tableNumber.toLowerCase())))||null},I=async e=>{if(!await T(e.tableNumber))throw Error(`رقم الطاولة "${e.tableNumber}" موجود مسبقاً`);let s={tableNumber:e.tableNumber,area:e.area,status:e.status||"available",activeOrderId:null,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};e.name&&e.name.trim()&&(s.name=e.name.trim());let i=(0,r.push)((0,r.ref)(t.database,a("tables")));return await (0,r.set)(i,s),i.key},_=async(e,s)=>{if(s.tableNumber&&!await T(s.tableNumber,e))throw Error(`رقم الطاولة "${s.tableNumber}" موجود مسبقاً`);let i={updatedAt:new Date().toISOString()};void 0!==s.tableNumber&&(i.tableNumber=s.tableNumber),void 0!==s.area&&(i.area=s.area),void 0!==s.status&&(i.status=s.status),void 0!==s.activeOrderId&&(i.activeOrderId=s.activeOrderId),void 0!==s.reservedBy&&(i.reservedBy=s.reservedBy),void 0!==s.reservedAt&&(i.reservedAt=s.reservedAt),void 0!==s.name&&(s.name&&s.name.trim()?i.name=s.name.trim():i.name=null),await (0,r.update)((0,r.ref)(t.database,`${a("tables")}/${e}`),i)},A=async(e,s,i,o)=>{let n={status:s,updatedAt:new Date().toISOString()};"available"===s?(n.activeOrderId=null,n.reservedBy=null,n.reservedAt=null):"reserved"===s?(n.reservedBy=o||null,n.reservedAt=new Date().toISOString()):"occupied"===s&&i&&(n.activeOrderId=i),await (0,r.update)((0,r.ref)(t.database,`${a("tables")}/${e}`),n)},R=async()=>Object.entries((await (0,r.get)((0,r.ref)(t.database,a("rooms")))).val()||{}).map(([e,t])=>({id:e,...t})).sort((e,t)=>(parseInt(String(e.roomNumber))||0)-(parseInt(String(t.roomNumber))||0)),z=async e=>{let s=(0,r.push)((0,r.ref)(t.database,a("rooms"))),i={roomNumber:e.roomNumber,status:e.status||"available",isActive:e.isActive??!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return e.name&&(i.name=e.name),e.notes&&(i.notes=e.notes),void 0!==e.hourlyRate&&e.hourlyRate>0&&(i.hourlyRate=e.hourlyRate),e.priceType&&(i.priceType=e.priceType),void 0!==e.malePrice&&(i.malePrice=e.malePrice),void 0!==e.femalePrice&&(i.femalePrice=e.femalePrice),await (0,r.set)(s,i),s.key},D=async(e,s)=>{let i={updatedAt:new Date().toISOString()};Object.entries(s).forEach(([e,t])=>{void 0!==t&&(i[e]=t)}),await (0,r.update)((0,r.ref)(t.database,`${a("rooms")}/${e}`),i)},M=async e=>{await (0,r.remove)((0,r.ref)(t.database,`${a("rooms")}/${e}`))},F=async(e,s,i,o)=>{let n={status:s,updatedAt:new Date().toISOString()};"available"===s?(n.activeOrderId=null,n.reservedBy=null,n.reservedAt=null):"reserved"===s?(n.reservedBy=o||null,n.reservedAt=new Date().toISOString()):"occupied"===s&&i&&(n.activeOrderId=i),await (0,r.update)((0,r.ref)(t.database,`${a("rooms")}/${e}`),n)},E=async()=>(await s()).filter(e=>"room"===e.orderType||e.roomId).sort((e,t)=>{let r=e.timestamp||(e.createdAt?new Date(e.createdAt).getTime():0);return(t.timestamp||(t.createdAt?new Date(t.createdAt).getTime():0))-r}),$=async e=>(await E()).filter(t=>{let r=t.timestamp||(t.createdAt?new Date(t.createdAt).getTime():0);return r>=e.start.getTime()&&r<=e.end.getTime()}),P=async(e,t)=>{await n(e,"completed"),await j(e,"paid"),await F(t,"available")};e.s(["addItemsToOrder",0,k,"closeRoomOrder",0,P,"createCategory",0,m,"createOrder",0,l,"createProduct",0,c,"createRoom",0,z,"createTable",0,I,"deleteCategory",0,y,"deleteProduct",0,u,"deleteRoom",0,M,"getCategories",0,f,"getCategoryProductCount",0,x,"getDateRangeForFilter",0,(e,t,r)=>{let a=new Date,s=new Date(a);s.setHours(23,59,59,999);let i=new Date(a);switch(i.setHours(0,0,0,0),e){case"today":break;case"week":i.setDate(i.getDate()-7);break;case"month":i.setMonth(i.getMonth()-1);break;case"year":i.setFullYear(i.getFullYear()-1);break;case"custom":t&&(i=new Date(t)),r&&(s.setTime(new Date(r).getTime()),s.setHours(23,59,59,999))}return{start:i,end:s}},"getDefaultWorkerPermissions",0,()=>({modules:{staffMenu:!0,orders:!1,tables:!1,rooms:!1,cashier:!1,inventory:!1,reports:!1,products:!1},actions:{createOrder:!0,editOrder:!1,cancelOrder:!1,processPayment:!1,applyDiscount:!1,viewFinancials:!1,manageProducts:!1,manageTables:!1,manageRooms:!1,dailyClosing:!1}}),"getFullPermissions",0,()=>({modules:{staffMenu:!0,orders:!0,tables:!0,rooms:!0,cashier:!0,inventory:!0,reports:!0,products:!0},actions:{createOrder:!0,editOrder:!0,cancelOrder:!0,processPayment:!0,applyDiscount:!0,viewFinancials:!0,manageProducts:!0,manageTables:!0,manageRooms:!0,dailyClosing:!0}}),"getOrder",0,o,"getOrders",0,s,"getOrdersByDateRange",0,i,"getProducts",0,d,"getRoomOrdersByDateRange",0,$,"getRooms",0,R,"getSalesStats",0,C,"getTables",0,O,"getTodayOrders",0,w,"getWorkers",0,v,"listenToOrders",0,e=>{let s=(0,r.ref)(t.database,a("orders")),i=(0,r.onValue)(s,t=>{e(Object.entries(t.val()||{}).map(([e,t])=>({id:e,...t})))});return()=>(0,r.off)(s,"value",i)},"listenToRooms",0,e=>{let s=(0,r.ref)(t.database,a("rooms")),i=(0,r.onValue)(s,t=>{e(Object.entries(t.val()||{}).map(([e,t])=>({id:e,...t})).sort((e,t)=>(parseInt(String(e.roomNumber))||0)-(parseInt(String(t.roomNumber))||0)))});return()=>(0,r.off)(s,"value",i)},"listenToTables",0,e=>{let s=(0,r.ref)(t.database,a("tables")),i=(0,r.onValue)(s,t=>{e(Object.entries(t.val()||{}).map(([e,t])=>({id:e,...t})))});return()=>(0,r.off)(s,"value",i)},"moveProductsToCategory",0,b,"setRoomStatus",0,F,"setTableStatus",0,A,"updateCategory",0,h,"updateOrderPaymentStatus",0,j,"updateOrderStatus",0,n,"updateProduct",0,p,"updateRoom",0,D,"updateTable",0,_,"updateWorkerPermissions",0,S])},37727,e=>{"use strict";let t=(0,e.i(75254).default)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);e.s(["X",()=>t],37727)},55436,e=>{"use strict";let t=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>t],55436)},96139,e=>{"use strict";let t=(0,e.i(75254).default)("coffee",[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]]);e.s(["Coffee",()=>t],96139)},75787,e=>{"use strict";let t=(0,e.i(75254).default)("door-open",[["path",{d:"M11 20H2",key:"nlcfvz"}],["path",{d:"M11 4.562v16.157a1 1 0 0 0 1.242.97L19 20V5.562a2 2 0 0 0-1.515-1.94l-4-1A2 2 0 0 0 11 4.561z",key:"au4z13"}],["path",{d:"M11 4H8a2 2 0 0 0-2 2v14",key:"74r1mk"}],["path",{d:"M14 12h.01",key:"1jfl7z"}],["path",{d:"M22 20h-3",key:"vhrsz"}]]);e.s(["DoorOpen",()=>t],75787)},50627,e=>{"use strict";let t=(0,e.i(75254).default)("receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);e.s(["Receipt",()=>t],50627)},43432,e=>{"use strict";let t=(0,e.i(75254).default)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]]);e.s(["Phone",()=>t],43432)},92930,e=>{"use strict";let t=(0,e.i(75254).default)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);e.s(["Edit2",()=>t],92930)},87316,e=>{"use strict";let t=(0,e.i(75254).default)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);e.s(["Calendar",()=>t],87316)},25652,e=>{"use strict";let t=(0,e.i(75254).default)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);e.s(["TrendingUp",()=>t],25652)},78583,e=>{"use strict";let t=(0,e.i(75254).default)("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);e.s(["FileText",()=>t],78583)},70756,e=>{"use strict";let t=(0,e.i(75254).default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);e.s(["Lock",()=>t],70756)},50965,e=>{"use strict";let t=(0,e.i(75254).default)("shopping-bag",[["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}],["path",{d:"M3.103 6.034h17.794",key:"awc11p"}],["path",{d:"M3.4 5.467a2 2 0 0 0-.4 1.2V20a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6.667a2 2 0 0 0-.4-1.2l-2-2.667A2 2 0 0 0 17 2H7a2 2 0 0 0-1.6.8z",key:"o988cm"}]]);e.s(["ShoppingBag",()=>t],50965)},1404,e=>{"use strict";var t=e.i(33842);e.i(1465);var r=e.i(34991);let a=e=>`restaurant-system/${e}/${t.RESTAURANT_ID}`,s=async(e,s,i)=>{let o=(await (0,r.get)((0,r.ref)(t.database,a("orders")))).val()||{},n=e.getTime(),l=s.getTime(),d=Object.entries(o).map(([e,t])=>({id:e,...t})).filter(e=>{let t=e.timestamp||new Date(e.createdAt).getTime();return t>=n&&t<=l});return i?.paymentMethod&&(d=d.filter(e=>e.paymentMethod===i.paymentMethod)),i?.orderType&&(d=d.filter(e=>e.orderType===i.orderType)),i?.status&&(d=d.filter(e=>e.status===i.status)),d.sort((e,t)=>{let r=e.timestamp||new Date(e.createdAt).getTime();return(t.timestamp||new Date(t.createdAt).getTime())-r})},i=async(e,t)=>{let r=await s(e,t),a=new Map;r.filter(e=>"cancelled"!==e.status).forEach(e=>{let t=new Date(e.createdAt).toISOString().split("T")[0],r=a.get(t)||{totalSales:0,totalOrders:0,cashSales:0,cardSales:0};r.totalSales+=e.total||0,r.totalOrders+=1,"cash"===e.paymentMethod?r.cashSales+=e.total||0:"card"===e.paymentMethod&&(r.cardSales+=e.total||0),a.set(t,r)});let i=[],o=new Date(e);for(;o<=t;){let e=o.toISOString().split("T")[0],t=a.get(e)||{totalSales:0,totalOrders:0,cashSales:0,cardSales:0};i.push({date:e,...t,averageOrder:t.totalOrders>0?t.totalSales/t.totalOrders:0}),o.setDate(o.getDate()+1)}return i},o=async(e,t)=>{let r=await i(e,t),a=new Map;return r.forEach(e=>{let t=new Date(new Date(e.date));t.setDate(t.getDate()-t.getDay());let r=t.toISOString().split("T")[0],s=a.get(r)||{date:r,totalSales:0,totalOrders:0,cashSales:0,cardSales:0,averageOrder:0};s.totalSales+=e.totalSales,s.totalOrders+=e.totalOrders,s.cashSales+=e.cashSales,s.cardSales+=e.cardSales,a.set(r,s)}),Array.from(a.entries()).map(([e,t])=>({week:e,stats:{...t,averageOrder:t.totalOrders>0?t.totalSales/t.totalOrders:0}})).sort((e,t)=>e.week.localeCompare(t.week))},n=async(e,t)=>{let r=await i(e,t),a=new Map;return r.forEach(e=>{let t=e.date.substring(0,7),r=a.get(t)||{date:t,totalSales:0,totalOrders:0,cashSales:0,cardSales:0,averageOrder:0};r.totalSales+=e.totalSales,r.totalOrders+=e.totalOrders,r.cashSales+=e.cashSales,r.cardSales+=e.cardSales,a.set(t,r)}),Array.from(a.entries()).map(([e,t])=>({month:e,stats:{...t,averageOrder:t.totalOrders>0?t.totalSales/t.totalOrders:0}})).sort((e,t)=>e.month.localeCompare(t.month))},l=async(e,i,o=10)=>{let n=await s(e,i),l=new Map;try{let e=(await (0,r.get)((0,r.ref)(t.database,a("menu")))).val()||{};Object.entries(e).forEach(([e,t])=>{l.set(e,{nameEn:t.nameEn})})}catch(e){console.error("Error fetching products for English names:",e)}let d=new Map;return n.filter(e=>"cancelled"!==e.status).forEach(e=>{e.items?.forEach(e=>{let t=d.get(e.id)||{id:e.id,name:e.name,nameEn:l.get(e.id)?.nameEn,emoji:e.emoji,quantity:0,revenue:0};t.quantity+=e.quantity,t.revenue+=e.itemTotal||e.price*e.quantity,d.set(e.id,t)})}),Array.from(d.values()).sort((e,t)=>t.revenue-e.revenue).slice(0,o)},d=async(e=30)=>Object.entries((await (0,r.get)((0,r.ref)(t.database,a("daily_closings")))).val()||{}).map(([e,t])=>({id:e,...t})).sort((e,t)=>t.timestamp-e.timestamp).slice(0,e),c=async e=>(await d(100)).find(t=>t.date===e)||null,p=async e=>{if(await c(e.date))throw Error("تم إغلاق هذا اليوم مسبقاً");let s=(0,r.push)((0,r.ref)(t.database,a("daily_closings"))),i={id:s.key,date:e.date,openingCash:e.openingCash,cashSales:e.cashSales,cardSales:e.cardSales,totalSales:e.totalSales,expenses:e.expenses,actualCash:e.actualCash,difference:e.difference,closedBy:e.closedBy,closedAt:new Date().toISOString(),timestamp:Date.now()};return e.notes&&(i.notes=e.notes),e.closedByName&&(i.closedByName=e.closedByName),await (0,r.set)(s,i),i.id},u=async(e,t)=>{let r=t.getTime()-e.getTime(),a=new Date(e.getTime()-r),i=new Date(e.getTime()-1),o=await s(e,t),n=await s(a,i),l=o.filter(e=>"cancelled"!==e.status).reduce((e,t)=>e+(t.total||0),0),d=n.filter(e=>"cancelled"!==e.status).reduce((e,t)=>e+(t.total||0),0);return{current:l,previous:d,percentChange:d>0?(l-d)/d*100:100*(l>0)}},f=async e=>{let t=new Date(e+"T00:00:00.000Z"),r=new Date(e+"T23:59:59.999Z"),a=new Date(e);a.setHours(0,0,0,0);let i=new Date(e);i.setHours(23,59,59,999),console.log("getTodaySalesForClosing - Date range:",{date:e,startUTC:t.toISOString(),endUTC:r.toISOString(),startLocal:a.toISOString(),endLocal:i.toISOString()});let o=await s(a,i);console.log("getTodaySalesForClosing - Found orders:",o.length);let n=o.filter(e=>"cancelled"!==e.status);console.log("getTodaySalesForClosing - Non-cancelled orders:",n.length);let l=n.filter(e=>"completed"===e.status||"paid"===e.status||"paid"===e.paymentStatus);console.log("getTodaySalesForClosing - Paid orders:",l.length,l.map(e=>({id:e.id,status:e.status,paymentStatus:e.paymentStatus,paymentMethod:e.paymentMethod,total:e.total})));let d=l.filter(e=>"cash"===e.paymentMethod&&e.total&&e.total>0).reduce((e,t)=>e+(Number(t.total)||0),0),c=l.filter(e=>"card"===e.paymentMethod&&e.total&&e.total>0).reduce((e,t)=>e+(Number(t.total)||0),0),p=l.filter(e=>!e.paymentMethod&&e.total&&e.total>0).reduce((e,t)=>e+(Number(t.total)||0),0),u=l.length,f=n.filter(e=>"paid"!==e.status&&"completed"!==e.status&&"paid"!==e.paymentStatus).length,m=n.filter(e=>"table"===e.orderType).length,h=n.filter(e=>"room"===e.orderType).length,y=n.filter(e=>"takeaway"===e.orderType||!e.orderType).length,g=d+p;return{cashSales:g,cardSales:c,totalSales:g+c,ordersCount:n.length,paidOrdersCount:u,unpaidOrdersCount:f,tableOrdersCount:m,roomOrdersCount:h,takeawayOrdersCount:y,orders:n}},m=async e=>null!==await c(e),h=async e=>{if(await c(e.date))throw Error("تم إغلاق هذا اليوم مسبقاً");let s=(0,r.push)((0,r.ref)(t.database,a("daily_closings"))),i={id:s.key,date:e.date,openingCash:e.openingCash,cashSales:e.cashSales,cardSales:e.cardSales,totalSales:e.totalSales,expenses:e.expenses,actualCash:e.actualCash,difference:e.difference,closedBy:e.closedBy,closedAt:new Date().toISOString(),timestamp:Date.now(),isLocked:!0,lockedAt:new Date().toISOString()};return e.notes&&(i.notes=e.notes),e.closedByName&&(i.closedByName=e.closedByName),void 0!==e.ordersCount&&(i.ordersCount=e.ordersCount),void 0!==e.paidOrdersCount&&(i.paidOrdersCount=e.paidOrdersCount),void 0!==e.unpaidOrdersCount&&(i.unpaidOrdersCount=e.unpaidOrdersCount),void 0!==e.tableOrdersCount&&(i.tableOrdersCount=e.tableOrdersCount),void 0!==e.roomOrdersCount&&(i.roomOrdersCount=e.roomOrdersCount),void 0!==e.takeawayOrdersCount&&(i.takeawayOrdersCount=e.takeawayOrdersCount),await (0,r.set)(s,i),i.id};e.s(["calculateReportStats",0,e=>{let t,r=e.filter(e=>"cancelled"!==e.status),a=r.reduce((e,t)=>e+(t.total||0),0),s=r.length,i=r.filter(e=>"cash"===e.paymentMethod).reduce((e,t)=>e+(t.total||0),0),o=r.filter(e=>"card"===e.paymentMethod).reduce((e,t)=>e+(t.total||0),0),n=r.filter(e=>"paid"===e.paymentStatus||"completed"===e.status).length,l=r.length-n,d=r.filter(e=>"table"===e.orderType).length,c=r.filter(e=>"room"===e.orderType).length,p=r.filter(e=>"takeaway"===e.orderType||!e.orderType).length,u=new Map;r.forEach(e=>{e.items?.forEach(e=>{let t=u.get(e.id)||{name:e.name,quantity:0,revenue:0};t.quantity+=e.quantity,t.revenue+=e.itemTotal||e.price*e.quantity,u.set(e.id,t)})});let f=0;return u.forEach(e=>{e.revenue>f&&(f=e.revenue,t=e)}),{totalSales:a,totalOrders:s,averageOrderValue:s>0?a/s:0,cashSales:i,cardSales:o,paidOrders:n,unpaidOrders:l,tableOrders:d,roomOrders:c,takeawayOrders:p,topProduct:t}},"createDailyClosing",0,p,"createEnhancedDailyClosing",0,h,"formatDateArabic",0,e=>new Date(e).toLocaleDateString("ar-EG",{year:"numeric",month:"short",day:"numeric"}),"getDailyClosingByDate",0,c,"getDailyClosings",0,d,"getDailyStatsForRange",0,i,"getDateRangeBounds",0,(e,t,r)=>{let a=new Date,s=new Date(a);s.setHours(23,59,59,999);let i=new Date(a);switch(i.setHours(0,0,0,0),e){case"today":break;case"week":i.setDate(i.getDate()-7);break;case"month":i.setMonth(i.getMonth()-1);break;case"year":i.setFullYear(i.getFullYear()-1);break;case"custom":t&&(i=new Date(t)),r&&(s.setTime(r.getTime()),s.setHours(23,59,59,999))}return{start:i,end:s}},"getMonthlyStats",0,n,"getOrdersByDateRange",0,s,"getSalesTrend",0,u,"getTodaySalesForClosing",0,f,"getTopProducts",0,l,"getWeeklyStats",0,o,"isDayClosed",0,m])},55127,e=>{"use strict";var t=e.i(43476),r=e.i(37902),a=e.i(71645),s=e.i(18566),i=e.i(22016),o=e.i(41791),n=e.i(84103),l=e.i(4050),d=e.i(64066),c=e.i(12034),p=e.i(5229),u=e.i(83505),f=e.i(16173),m=e.i(28801),h=e.i(16715),y=e.i(91741),g=e.i(3116),x=e.i(63209),b=e.i(69638),v=e.i(37727),S=e.i(1928),w=e.i(61659),j=e.i(70756);let k=(0,e.i(75254).default)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);function C(){let e=(0,s.useRouter)(),{worker:v,loading:C,canAccessModule:T,canPerformAction:N,shouldHideFinancialData:I}=(0,o.useWorkerAuth)(),[_,A]=(0,a.useState)("desktop"),[R,z]=(0,a.useState)("products"),[D,M]=(0,a.useState)([]),[F,E]=(0,a.useState)([]),[$,P]=(0,a.useState)([]),[W,q]=(0,a.useState)([]),[B,L]=(0,a.useState)([]),[U,H]=(0,a.useState)(!0),[V,Y]=(0,a.useState)(!1),[X,Z]=(0,a.useState)(null),[K,G]=(0,a.useState)([]),[Q,J]=(0,a.useState)(!1),[ee,et]=(0,a.useState)(!1),[er,ea]=(0,a.useState)(!1),[es,ei]=(0,a.useState)(null),[eo,en]=(0,a.useState)(null),[el,ed]=(0,a.useState)(null),[ec,ep]=(0,a.useState)(!1),[eu,ef]=(0,a.useState)(null);(0,a.useEffect)(()=>{C||v?C||!v||T("cashier")||e.replace("/worker"):e.replace("/worker/login")},[C,v,T,e]),(0,a.useEffect)(()=>{let e=()=>{let e=window.innerWidth;e<640?A("mobile"):e<1024?A("tablet"):e<1440?A("desktop"):A("wide")};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let em=async()=>{H(!0);try{let[e,t,r,a,s]=await Promise.all([(0,l.getPOSProducts)(),(0,l.getPOSCategories)(),(0,l.getAvailableTables)(),(0,l.getAvailableRooms)(),(0,l.getTodayPendingOrders)()]);M(e),E(t),P(r),q(a),L(s)}catch(e){console.error("Error loading data:",e),eh("خطأ في تحميل البيانات","error")}finally{H(!1)}};(0,a.useEffect)(()=>{v&&T("cashier")&&em()},[v]),(0,a.useEffect)(()=>{let e=async()=>{if(U)return;let e=new URLSearchParams(window.location.search),t=e.get("orderId"),r=e.get("roomId"),a=e.get("tableId"),s=e.get("mode");if(t&&t.trim()&&"add"===s){try{let e=await (0,n.getOrder)(t);e&&"paid"!==e.paymentStatus&&"completed"!==e.status?(ef(e),ep(!0),eh(`وضع إضافة طلب للطاولة ${e.tableNumber||e.tableId?.slice(-4)||""}`,"success")):e&&eh("هذا الطلب مدفوع بالفعل ولا يمكن الإضافة إليه","error")}catch(e){console.error("Error loading order for add mode:",e)}return}if(t&&t.trim())try{let e=await (0,n.getOrder)(t);if(e&&"paid"!==e.paymentStatus&&"completed"!==e.status){ed(e),eh(`تم تحميل الطلب #${t.slice(-6).toUpperCase()}`,"success");return}e&&eh("هذا الطلب مدفوع بالفعل","error")}catch(e){console.error("Error loading order from URL:",e)}if(r&&r.trim())try{let e=(await (0,l.getTodayPendingOrders)()).find(e=>e.roomId===r&&"paid"!==e.paymentStatus&&"completed"!==e.status);if(e){ed(e),eh(`تم تحميل طلب الغرفة #${e.id.slice(-6).toUpperCase()}`,"success");return}eh("لا يوجد طلب نشط لهذه الغرفة","error")}catch(e){console.error("Error searching room order:",e)}if(a&&a.trim())try{let e=(await (0,l.getTodayPendingOrders)()).find(e=>e.tableId===a&&"paid"!==e.paymentStatus&&"completed"!==e.status);if(e){ed(e),eh(`تم تحميل طلب الطاولة #${e.id.slice(-6).toUpperCase()}`,"success");return}eh("لا يوجد طلب نشط لهذه الطاولة","error")}catch(e){console.error("Error searching table order:",e)}};!U&&v&&e()},[U,v]),(0,a.useEffect)(()=>{if(!v)return;let e=new Date;e.setHours(0,0,0,0);let t=e.getTime(),r=(0,n.listenToOrders)(e=>{L(e.filter(e=>(e.timestamp||new Date(e.createdAt).getTime())>=t&&"completed"!==e.status&&"cancelled"!==e.status&&"paid"!==e.paymentStatus).sort((e,t)=>{let r=e.timestamp||new Date(e.createdAt).getTime();return(t.timestamp||new Date(t.createdAt).getTime())-r}))});return()=>r()},[v]),(0,a.useEffect)(()=>{let e=e=>{if("Escape"===e.key&&(X?Z(null):es?ei(null):K.length>0&&J(!0)),"/"===e.key&&!e.ctrlKey&&!e.metaKey){e.preventDefault();let t=document.querySelector('input[placeholder*="ابحث"]');t?.focus()}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[X,es,K]);let eh=(e,t)=>{en({message:e,type:t}),setTimeout(()=>en(null),3e3)},ey=(e,t,r,a)=>{let s=t?t.price:e.price||e.basePrice||0,i={id:`${e.id}_${t?.id||"default"}_${Date.now()}`,productId:e.id,name:e.name,emoji:e.emoji,variationId:t?.id,variationName:t?.name,unitPrice:s,quantity:r,note:a||void 0,lineTotal:s*r};G(e=>[...e,i]),eh(`تم إضافة ${e.name}`,"success")},eg=e=>{G(t=>t.filter(t=>t.id!==e))},ex=async e=>{if(!v)return void eh("يجب تسجيل الدخول","error");if(!N("createOrder"))return void eh("ليس لديك صلاحية لإنشاء طلب","error");Y(!0);try{if(ec&&eu){let t=e.items.map(e=>{let t={id:e.productId||e.id,name:e.name,price:e.unitPrice||0,quantity:e.quantity,itemTotal:e.lineTotal||e.quantity*(e.unitPrice||0)};return e.emoji&&(t.emoji=e.emoji),e.note&&(t.note=e.note),t});await (0,n.addItemsToOrder)(eu.id,t),eh(`تم إضافة ${t.length} صنف للطلب #${eu.id.slice(-6).toUpperCase()}`,"success"),G([]),ep(!1),ef(null),window.history.back()}else{let t=await (0,l.createPOSOrder)(e,v.id||"",v.name||"");eh(`تم إنشاء الطلب #${t.slice(-6).toUpperCase()}`,"success"),G([]),await em()}}catch(e){console.error("Error creating/updating order:",e),eh("خطأ في الطلب","error")}finally{Y(!1)}},eb=async(e,t,r)=>{if(!v)return void eh("يجب تسجيل الدخول","error");if(!N("processPayment"))return void eh("ليس لديك صلاحية لمعالجة الدفع","error");Y(!0);try{let a=isNaN(r)?e.total:r,s=await (0,l.createPOSOrder)(e,v.id||"",v.name||""),i="cash"===t?Math.max(0,a-e.total):0;await (0,l.payAndCloseOrder)(s,{method:t,receivedAmount:a,change:i},v.id||"",v.name||""),ei({orderNumber:s.slice(-6).toUpperCase(),items:e.items,subtotal:e.subtotal||0,discount:e.discount?.amount||0,tax:e.tax?.amount||0,total:e.total||0,paymentMethod:t,receivedAmount:a,change:i,customerName:e.customerName,tableNumber:e.tableNumber,roomNumber:e.roomNumber,cashierName:v.name||"",orderType:e.orderType}),G([]),eh("تم الدفع بنجاح","success"),await em()}catch(e){console.error("Error processing payment:",e),eh("خطأ في معالجة الدفع","error")}finally{Y(!1)}},ev=async(e,t,r)=>{if(!v)return void eh("يجب تسجيل الدخول","error");if(!N("processPayment"))return void eh("ليس لديك صلاحية لمعالجة الدفع","error");Y(!0);try{let a=isNaN(r)?e.total:r,s="cash"===t?Math.max(0,a-e.total):0;await (0,l.payAndCloseOrder)(e.id,{method:t,receivedAmount:a,change:s},v.id||"",v.name||""),ei({orderNumber:e.id.slice(-6).toUpperCase(),items:e.items.map(e=>({id:e.id,productId:e.id,name:e.name,unitPrice:e.price||0,quantity:e.quantity,lineTotal:e.itemTotal||(e.price||0)*e.quantity,emoji:e.emoji,note:e.note})),subtotal:e.subtotal||e.total||0,discount:e.discount?.amount||0,tax:0,total:e.total||0,paymentMethod:t,receivedAmount:a,change:s,customerName:e.customerName,tableNumber:e.tableNumber,roomNumber:e.roomNumber,cashierName:v.name||"",orderType:e.orderType||"takeaway"}),ed(null),eh("تم الدفع بنجاح","success"),await em()}catch(e){console.error("Error paying pending order:",e),eh("خطأ في معالجة الدفع","error")}finally{Y(!1)}},eS=I();if(C||!v)return(0,t.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh",backgroundColor:"#f1f5f9"},children:(0,t.jsx)("p",{style:{color:"#64748b"},children:"جاري التحميل..."})});if(U)return(0,t.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh",backgroundColor:"#f1f5f9"},children:(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"16px"},children:[(0,t.jsx)("div",{style:{width:"48px",height:"48px",border:"4px solid #e2e8f0",borderTopColor:"#6366f1",borderRadius:"50%",animation:"spin 1s linear infinite"}}),(0,t.jsx)("p",{style:{fontSize:"16px",color:"#64748b"},children:"جاري تحميل الكاشير..."})]})});let ew="mobile"===_,ej="tablet"===_,ek=K.reduce((e,t)=>e+t.quantity,0);return K.reduce((e,t)=>e+t.lineTotal,0),(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"calc(100vh - 120px)",minHeight:ew?"auto":void 0,backgroundColor:"#f1f5f9"},className:"jsx-67dbc8976d6a3be5",children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:ew?"12px 16px":"tablet"===_?"14px 20px":"16px 24px",backgroundColor:"#ffffff",borderBottom:"1px solid #e2e8f0",flexWrap:ew?"wrap":"nowrap",gap:ew?"12px":"0"},className:"jsx-67dbc8976d6a3be5",children:[(0,t.jsxs)("div",{style:{flex:ew?"1 1 100%":"none",display:"flex",alignItems:"center",gap:"12px"},className:"jsx-67dbc8976d6a3be5",children:[(0,t.jsxs)(i.default,{href:"/worker",style:{textDecoration:"none",color:"#6366f1",fontWeight:600,fontSize:"14px",display:"flex",alignItems:"center",gap:"4px"},children:[(0,t.jsx)(k,{style:{width:"16px",height:"16px"}}),"رجوع"]}),(0,t.jsxs)("div",{className:"jsx-67dbc8976d6a3be5",children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},className:"jsx-67dbc8976d6a3be5",children:[(0,t.jsx)("h1",{style:{fontSize:ew?"18px":"20px",fontWeight:700,color:"#0f172a",margin:0},className:"jsx-67dbc8976d6a3be5",children:ec?"إضافة طلب للطاولة":"الكاشير"}),ec&&eu&&(0,t.jsxs)("span",{style:{padding:"4px 12px",backgroundColor:"#dbeafe",color:"#1d4ed8",borderRadius:"20px",fontSize:"12px",fontWeight:700,display:"flex",alignItems:"center",gap:"6px"},className:"jsx-67dbc8976d6a3be5",children:["طاولة ",eu.tableNumber||eu.tableId?.slice(-4),(0,t.jsx)("button",{onClick:()=>{ep(!1),ef(null),window.history.back()},style:{width:"18px",height:"18px",borderRadius:"50%",backgroundColor:"#1d4ed8",color:"#ffffff",border:"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px"},className:"jsx-67dbc8976d6a3be5",children:"×"})]})]}),(0,t.jsx)("p",{style:{fontSize:ew?"12px":"13px",color:"#64748b",marginTop:"2px"},className:"jsx-67dbc8976d6a3be5",children:ec?`إضافة أصناف للطلب #${eu?.id.slice(-6).toUpperCase()||""}`:`نقطة البيع - ${v?.name||"موظف"}`})]})]}),(0,t.jsxs)("div",{style:{display:"flex",gap:ew?"8px":"12px",flexWrap:"wrap"},className:"jsx-67dbc8976d6a3be5",children:[!ew&&(0,t.jsxs)("button",{onClick:()=>et(!ee),style:{display:"flex",alignItems:"center",gap:"8px",padding:"tablet"===_?"8px 12px":"10px 16px",backgroundColor:ee?"#6366f1":"#f1f5f9",border:"1px solid #e2e8f0",borderRadius:"10px",fontSize:"tablet"===_?"12px":"13px",fontWeight:600,color:ee?"#ffffff":"#475569",cursor:"pointer",position:"relative"},className:"jsx-67dbc8976d6a3be5",children:[(0,t.jsx)(y.ClipboardList,{style:{width:"18px",height:"18px"}}),"tablet"!==_&&"الطلبات المعلقة",B.length>0&&(0,t.jsx)("span",{style:{position:"absolute",top:"-6px",left:"-6px",width:"20px",height:"20px",backgroundColor:"#dc2626",borderRadius:"50%",fontSize:"11px",fontWeight:700,color:"#ffffff",display:"flex",alignItems:"center",justifyContent:"center"},className:"jsx-67dbc8976d6a3be5",children:B.length})]}),!ew&&N("dailyClosing")&&(0,t.jsxs)("button",{onClick:()=>ea(!0),style:{display:"flex",alignItems:"center",gap:"8px",padding:"tablet"===_?"8px 12px":"10px 16px",background:"linear-gradient(135deg, #dc2626 0%, #b91c1c 100%)",border:"none",borderRadius:"10px",fontSize:"tablet"===_?"12px":"13px",fontWeight:600,color:"#ffffff",cursor:"pointer",boxShadow:"0 2px 8px rgba(220, 38, 38, 0.25)"},className:"jsx-67dbc8976d6a3be5",children:[(0,t.jsx)(j.Lock,{style:{width:"16px",height:"16px"}}),"tablet"!==_&&"إغلاق اليوم"]}),(0,t.jsxs)("button",{onClick:em,style:{display:"flex",alignItems:"center",gap:ew?"4px":"8px",padding:ew||"tablet"===_?"8px 12px":"10px 16px",backgroundColor:"#f1f5f9",border:"1px solid #e2e8f0",borderRadius:"10px",fontSize:ew?"12px":"13px",fontWeight:600,color:"#475569",cursor:"pointer"},className:"jsx-67dbc8976d6a3be5",children:[(0,t.jsx)(h.RefreshCw,{style:{width:ew?"16px":"18px",height:ew?"16px":"18px"}}),"تحديث"]})]})]}),(ew||ej)&&(0,t.jsxs)("div",{style:{position:"fixed",bottom:0,left:0,right:0,display:"flex",backgroundColor:"#ffffff",borderTop:"1px solid #e2e8f0",zIndex:100,padding:"8px",gap:"8px",boxShadow:"0 -2px 10px rgba(0, 0, 0, 0.1)"},className:"jsx-67dbc8976d6a3be5",children:[(0,t.jsxs)("button",{onClick:()=>z("products"),style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",gap:"4px",padding:"8px",backgroundColor:"products"===R?"#6366f1":"transparent",border:"none",borderRadius:"8px",color:"products"===R?"#ffffff":"#64748b",fontSize:"11px",cursor:"pointer"},className:"jsx-67dbc8976d6a3be5",children:[(0,t.jsx)(y.ClipboardList,{style:{width:"20px",height:"20px"}}),"المنتجات"]}),(0,t.jsxs)("button",{onClick:()=>z("cart"),style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",gap:"4px",padding:"8px",backgroundColor:"cart"===R?"#6366f1":"transparent",border:"none",borderRadius:"8px",color:"cart"===R?"#ffffff":"#64748b",fontSize:"11px",cursor:"pointer",position:"relative"},className:"jsx-67dbc8976d6a3be5",children:[(0,t.jsx)(S.ShoppingCart,{style:{width:"20px",height:"20px"}}),"السلة",ek>0&&(0,t.jsx)("span",{style:{position:"absolute",top:"2px",right:"50%",transform:"translateX(14px)",minWidth:"18px",height:"18px",backgroundColor:"#dc2626",borderRadius:"9px",fontSize:"10px",fontWeight:700,color:"#ffffff",display:"flex",alignItems:"center",justifyContent:"center",padding:"0 4px"},className:"jsx-67dbc8976d6a3be5",children:ek})]}),(0,t.jsxs)("button",{onClick:()=>z("payment"),style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",gap:"4px",padding:"8px",backgroundColor:"payment"===R?"#6366f1":"transparent",border:"none",borderRadius:"8px",color:"payment"===R?"#ffffff":"#64748b",fontSize:"11px",cursor:"pointer"},className:"jsx-67dbc8976d6a3be5",children:[(0,t.jsx)(w.CreditCard,{style:{width:"20px",height:"20px"}}),"الدفع"]}),(0,t.jsxs)("button",{onClick:()=>et(!ee),style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",gap:"4px",padding:"8px",backgroundColor:ee?"#f59e0b":"transparent",border:"none",borderRadius:"8px",color:ee?"#ffffff":"#64748b",fontSize:"11px",cursor:"pointer",position:"relative"},className:"jsx-67dbc8976d6a3be5",children:[(0,t.jsx)(g.Clock,{style:{width:"20px",height:"20px"}}),"معلقة",B.length>0&&(0,t.jsx)("span",{style:{position:"absolute",top:"2px",right:"50%",transform:"translateX(14px)",minWidth:"18px",height:"18px",backgroundColor:"#dc2626",borderRadius:"9px",fontSize:"10px",fontWeight:700,color:"#ffffff",display:"flex",alignItems:"center",justifyContent:"center",padding:"0 4px"},className:"jsx-67dbc8976d6a3be5",children:B.length})]}),N("dailyClosing")&&(0,t.jsxs)("button",{onClick:()=>ea(!0),style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",gap:"4px",padding:"8px",backgroundColor:"transparent",border:"none",borderRadius:"8px",color:"#dc2626",fontSize:"11px",cursor:"pointer"},className:"jsx-67dbc8976d6a3be5",children:[(0,t.jsx)(j.Lock,{style:{width:"20px",height:"20px"}}),"إغلاق"]})]}),(0,t.jsxs)("div",{style:{flex:1,display:ew||ej?"block":"grid",gridTemplateColumns:ew||ej||"mobile"===_?"1fr":"tablet"===_?ee?"200px 1fr 280px":"1fr 280px":"desktop"===_?ee?"240px 1fr 300px 280px":"1fr 300px 280px":ee?"280px 1fr 340px 320px":"1fr 340px 320px",gap:ew||ej?"0":"16px",padding:ew?"12px":ej?"12px 16px":"16px 24px",paddingBottom:ew||ej?"80px":void 0,overflow:"auto"},className:"jsx-67dbc8976d6a3be5",children:[ee&&(!(ew||ej)||"products"===R)&&(0,t.jsxs)("div",{style:{backgroundColor:"#ffffff",borderRadius:"16px",border:"1px solid #e2e8f0",overflow:"hidden",display:"flex",flexDirection:"column"},className:"jsx-67dbc8976d6a3be5",children:[(0,t.jsx)("div",{style:{padding:"16px",borderBottom:"1px solid #e2e8f0",backgroundColor:"#fef3c7"},className:"jsx-67dbc8976d6a3be5",children:(0,t.jsxs)("h3",{style:{fontSize:"14px",fontWeight:700,color:"#92400e",margin:0,display:"flex",alignItems:"center",gap:"8px"},className:"jsx-67dbc8976d6a3be5",children:[(0,t.jsx)(g.Clock,{style:{width:"18px",height:"18px"}}),"الطلبات المعلقة (",B.length,")"]})}),(0,t.jsx)("div",{style:{flex:1,overflowY:"auto",padding:"12px"},className:"jsx-67dbc8976d6a3be5",children:0===B.length?(0,t.jsx)("p",{style:{textAlign:"center",color:"#94a3b8",fontSize:"13px",padding:"24px"},className:"jsx-67dbc8976d6a3be5",children:"لا توجد طلبات معلقة"}):(0,t.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},className:"jsx-67dbc8976d6a3be5",children:B.map(e=>(0,t.jsxs)("div",{onClick:()=>ed(e),style:{padding:"12px",backgroundColor:"#f8fafc",borderRadius:"10px",border:"1px solid #e2e8f0",cursor:"pointer",transition:"all 0.2s"},onMouseOver:e=>{e.currentTarget.style.backgroundColor="#f1f5f9",e.currentTarget.style.borderColor="#6366f1"},onMouseOut:e=>{e.currentTarget.style.backgroundColor="#f8fafc",e.currentTarget.style.borderColor="#e2e8f0"},className:"jsx-67dbc8976d6a3be5",children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},className:"jsx-67dbc8976d6a3be5",children:[(0,t.jsxs)("span",{style:{fontSize:"13px",fontWeight:700,color:"#6366f1"},className:"jsx-67dbc8976d6a3be5",children:["#",e.id.slice(-6).toUpperCase()]}),(0,t.jsx)("span",{style:{padding:"2px 8px",backgroundColor:"#fef3c7",borderRadius:"6px",fontSize:"10px",fontWeight:600,color:"#f59e0b"},className:"jsx-67dbc8976d6a3be5",children:"pending"===e.status?"معلق":"قيد التحضير"})]}),(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"12px",color:"#64748b"},className:"jsx-67dbc8976d6a3be5",children:[(0,t.jsxs)("span",{className:"jsx-67dbc8976d6a3be5",children:[e.itemsCount||e.items?.length," عناصر"]}),(0,t.jsx)("span",{style:{fontWeight:600,color:"#16a34a"},className:"jsx-67dbc8976d6a3be5",children:eS?"---":`${e.total.toFixed(3)} ر.ع`})]}),(e.tableNumber||e.roomNumber)&&(0,t.jsx)("p",{style:{fontSize:"11px",color:"#94a3b8",marginTop:"6px"},className:"jsx-67dbc8976d6a3be5",children:e.tableNumber?`طاولة ${e.tableNumber}`:`غرفة ${e.roomNumber}`})]},e.id))})})]}),(!(ew||ej)||"products"===R)&&(0,t.jsx)(d.default,{products:D,categories:F,onProductClick:e=>{e.variations&&e.variations.length>0||e.sizes&&Object.keys(e.sizes).length>0||e.shishaTypes&&Object.keys(e.shishaTypes).length>0?Z(e):ey(e,null,1,"")}}),(!(ew||ej)||"cart"===R)&&(0,t.jsx)(c.default,{items:K,onUpdateQuantity:(e,t)=>{t<=0?eg(e):G(r=>r.map(r=>r.id===e?{...r,quantity:t,lineTotal:r.unitPrice*t}:r))},onRemoveItem:eg,onUpdateNote:(e,t)=>{G(r=>r.map(r=>r.id===e?{...r,note:t||void 0}:r))},onClearCart:()=>J(!0)}),(!(ew||ej)||"payment"===R)&&(0,t.jsx)(p.default,{items:K,tables:$,rooms:W,onPlaceOrder:ex,onPayNow:eb,loading:V})]}),X&&(0,t.jsx)(u.default,{product:X,onClose:()=>Z(null),onAddToCart:ey}),es&&(0,t.jsx)(f.default,{...es,onClose:()=>ei(null)}),Q&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{onClick:()=>J(!1),style:{position:"fixed",inset:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:100},className:"jsx-67dbc8976d6a3be5"}),(0,t.jsxs)("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"360px",backgroundColor:"#ffffff",borderRadius:"20px",padding:"24px",zIndex:101,textAlign:"center"},className:"jsx-67dbc8976d6a3be5",children:[(0,t.jsx)("div",{style:{width:"56px",height:"56px",borderRadius:"50%",backgroundColor:"#fef3c7",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 16px"},className:"jsx-67dbc8976d6a3be5",children:(0,t.jsx)(x.AlertCircle,{style:{width:"28px",height:"28px",color:"#f59e0b"}})}),(0,t.jsx)("h3",{style:{fontSize:"18px",fontWeight:700,color:"#0f172a",marginBottom:"8px"},className:"jsx-67dbc8976d6a3be5",children:"مسح السلة؟"}),(0,t.jsx)("p",{style:{fontSize:"14px",color:"#64748b",marginBottom:"24px"},className:"jsx-67dbc8976d6a3be5",children:"سيتم حذف جميع العناصر من السلة. هل أنت متأكد؟"}),(0,t.jsxs)("div",{style:{display:"flex",gap:"12px"},className:"jsx-67dbc8976d6a3be5",children:[(0,t.jsx)("button",{onClick:()=>{G([]),J(!1),eh("تم مسح السلة","success")},style:{flex:1,padding:"12px",backgroundColor:"#dc2626",border:"none",borderRadius:"12px",fontSize:"14px",fontWeight:600,color:"#ffffff",cursor:"pointer"},className:"jsx-67dbc8976d6a3be5",children:"نعم، امسح"}),(0,t.jsx)("button",{onClick:()=>J(!1),style:{flex:1,padding:"12px",backgroundColor:"#f1f5f9",border:"none",borderRadius:"12px",fontSize:"14px",fontWeight:600,color:"#475569",cursor:"pointer"},className:"jsx-67dbc8976d6a3be5",children:"إلغاء"})]})]})]}),el&&(0,t.jsx)(O,{order:el,onClose:()=>ed(null),onPay:ev,processing:V,hideFinancial:eS}),er&&v&&N("dailyClosing")&&(0,t.jsx)(m.default,{onClose:()=>ea(!1),onSuccess:()=>{eh("تم إغلاق اليوم بنجاح","success"),em()},userId:v.id||"",userName:v.name||""}),eo&&(0,t.jsxs)("div",{style:{position:"fixed",bottom:"24px",left:"50%",transform:"translateX(-50%)",display:"flex",alignItems:"center",gap:"10px",padding:"14px 24px",backgroundColor:"success"===eo.type?"#16a34a":"#dc2626",borderRadius:"12px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",zIndex:200,animation:"slideUp 0.3s ease-out"},className:"jsx-67dbc8976d6a3be5",children:["success"===eo.type?(0,t.jsx)(b.CheckCircle,{style:{width:"20px",height:"20px",color:"#ffffff"}}):(0,t.jsx)(x.AlertCircle,{style:{width:"20px",height:"20px",color:"#ffffff"}}),(0,t.jsx)("span",{style:{fontSize:"14px",fontWeight:600,color:"#ffffff"},className:"jsx-67dbc8976d6a3be5",children:eo.message})]}),(0,t.jsx)(r.default,{id:"67dbc8976d6a3be5",children:"@keyframes spin{to{transform:rotate(360deg)}}@keyframes slideUp{0%{opacity:0;transform:translate(-50%)translateY(20px)}to{opacity:1;transform:translate(-50%)translateY(0)}}"})]})}function O({order:e,onClose:r,onPay:s,processing:i,hideFinancial:o=!1}){let[n,l]=(0,a.useState)("cash"),[d,c]=(0,a.useState)(""),p="card"===n||parseFloat(d)>=e.total,u="cash"===n&&parseFloat(d)>e.total?parseFloat(d)-e.total:0;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{onClick:r,style:{position:"fixed",inset:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:100}}),(0,t.jsxs)("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"480px",maxWidth:"95vw",maxHeight:"90vh",backgroundColor:"#ffffff",borderRadius:"20px",zIndex:101,overflow:"hidden",display:"flex",flexDirection:"column"},children:[(0,t.jsx)("div",{style:{padding:"20px 24px",borderBottom:"1px solid #e2e8f0",backgroundColor:"#f8fafc"},children:(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h3",{style:{fontSize:"18px",fontWeight:700,color:"#0f172a",margin:0},children:["دفع الطلب #",e.id.slice(-6).toUpperCase()]}),(0,t.jsxs)("p",{style:{fontSize:"13px",color:"#64748b",margin:"4px 0 0 0"},children:["staff-menu"===e.source?"طلب من منيو الموظفين":"طلب من الكاشير",e.tableNumber&&` • طاولة ${e.tableNumber}`,e.roomNumber&&` • غرفة ${e.roomNumber}`]})]}),(0,t.jsx)("button",{onClick:r,style:{width:"36px",height:"36px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#ffffff",border:"1px solid #e2e8f0",borderRadius:"10px",cursor:"pointer",color:"#64748b"},children:(0,t.jsx)(v.X,{style:{width:"18px",height:"18px"}})})]})}),(0,t.jsxs)("div",{style:{flex:1,overflowY:"auto",padding:"20px 24px"},children:[(0,t.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,t.jsxs)("h4",{style:{fontSize:"13px",fontWeight:600,color:"#94a3b8",marginBottom:"12px"},children:["العناصر (",e.items?.length||0,")"]}),(0,t.jsxs)("div",{style:{backgroundColor:"#f8fafc",borderRadius:"12px",overflow:"hidden"},children:[e.items?.map((r,a)=>(0,t.jsxs)("div",{style:{padding:"12px 16px",borderBottom:a<(e.items?.length||0)-1?"1px solid #e2e8f0":"none",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("span",{style:{fontSize:"14px",fontWeight:500,color:"#0f172a"},children:[r.emoji&&(0,t.jsx)("span",{style:{marginLeft:"6px"},children:r.emoji}),r.name]}),(0,t.jsxs)("p",{style:{fontSize:"12px",color:"#64748b",margin:"2px 0 0 0"},children:[r.quantity," × ",o?"---":`${(r.price||0).toFixed(3)} ر.ع`]})]}),(0,t.jsx)("span",{style:{fontSize:"14px",fontWeight:600,color:"#0f172a"},children:o?"---":`${(r.itemTotal||r.price*r.quantity).toFixed(3)} ر.ع`})]},a)),(0,t.jsxs)("div",{style:{padding:"14px 16px",backgroundColor:"#f1f5f9",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,t.jsx)("span",{style:{fontSize:"15px",fontWeight:700,color:"#0f172a"},children:"الإجمالي"}),(0,t.jsx)("span",{style:{fontSize:"20px",fontWeight:700,color:"#16a34a"},children:o?"---":`${e.total.toFixed(3)} ر.ع`})]})]})]}),(0,t.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,t.jsx)("h4",{style:{fontSize:"13px",fontWeight:600,color:"#94a3b8",marginBottom:"10px"},children:"طريقة الدفع"}),(0,t.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,t.jsx)("button",{onClick:()=>l("cash"),style:{flex:1,padding:"14px",backgroundColor:"cash"===n?"#16a34a":"#f8fafc",border:`2px solid ${"cash"===n?"#16a34a":"#e2e8f0"}`,borderRadius:"12px",fontSize:"14px",fontWeight:600,color:"cash"===n?"#ffffff":"#475569",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:"💵 نقدي"}),(0,t.jsx)("button",{onClick:()=>l("card"),style:{flex:1,padding:"14px",backgroundColor:"card"===n?"#6366f1":"#f8fafc",border:`2px solid ${"card"===n?"#6366f1":"#e2e8f0"}`,borderRadius:"12px",fontSize:"14px",fontWeight:600,color:"card"===n?"#ffffff":"#475569",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:"💳 بطاقة"})]})]}),"cash"===n&&!o&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{style:{fontSize:"13px",fontWeight:600,color:"#94a3b8",marginBottom:"10px"},children:"المبلغ المستلم"}),(0,t.jsx)("input",{type:"number",value:d,onChange:e=>c(e.target.value),placeholder:`الحد الأدنى: ${e.total.toFixed(3)} ر.ع`,style:{width:"100%",padding:"14px 16px",fontSize:"18px",fontWeight:600,textAlign:"center",border:"2px solid #e2e8f0",borderRadius:"12px",outline:"none",marginBottom:"12px"}}),(0,t.jsxs)("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[[1,2,5,10,20,50].map(e=>(0,t.jsxs)("button",{onClick:()=>c(e.toString()),style:{padding:"8px 16px",backgroundColor:"#f1f5f9",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"13px",fontWeight:600,color:"#475569",cursor:"pointer"},children:[e," ر.ع"]},e)),(0,t.jsx)("button",{onClick:()=>c(e.total.toString()),style:{padding:"8px 16px",backgroundColor:"#dcfce7",border:"1px solid #16a34a",borderRadius:"8px",fontSize:"13px",fontWeight:600,color:"#16a34a",cursor:"pointer"},children:"المبلغ الكامل"})]}),u>0&&(0,t.jsxs)("div",{style:{marginTop:"16px",padding:"12px 16px",backgroundColor:"#fef3c7",borderRadius:"10px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,t.jsx)("span",{style:{fontSize:"14px",fontWeight:600,color:"#92400e"},children:"الباقي"}),(0,t.jsxs)("span",{style:{fontSize:"18px",fontWeight:700,color:"#f59e0b"},children:[u.toFixed(3)," ر.ع"]})]})]})]}),(0,t.jsx)("div",{style:{padding:"16px 24px",borderTop:"1px solid #e2e8f0",backgroundColor:"#f8fafc"},children:(0,t.jsx)("button",{onClick:()=>s(e,n,parseFloat(d)||e.total),disabled:!p||i||o,style:{width:"100%",padding:"16px",background:!p||i||o?"#e2e8f0":"linear-gradient(135deg, #16a34a 0%, #15803d 100%)",border:"none",borderRadius:"14px",fontSize:"16px",fontWeight:700,color:!p||i||o?"#94a3b8":"#ffffff",cursor:!p||i||o?"not-allowed":"pointer"},children:i?"جاري الدفع...":o?"---":`دفع ${e.total.toFixed(3)} ر.ع`})})]})]})}e.s(["default",()=>C],55127)}]);