(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,84103,e=>{"use strict";var t=e.i(33842);e.i(1465);var a=e.i(34991);let r=e=>`restaurant-system/${e}/${t.RESTAURANT_ID}`,i=async e=>{let i=Object.entries((await (0,a.get)((0,a.ref)(t.database,r("orders")))).val()||{}).map(([e,t])=>({id:e,...t}));return i.sort((e,t)=>{let a=e.timestamp||new Date(e.createdAt).getTime();return(t.timestamp||new Date(t.createdAt).getTime())-a}),e&&e>0&&(i=i.slice(0,e)),i},s=async(e,i)=>{let s=(await (0,a.get)((0,a.ref)(t.database,r("orders")))).val()||{},o=e.start.getTime(),n=e.end.getTime(),d=Object.entries(s).map(([e,t])=>({id:e,...t})).filter(e=>{let t=e.timestamp||new Date(e.createdAt).getTime();return t>=o&&t<=n}).sort((e,t)=>{let a=e.timestamp||new Date(e.createdAt).getTime();return(t.timestamp||new Date(t.createdAt).getTime())-a});return i&&i>0&&(d=d.slice(0,i)),d},o=async e=>{let i=await (0,a.get)((0,a.ref)(t.database,`${r("orders")}/${e}`));return i.exists()?{id:e,...i.val()}:null},n=async(e,i)=>{await (0,a.update)((0,a.ref)(t.database,`${r("orders")}/${e}`),{status:i,updatedAt:new Date().toISOString()})},d=async e=>{let i=(0,a.push)((0,a.ref)(t.database,r("orders"))),s=e.items.map(e=>{let t={id:e.id,name:e.name,price:e.price||0,quantity:e.quantity,itemTotal:e.itemTotal||e.price*e.quantity};return e.emoji&&(t.emoji=e.emoji),e.note&&(t.note=e.note),t}),o={items:s,total:e.total||0,status:e.status||"pending",restaurantId:t.RESTAURANT_ID,createdAt:new Date().toISOString(),timestamp:Date.now(),itemsCount:s.reduce((e,t)=>e+t.quantity,0)};void 0!==e.subtotal&&(o.subtotal=e.subtotal),e.discount&&(o.discount=e.discount),e.paymentMethod&&(o.paymentMethod=e.paymentMethod),e.paymentStatus&&(o.paymentStatus=e.paymentStatus),e.customerName&&(o.customerName=e.customerName),e.tableNumber&&(o.tableNumber=e.tableNumber),e.tableId&&(o.tableId=e.tableId),e.roomId&&(o.roomId=e.roomId),e.roomNumber&&(o.roomNumber=e.roomNumber),e.orderType&&(o.orderType=e.orderType),e.workerId&&(o.workerId=e.workerId),e.workerName&&(o.workerName=e.workerName),e.source&&(o.source=e.source);let n=null;if(e.tableNumber&&!e.tableId){let t=await D(e.tableNumber);t&&(n=t.id,o.tableId=t.id,o.orderType="table")}else e.tableId&&(n=e.tableId);await (0,a.set)(i,o);let d=i.key;if(n)try{await P(n,"occupied",d)}catch(e){console.error("Failed to update table status:",e)}return d},l=async()=>Object.entries((await (0,a.get)((0,a.ref)(t.database,r("menu")))).val()||{}).map(([e,t])=>{let a={id:e,...t,price:"string"==typeof t.price?parseFloat(t.price)||0:t.price||0,basePrice:t.basePrice?"string"==typeof t.basePrice?parseFloat(t.basePrice):t.basePrice:void 0};if(a.variations&&Array.isArray(a.variations)&&(a.variations=a.variations.map(e=>({...e,price:"string"==typeof e.price?parseFloat(e.price)||0:e.price||0}))),a.sizes&&"object"==typeof a.sizes){let e={};Object.entries(a.sizes).forEach(([t,a])=>{e[t]={...a,price:"string"==typeof a.price?parseFloat(a.price)||0:a.price||0}}),a.sizes=e}if(a.shishaTypes&&"object"==typeof a.shishaTypes){let e={};Object.entries(a.shishaTypes).forEach(([t,a])=>{e[t]={...a,price:"string"==typeof a.price?parseFloat(a.price)||0:a.price||0}}),a.shishaTypes=e}return a}),c=async e=>{let i=(0,a.push)((0,a.ref)(t.database,r("menu"))),s={};return Object.entries(e).forEach(([e,t])=>{if(void 0!==t)if("price"===e||"basePrice"===e)s[e]="string"==typeof t?parseFloat(t)||0:t||0;else if("variations"===e&&Array.isArray(t))s[e]=t.map(e=>({...e,price:"string"==typeof e.price?parseFloat(e.price)||0:e.price||0}));else if("sizes"===e&&"object"==typeof t){let a={};Object.entries(t).forEach(([e,t])=>{a[e]={...t,price:"string"==typeof t.price?parseFloat(t.price)||0:t.price||0}}),s[e]=a}else if("shishaTypes"===e&&"object"==typeof t){let a={};Object.entries(t).forEach(([e,t])=>{a[e]={...t,price:"string"==typeof t.price?parseFloat(t.price)||0:t.price||0}}),s[e]=a}else s[e]=t}),await (0,a.set)(i,{...s,category:e.categoryId||e.category,categoryId:e.categoryId||e.category,active:e.isActive??e.active??!0,isActive:e.isActive??e.active??!0,createdAt:new Date().toISOString()}),i.key},m=async(e,i)=>{let s={updatedAt:new Date().toISOString()};Object.entries(i).forEach(([e,t])=>{if(void 0!==t)if("price"===e||"basePrice"===e)s[e]="string"==typeof t?parseFloat(t)||0:t||0;else if("variations"===e&&Array.isArray(t))s[e]=t.map(e=>({...e,price:"string"==typeof e.price?parseFloat(e.price)||0:e.price||0}));else if("sizes"===e&&"object"==typeof t){let a={};Object.entries(t).forEach(([e,t])=>{a[e]={...t,price:"string"==typeof t.price?parseFloat(t.price)||0:t.price||0}}),s[e]=a}else if("shishaTypes"===e&&"object"==typeof t){let a={};Object.entries(t).forEach(([e,t])=>{a[e]={...t,price:"string"==typeof t.price?parseFloat(t.price)||0:t.price||0}}),s[e]=a}else s[e]=t}),i.categoryId&&(s.category=i.categoryId),void 0!==i.isActive&&(s.active=i.isActive),await (0,a.update)((0,a.ref)(t.database,`${r("menu")}/${e}`),s)},p=async e=>{await (0,a.remove)((0,a.ref)(t.database,`${r("menu")}/${e}`))},u=async()=>Object.entries((await (0,a.get)((0,a.ref)(t.database,r("categories")))).val()||{}).map(([e,t])=>({id:e,...t})).sort((e,t)=>(e.order||e.sortOrder||0)-(t.order||t.sortOrder||0)),y=async e=>{let i=(0,a.push)((0,a.ref)(t.database,r("categories"))),s={};return Object.entries(e).forEach(([e,t])=>{void 0!==t&&(s[e]=t)}),await (0,a.set)(i,{...s,createdAt:new Date().toISOString()}),i.key},b=async(e,i)=>{let s={};Object.entries(i).forEach(([e,t])=>{void 0!==t&&(s[e]=t)}),await (0,a.update)((0,a.ref)(t.database,`${r("categories")}/${e}`),{...s,updatedAt:new Date().toISOString()})},g=async e=>{await (0,a.remove)((0,a.ref)(t.database,`${r("categories")}/${e}`))},f=async e=>(await l()).filter(t=>t.category===e||t.categoryId===e),v=async e=>(await f(e)).length,w=async(e,i)=>{let s=await f(e),o={};s.forEach(e=>{o[`${r("menu")}/${e.id}/category`]=i,o[`${r("menu")}/${e.id}/categoryId`]=i,o[`${r("menu")}/${e.id}/updatedAt`]=new Date().toISOString()}),Object.keys(o).length>0&&await (0,a.update)((0,a.ref)(t.database),o)},h=async()=>Object.entries((await (0,a.get)((0,a.ref)(t.database,r("workers")))).val()||{}).map(([e,t])=>({id:e,...t})),O=async(e,i)=>{await (0,a.update)((0,a.ref)(t.database,`${r("workers")}/${e}`),{detailedPermissions:i})},A=async()=>{let e=new Date;e.setHours(0,0,0,0);let t=e.getTime();return(await i()).filter(e=>(e.timestamp||(e.createdAt?new Date(e.createdAt).getTime():0))>=t&&"cancelled"!==e.status)},S=async(e,i)=>{let s={paymentStatus:i,updatedAt:new Date().toISOString()};"paid"===i&&(s.paidAt=new Date().toISOString()),await (0,a.update)((0,a.ref)(t.database,`${r("orders")}/${e}`),s)},x=async(e,i)=>{let s=await o(e);if(!s)throw Error("Order not found");let n=[...s.items||[]];for(let e of i){let t=n.findIndex(t=>t.id===e.id&&t.name===e.name);if(t>=0)n[t].quantity+=e.quantity,n[t].itemTotal=n[t].quantity*n[t].price;else{let t={id:e.id,name:e.name,price:e.price||0,quantity:e.quantity,itemTotal:e.quantity*(e.price||0)};e.emoji&&(t.emoji=e.emoji),e.note&&(t.note=e.note),n.push(t)}}let d=n.map(e=>{let t={id:e.id,name:e.name,price:e.price||0,quantity:e.quantity,itemTotal:e.itemTotal||e.quantity*(e.price||0)};return e.emoji&&(t.emoji=e.emoji),e.note&&(t.note=e.note),t}),l=d.reduce((e,t)=>e+(t.itemTotal||t.quantity*t.price),0),c=d.reduce((e,t)=>e+t.quantity,0);await (0,a.update)((0,a.ref)(t.database,`${r("orders")}/${e}`),{items:d,total:l,itemsCount:c,updatedAt:new Date().toISOString()})},T=async(e,t)=>{let a=(await i()).filter(e=>"cancelled"!==e.status);if(e&&t){let r=e.getTime(),i=t.getTime();a=a.filter(e=>{let t=e.timestamp||(e.createdAt?new Date(e.createdAt).getTime():0);return t>=r&&t<=i})}let r=a.filter(e=>"paid"===e.status||"completed"===e.status).reduce((e,t)=>e+(t.total||0),0),s=a.length,o=a.filter(e=>"paid"===e.status||"completed"===e.status).length;return{totalRevenue:r,ordersCount:s,paidOrders:o,itemsSold:a.reduce((e,t)=>e+(t.itemsCount||t.items?.length||0),0),averageOrder:s>0?r/o:0}},j=async()=>Object.entries((await (0,a.get)((0,a.ref)(t.database,r("tables")))).val()||{}).map(([e,t])=>({id:e,...t})),I=async(e,t)=>!(await j()).some(a=>a.tableNumber===e&&a.id!==t),D=async e=>{let t=await j(),a=e.trim().toLowerCase(),r=e=>{let t=e.match(/\d+/);return t?t[0]:e},i=r(a),s=t.find(t=>t.tableNumber===e);return s||(s=t.find(e=>r(e.tableNumber.toLowerCase())===i))?s:(s=t.find(e=>e.tableNumber.toLowerCase().includes(a)||a.includes(e.tableNumber.toLowerCase())))||null},$=async e=>{if(!await I(e.tableNumber))throw Error(`Ø±Ù‚Ù… Ø§Ù„Ø·Ø§ÙˆÙ„Ø© "${e.tableNumber}" Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹`);let i={tableNumber:e.tableNumber,area:e.area,status:e.status||"available",activeOrderId:null,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};e.name&&e.name.trim()&&(i.name=e.name.trim());let s=(0,a.push)((0,a.ref)(t.database,r("tables")));return await (0,a.set)(s,i),s.key},N=async(e,i)=>{if(i.tableNumber&&!await I(i.tableNumber,e))throw Error(`Ø±Ù‚Ù… Ø§Ù„Ø·Ø§ÙˆÙ„Ø© "${i.tableNumber}" Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹`);let s={updatedAt:new Date().toISOString()};void 0!==i.tableNumber&&(s.tableNumber=i.tableNumber),void 0!==i.area&&(s.area=i.area),void 0!==i.status&&(s.status=i.status),void 0!==i.activeOrderId&&(s.activeOrderId=i.activeOrderId),void 0!==i.reservedBy&&(s.reservedBy=i.reservedBy),void 0!==i.reservedAt&&(s.reservedAt=i.reservedAt),void 0!==i.name&&(i.name&&i.name.trim()?s.name=i.name.trim():s.name=null),await (0,a.update)((0,a.ref)(t.database,`${r("tables")}/${e}`),s)},P=async(e,i,s,o)=>{let n={status:i,updatedAt:new Date().toISOString()};"available"===i?(n.activeOrderId=null,n.reservedBy=null,n.reservedAt=null):"reserved"===i?(n.reservedBy=o||null,n.reservedAt=new Date().toISOString()):"occupied"===i&&s&&(n.activeOrderId=s),await (0,a.update)((0,a.ref)(t.database,`${r("tables")}/${e}`),n)},k=async()=>Object.entries((await (0,a.get)((0,a.ref)(t.database,r("rooms")))).val()||{}).map(([e,t])=>({id:e,...t})).sort((e,t)=>(parseInt(String(e.roomNumber))||0)-(parseInt(String(t.roomNumber))||0)),R=async e=>{let i=(0,a.push)((0,a.ref)(t.database,r("rooms"))),s={roomNumber:e.roomNumber,status:e.status||"available",isActive:e.isActive??!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return e.name&&(s.name=e.name),e.notes&&(s.notes=e.notes),void 0!==e.hourlyRate&&e.hourlyRate>0&&(s.hourlyRate=e.hourlyRate),e.priceType&&(s.priceType=e.priceType),void 0!==e.malePrice&&(s.malePrice=e.malePrice),void 0!==e.femalePrice&&(s.femalePrice=e.femalePrice),await (0,a.set)(i,s),i.key},F=async(e,i)=>{let s={updatedAt:new Date().toISOString()};Object.entries(i).forEach(([e,t])=>{void 0!==t&&(s[e]=t)}),await (0,a.update)((0,a.ref)(t.database,`${r("rooms")}/${e}`),s)},C=async e=>{await (0,a.remove)((0,a.ref)(t.database,`${r("rooms")}/${e}`))},E=async(e,i,s,o)=>{let n={status:i,updatedAt:new Date().toISOString()};"available"===i?(n.activeOrderId=null,n.reservedBy=null,n.reservedAt=null):"reserved"===i?(n.reservedBy=o||null,n.reservedAt=new Date().toISOString()):"occupied"===i&&s&&(n.activeOrderId=s),await (0,a.update)((0,a.ref)(t.database,`${r("rooms")}/${e}`),n)},q=async()=>(await i()).filter(e=>"room"===e.orderType||e.roomId).sort((e,t)=>{let a=e.timestamp||(e.createdAt?new Date(e.createdAt).getTime():0);return(t.timestamp||(t.createdAt?new Date(t.createdAt).getTime():0))-a}),B=async e=>(await q()).filter(t=>{let a=t.timestamp||(t.createdAt?new Date(t.createdAt).getTime():0);return a>=e.start.getTime()&&a<=e.end.getTime()}),z=async(e,t)=>{await n(e,"completed"),await S(e,"paid"),await E(t,"available")};e.s(["addItemsToOrder",0,x,"closeRoomOrder",0,z,"createCategory",0,y,"createOrder",0,d,"createProduct",0,c,"createRoom",0,R,"createTable",0,$,"deleteCategory",0,g,"deleteProduct",0,p,"deleteRoom",0,C,"getCategories",0,u,"getCategoryProductCount",0,v,"getDateRangeForFilter",0,(e,t,a)=>{let r=new Date,i=new Date(r);i.setHours(23,59,59,999);let s=new Date(r);switch(s.setHours(0,0,0,0),e){case"today":break;case"week":s.setDate(s.getDate()-7);break;case"month":s.setMonth(s.getMonth()-1);break;case"year":s.setFullYear(s.getFullYear()-1);break;case"custom":t&&(s=new Date(t)),a&&(i.setTime(new Date(a).getTime()),i.setHours(23,59,59,999))}return{start:s,end:i}},"getDefaultWorkerPermissions",0,()=>({modules:{staffMenu:!0,orders:!1,tables:!1,rooms:!1,cashier:!1,inventory:!1,reports:!1,products:!1},actions:{createOrder:!0,editOrder:!1,cancelOrder:!1,processPayment:!1,applyDiscount:!1,viewFinancials:!1,manageProducts:!1,manageTables:!1,manageRooms:!1,dailyClosing:!1}}),"getFullPermissions",0,()=>({modules:{staffMenu:!0,orders:!0,tables:!0,rooms:!0,cashier:!0,inventory:!0,reports:!0,products:!0},actions:{createOrder:!0,editOrder:!0,cancelOrder:!0,processPayment:!0,applyDiscount:!0,viewFinancials:!0,manageProducts:!0,manageTables:!0,manageRooms:!0,dailyClosing:!0}}),"getOrder",0,o,"getOrders",0,i,"getOrdersByDateRange",0,s,"getProducts",0,l,"getRoomOrdersByDateRange",0,B,"getRooms",0,k,"getSalesStats",0,T,"getTables",0,j,"getTodayOrders",0,A,"getWorkers",0,h,"listenToOrders",0,e=>{let i=(0,a.ref)(t.database,r("orders")),s=(0,a.onValue)(i,t=>{e(Object.entries(t.val()||{}).map(([e,t])=>({id:e,...t})))});return()=>(0,a.off)(i,"value",s)},"listenToRooms",0,e=>{let i=(0,a.ref)(t.database,r("rooms")),s=(0,a.onValue)(i,t=>{e(Object.entries(t.val()||{}).map(([e,t])=>({id:e,...t})).sort((e,t)=>(parseInt(String(e.roomNumber))||0)-(parseInt(String(t.roomNumber))||0)))});return()=>(0,a.off)(i,"value",s)},"listenToTables",0,e=>{let i=(0,a.ref)(t.database,r("tables")),s=(0,a.onValue)(i,t=>{e(Object.entries(t.val()||{}).map(([e,t])=>({id:e,...t})))});return()=>(0,a.off)(i,"value",s)},"moveProductsToCategory",0,w,"setRoomStatus",0,E,"setTableStatus",0,P,"updateCategory",0,b,"updateOrderPaymentStatus",0,S,"updateOrderStatus",0,n,"updateProduct",0,m,"updateRoom",0,F,"updateTable",0,N,"updateWorkerPermissions",0,O])},20413,e=>{"use strict";var t=e.i(43476),a=e.i(71645),r=e.i(41791),i=e.i(84103),s=e.i(22016);function o(){let{canAccessModule:e,shouldHideFinancialData:o}=(0,r.useWorkerAuth)(),[n,d]=(0,a.useState)([]),[l,c]=(0,a.useState)(!0);(0,a.useEffect)(()=>{e("rooms")&&m()},[e]);let m=async()=>{try{let e=await (0,i.getRooms)();d(e.filter(e=>!1!==e.isActive))}catch(e){console.error("Error loading rooms:",e)}finally{c(!1)}};if(!e("rooms"))return(0,t.jsx)("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,t.jsxs)("div",{style:{textAlign:"center"},children:[(0,t.jsx)("div",{style:{fontSize:"64px",marginBottom:"16px"},children:"ğŸ”’"}),(0,t.jsx)("h2",{children:"Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø©"})]})});if(l)return(0,t.jsx)("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,t.jsx)("div",{children:"Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„..."})});let p=o();return(0,t.jsxs)("div",{style:{minHeight:"100vh",background:"#f8fafc"},children:[(0,t.jsx)("header",{style:{background:"white",padding:"16px 20px",boxShadow:"0 2px 8px rgba(0,0,0,0.05)",marginBottom:"20px"},children:(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,t.jsx)(s.default,{href:"/worker",style:{textDecoration:"none",color:"#6366f1",fontWeight:"600"},children:"â† Ø±Ø¬ÙˆØ¹"}),(0,t.jsx)("h1",{style:{margin:0,fontSize:"20px",fontWeight:"bold"},children:"Ø§Ù„ØºØ±Ù"}),(0,t.jsx)("div",{style:{width:"60px"}})]})}),(0,t.jsx)("div",{style:{padding:"0 20px 20px"},children:0===n.length?(0,t.jsx)("div",{style:{textAlign:"center",padding:"40px",color:"#64748b"},children:"Ù„Ø§ ØªÙˆØ¬Ø¯ ØºØ±Ù"}):(0,t.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"16px"},children:n.map(e=>(0,t.jsxs)("div",{style:{background:"available"===e.status?"white":"#fee2e2",borderRadius:"12px",padding:"20px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)"},children:[(0,t.jsx)("div",{style:{fontSize:"48px",marginBottom:"12px",textAlign:"center"},children:"ğŸšª"}),(0,t.jsx)("h3",{style:{margin:"0 0 8px",fontSize:"18px",fontWeight:"bold",textAlign:"center"},children:e.roomNumber||`ØºØ±ÙØ© ${e.id}`}),(0,t.jsx)("div",{style:{padding:"4px 12px",background:"available"===e.status?"#d1fae5":"#fee2e2",color:"available"===e.status?"#10b981":"#ef4444",borderRadius:"20px",fontSize:"12px",fontWeight:"600",display:"inline-block",marginBottom:"8px"},children:"available"===e.status?"Ù…ØªØ§Ø­Ø©":"Ù…Ø´ØºÙˆÙ„Ø©"}),e.price&&(0,t.jsx)("p",{style:{margin:"8px 0 0",textAlign:"center",color:"#10b981",fontWeight:"bold"},children:((e,t=!1)=>t?"---":e?`${e.toFixed(3)} Ø±.Ø¹`:"0.000 Ø±.Ø¹")(e.price,p)})]},e.id))})})]})}e.s(["default",()=>o])}]);