# ุฏููู ูุธุงู ุงููุตุงุฏูุฉ ุงูุฌุฏูุฏ - ูููุฉ ุงูุดุงู

## ๐ ูุธุฑุฉ ุนุงูุฉ

ุชู ุชุญุฏูุซ ูุธุงู ุงููุตุงุฏูุฉ ูุงุณุชุฎุฏุงู ูุธุงู ุขูู ุจุฏูุงู ูู `localStorage`. ุงููุธุงู ุงูุฌุฏูุฏ ูุณุชุฎุฏู:
- **sessionStorage** ุจุฏูุงู ูู localStorage (ุฃูุซุฑ ุฃูุงูุงู)
- **Firebase Sessions** ููุชุญูู ูู ุงูุฌูุณุงุช
- **ูุธุงู ูุนุงูุฌุฉ ุฃุฎุทุงุก ุดุงูู**
- **ุญูุงูุฉ ุจูุงูุงุช Firebase**

## ๐ง ุงููููุงุช ุงูุฌุฏูุฏุฉ

### 1. `js/auth.js`
ูุธุงู ุงููุตุงุฏูุฉ ุงูุฑุฆูุณู ุงูุฐู ูููุฑ:
- `Auth.loginAdmin(username, password)` - ุชุณุฌูู ุฏุฎูู ุงูุฃุฏูู
- `Auth.loginWorker(username, password, restaurantId)` - ุชุณุฌูู ุฏุฎูู ุงูุนุงูู
- `Auth.logout()` - ุชุณุฌูู ุงูุฎุฑูุฌ
- `Auth.checkAuth()` - ุงูุชุญูู ูู ุญุงูุฉ ุงููุตุงุฏูุฉ
- `Auth.getCurrentUser()` - ุงูุญุตูู ุนูู ุจูุงูุงุช ุงููุณุชุฎุฏู ุงูุญุงูู

### 2. `js/error-handler.js`
ูุธุงู ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุงูุดุงูู:
- `ErrorHandler.handleError(error, context, severity)` - ูุนุงูุฌุฉ ุฎุทุฃ ุนุงู
- `ErrorHandler.handleFirebaseError(error, operation)` - ูุนุงูุฌุฉ ุฃุฎุทุงุก Firebase
- `ErrorHandler.handleCriticalOperation(error, operation, data)` - ูุนุงูุฌุฉ ุนูููุงุช ุญุณุงุณุฉ
- `ErrorHandler.safeExecute(promise, context, isCritical)` - Wrapper ุขูู ููู Promises

### 3. `js/auth-check.js`
ููู ูุณุงุนุฏ ููุชุญูู ูู ุงููุตุงุฏูุฉ:
- `AuthCheck.checkAdminAuth()` - ุงูุชุญูู ูู ุชุณุฌูู ุฏุฎูู ุงูุฃุฏูู
- `AuthCheck.checkWorkerAuth()` - ุงูุชุญูู ูู ุชุณุฌูู ุฏุฎูู ุงูุนุงูู
- `AuthCheck.requireAuth(requiredRole, redirectTo)` - ุงูุชุญูู ูุฅุนุงุฏุฉ ุงูุชูุฌูู

## ๐ ููููุฉ ุงูุงุณุชุฎุฏุงู

### ูู ุตูุญุงุช ุชุณุฌูู ุงูุฏุฎูู

```html
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
<script src="js/firebase-config.js"></script>
<script src="js/error-handler.js"></script>
<script src="js/auth.js"></script>
```

### ูู ุงูุตูุญุงุช ุงูุฃุฎุฑู

```html
<script src="js/firebase-config.js"></script>
<script src="js/error-handler.js"></script>
<script src="js/auth.js"></script>
<script src="js/auth-check.js"></script>
<script>
    // ุงูุชุญูู ูู ุงููุตุงุฏูุฉ ุนูุฏ ุชุญููู ุงูุตูุญุฉ
    (async () => {
        const isAuthenticated = await AuthCheck.requireAuth('admin', 'login-admin.html');
        if (!isAuthenticated) {
            return; // ุณูุชู ุฅุนุงุฏุฉ ุงูุชูุฌูู ุชููุงุฆูุงู
        }
        
        // ุงูููุฏ ุงูุฎุงุต ุจุงูุตูุญุฉ
        const currentUser = AuthCheck.getCurrentUserData();
        console.log('ุงููุณุชุฎุฏู ุงูุญุงูู:', currentUser);
    })();
</script>
```

## ๐ ุงูุชุญุฏูุซุงุช ุงููุทููุจุฉ ูู ุงูุตูุญุงุช ุงูุฃุฎุฑู

### ุงุณุชุจุฏุงู localStorage ุจู AuthCheck

**ูุจู:**
```javascript
if (localStorage.getItem('admin_logged_in') === 'true') {
    // ุงูููุฏ
}
```

**ุจุนุฏ:**
```javascript
const isAdmin = await AuthCheck.checkAdminAuth();
if (isAdmin) {
    // ุงูููุฏ
}
```

### ุงูุญุตูู ุนูู ุจูุงูุงุช ุงููุณุชุฎุฏู

**ูุจู:**
```javascript
const userName = localStorage.getItem('admin_name');
const userRole = localStorage.getItem('admin_role');
```

**ุจุนุฏ:**
```javascript
const userData = AuthCheck.getCurrentUserData();
const userName = userData?.name;
const userRole = userData?.role;
```

### ุชุณุฌูู ุงูุฎุฑูุฌ

**ูุจู:**
```javascript
localStorage.removeItem('admin_logged_in');
localStorage.removeItem('admin_username');
// ... ุฅูุฎ
window.location.href = 'login-admin.html';
```

**ุจุนุฏ:**
```javascript
await AuthCheck.logout(); // ุณูุชู ุฅุนุงุฏุฉ ุงูุชูุฌูู ุชููุงุฆูุงู
```

## ๐ก๏ธ ุญูุงูุฉ ุจูุงูุงุช Firebase

### ุงุณุชุฎุฏุงู Environment Variables

ูู ุงูุฅูุชุงุฌุ ููููู ุงุณุชุฎุฏุงู Environment Variables:

```html
<script>
    window.env = {
        FIREBASE_CONFIG: {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            // ... ุจุงูู ุงูุฅุนุฏุงุฏุงุช
        }
    };
</script>
<script src="js/firebase-config.js"></script>
```

### ุงุณุชุฎุฏุงู Firebase App Check (ููุตู ุจู)

1. ุชูุนูู Firebase App Check ูู Console
2. ุฅุถุงูุฉ App Check Token ูู ุงูุทูุจุงุช
3. ุชุญุฏูุซ ููุงุนุฏ ุงูุฃูุงู ูู Firebase

## โ๏ธ ููุงุญุธุงุช ูููุฉ

1. **sessionStorage vs localStorage**: ุงููุธุงู ุงูุฌุฏูุฏ ูุณุชุฎุฏู `sessionStorage` ุงูุฐู ูุชู ูุณุญู ุชููุงุฆูุงู ุนูุฏ ุฅุบูุงู ุงููุชุตูุญ (ุฃูุซุฑ ุฃูุงูุงู)

2. **ุงูุฌูุณุงุช**: ูู ุฌูุณุฉ ููุง `sessionId` ูุฑูุฏ ูุชู ุญูุธู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุน ุชุงุฑูุฎ ุงูุชูุงุก

3. **ุงูุชูุงูู ูุน ุงูููุฏ ุงููุฏูู**: ุงููุธุงู ุงูุฌุฏูุฏ ูุญุชูู ุนูู Fallback ููุชูุงูู ูุน ุงูููุฏ ุงููุฏูู

4. **ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก**: ุฌููุน ุงูุนูููุงุช ูุญููุฉ ุจู try-catch ููุนุงูุฌุฉ ุฃุฎุทุงุก ุดุงููุฉ

## ๐ ูุงุฆูุฉ ุงูุตูุญุงุช ุงูุชู ุชุญุชุงุฌ ุชุญุฏูุซ

- [x] login-admin.html
- [x] login-worker.html
- [x] js/sidebar.js
- [ ] index.html
- [ ] cashier.html
- [ ] menu-staff.html
- [ ] all-orders.html
- [ ] tables.html
- [ ] rooms.html
- [ ] reports.html
- [ ] admin-menu.html
- [ ] admin-workers.html
- [ ] inventory.html
- [ ] barcode.html
- [ ] worker-app.html

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ

1. ุชุญุฏูุซ ุฌููุน ุงูุตูุญุงุช ูุงุณุชุฎุฏุงู `AuthCheck` ุจุฏูุงู ูู `localStorage`
2. ุฅุถุงูุฉ ูุนุงูุฌุฉ ุฃุฎุทุงุก ููุนูููุงุช ุงูุญุณุงุณุฉ
3. ุชูุนูู Firebase App Check ูู ุงูุฅูุชุงุฌ
4. ุงุณุชุฎุฏุงู Environment Variables ููุฅุนุฏุงุฏุงุช ุงูุญุณุงุณุฉ

---

**ุชู ุงูุชุญุฏูุซ:** ููุงูุฑ 2026
**ุงูุฅุตุฏุงุฑ:** 2.1.0





